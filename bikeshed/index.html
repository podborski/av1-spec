<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>AV1 Bitstream &amp; Decoding Process Specification (bikeshed experiment)</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
			border-bottom: 3px solid transparent;
			margin-bottom: -3px;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom-color: #054572;
			border-bottom-color: var(--toclink-underline);
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version d9bd89757, updated Thu Mar 23 10:06:53 2023 -0700" name="generator">
  <link href="https://aomediacodec.github.io/av1-spec/" rel="canonical">
  <meta content="f3a7f86bdfc4415db9a748f8198631481426de1e" name="document-revision">
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.aomedia.org/" style="width: 200px"> <img alt="AOM" height="60" src="https://aomedia.org/assets/images/aomedia-logo-rgb.svg" width="200"> </a> </p>
   <h1 class="p-name no-ref" id="title">AV1 Bitstream &amp; Decoding Process Specification (bikeshed experiment)</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Pre-Draft, <time class="dt-updated" datetime="2024-03-01">1 March 2024</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://aomediacodec.github.io/av1-spec/">https://aomediacodec.github.io/av1-spec/</a>
     <dt>Latest approved version:
     <dd><a href="https://aomediacodec.github.io/av1-spec/av1-spec.pdf">https://aomediacodec.github.io/av1-spec/av1-spec.pdf</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/AOMediaCodec/av1-spec/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Peter de Rivaz</span> (<span class="p-org org">Argon Design Ltd</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Jack Haughton</span> (<span class="p-org org">Argon Design Ltd</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Adrian Grange</span> (<span class="p-org org">Google LLC</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Lou Quillio</span> (<span class="p-org org">Google LLC</span>)
    </dl>
   </div>
   <div data-fill-with="warning">
    <details class="annoying-warning" open>
     <summary>Warning</summary>
     <p>This specification is a proposed draft not endorsed by the working group.</p>
    </details>
   </div>
   <p class="copyright" data-fill-with="copyright">
    <p>Copyright 2024, <a href="https://aomedia.org">AOM</a></p>
    <p>Licensing information is available at <a href="http://aomedia.org/license/">http://aomedia.org/license/</a></p>
    <p>The MATERIALS ARE PROVIDED “AS IS.” The Alliance for Open Media, its members, and its contributors expressly disclaim any warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to the materials. The entire risk as to implementing or otherwise using the materials is assumed by the implementer and user. IN NO EVENT WILL THE ALLIANCE FOR OPEN MEDIA, ITS MEMBERS, OR CONTRIBUTORS BE LIABLE TO ANY OTHER PARTY FOR LOST PROFITS OR ANY FORM OF INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER FROM ANY CAUSES OF ACTION OF ANY KIND WITH RESPECT TO THIS DELIVERABLE OR ITS GOVERNING AGREEMENT, WHETHER BASED ON BREACH OF CONTRACT, TORT (INCLUDING NEGLIGENCE), OR OTHERWISE, AND WHETHER OR NOT THE OTHER MEMBER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
   </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines the bitstream formats and decoding process for the <a href="https://aomedia.org">Alliance for Open Media</a> AV1 video codec.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#scope"><span class="secno">1</span> <span class="content">Scope</span></a>
    <li><a href="#terms_and_definitions"><span class="secno">2</span> <span class="content">Terms and definitions</span></a>
    <li><a href="#symbols_and_abbreviated_terms"><span class="secno">3</span> <span class="content">Symbols and abbreviated terms</span></a>
    <li>
     <a href="#conventions"><span class="secno">4</span> <span class="content">Conventions</span></a>
     <ol class="toc">
      <li><a href="#conventions-general"><span class="secno">4.1</span> <span class="content">General</span></a>
      <li><a href="#conventions-arithmetic-operators"><span class="secno">4.2</span> <span class="content">Arithmetic operators</span></a>
      <li><a href="#conventions-logical-operators"><span class="secno">4.3</span> <span class="content">Logical operators</span></a>
      <li><a href="#conventions-relational-operators"><span class="secno">4.4</span> <span class="content">Relational operators</span></a>
      <li><a href="#conventions-bitwise-operators"><span class="secno">4.5</span> <span class="content">Bitwise operators</span></a>
      <li><a href="#conventions-assignment"><span class="secno">4.6</span> <span class="content">Assignment</span></a>
      <li><a href="#conventions-mathematical-functions"><span class="secno">4.7</span> <span class="content">Mathematical functions</span></a>
      <li><a href="#conventions-bitstream-syntax"><span class="secno">4.8</span> <span class="content">Method of describing bitstream syntax</span></a>
      <li><a href="#conventions-functions"><span class="secno">4.9</span> <span class="content">Functions</span></a>
      <li>
       <a href="#conventions-descriptors"><span class="secno">4.10</span> <span class="content">Descriptors</span></a>
       <ol class="toc">
        <li><a href="#conventions-descriptors-general"><span class="secno">4.10.1</span> <span class="content">General</span></a>
        <li><a href="#conventions-descriptors-fn"><span class="secno">4.10.2</span> <span class="content">f(n)</span></a>
        <li><a href="#conventions-descriptors-uvlc"><span class="secno">4.10.3</span> <span class="content">uvlc()</span></a>
        <li><a href="#conventions-descriptors-len"><span class="secno">4.10.4</span> <span class="content">le(n)</span></a>
        <li><a href="#conventions-descriptors-leb128"><span class="secno">4.10.5</span> <span class="content">leb128()</span></a>
        <li><a href="#conventions-descriptors-sun"><span class="secno">4.10.6</span> <span class="content">su(n)</span></a>
        <li><a href="#conventions-descriptors-nsn"><span class="secno">4.10.7</span> <span class="content">ns(n)</span></a>
        <li><a href="#conventions-descriptors-ln"><span class="secno">4.10.8</span> <span class="content">L(n)</span></a>
        <li><a href="#conventions-descriptors-s"><span class="secno">4.10.9</span> <span class="content">S()</span></a>
        <li><a href="#conventions-descriptors-nsn2"><span class="secno">4.10.10</span> <span class="content">NS(n)</span></a>
       </ol>
     </ol>
    <li>
     <a href="#syntax_structures"><span class="secno">5</span> <span class="content">Syntax structures</span></a>
     <ol class="toc">
      <li><a href="#general"><span class="secno">5.1</span> <span class="content">General</span></a>
      <li><a href="#low_overhead_bitstream_format"><span class="secno">5.2</span> <span class="content">Low overhead bitstream format</span></a>
      <li>
       <a href="#obu_syntax"><span class="secno">5.3</span> <span class="content">OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_obu_syntax"><span class="secno">5.3.1</span> <span class="content">General OBU syntax</span></a>
        <li><a href="#obu_header_syntax"><span class="secno">5.3.2</span> <span class="content">OBU header syntax</span></a>
        <li><a href="#obu_extension_header_syntax"><span class="secno">5.3.3</span> <span class="content">OBU extension header syntax</span></a>
        <li><a href="#trailing_bits_syntax"><span class="secno">5.3.4</span> <span class="content">Trailing bits syntax</span></a>
        <li><a href="#byte_alignment_syntax"><span class="secno">5.3.5</span> <span class="content">Byte alignment syntax</span></a>
       </ol>
      <li><a href="#reserved_obu_syntax"><span class="secno">5.4</span> <span class="content">Reserved OBU syntax</span></a>
      <li>
       <a href="#sequence_header_obu_syntax"><span class="secno">5.5</span> <span class="content">Sequence header OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_sequence_header_obu_syntax"><span class="secno">5.5.1</span> <span class="content">General sequence header OBU syntax</span></a>
        <li><a href="#color_config_syntax"><span class="secno">5.5.2</span> <span class="content">Color config syntax</span></a>
        <li><a href="#timing_info_syntax"><span class="secno">5.5.3</span> <span class="content">Timing info syntax</span></a>
        <li><a href="#decoder_model_info_syntax"><span class="secno">5.5.4</span> <span class="content">Decoder model info syntax</span></a>
        <li><a href="#operating_parameters_info_syntax"><span class="secno">5.5.5</span> <span class="content">Operating parameters info syntax</span></a>
       </ol>
      <li><a href="#temporal_delimiter_obu_syntax"><span class="secno">5.6</span> <span class="content">Temporal delimiter obu syntax</span></a>
      <li><a href="#padding_obu_syntax"><span class="secno">5.7</span> <span class="content">Padding OBU syntax</span></a>
      <li>
       <a href="#metadata_obu_syntax"><span class="secno">5.8</span> <span class="content">Metadata OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_metadata_obu_syntax"><span class="secno">5.8.1</span> <span class="content">General metadata OBU syntax</span></a>
        <li><a href="#metadata_itut_t35_syntax"><span class="secno">5.8.2</span> <span class="content">Metadata ITUT T35 syntax</span></a>
        <li><a href="#metadata_high_dynamic_range_content_light_level_syntax"><span class="secno">5.8.3</span> <span class="content">Metadata high dynamic range content light level syntax</span></a>
        <li><a href="#metadata_high_dynamic_range_mastering_display_color_volume_syntax"><span class="secno">5.8.4</span> <span class="content">Metadata high dynamic range mastering display color volume syntax</span></a>
        <li><a href="#metadata_scalability_syntax"><span class="secno">5.8.5</span> <span class="content">Metadata scalability syntax</span></a>
        <li><a href="#scalability_structure_syntax"><span class="secno">5.8.6</span> <span class="content">Scalability structure syntax</span></a>
        <li><a href="#metadata_timecode_syntax"><span class="secno">5.8.7</span> <span class="content">Metadata timecode syntax</span></a>
       </ol>
      <li>
       <a href="#frame_header_obu_syntax"><span class="secno">5.9</span> <span class="content">Frame header OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_frame_header_obu_syntax"><span class="secno">5.9.1</span> <span class="content">General frame header OBU syntax</span></a>
        <li><a href="#uncompressed_header_syntax"><span class="secno">5.9.2</span> <span class="content">Uncompressed header syntax</span></a>
        <li><a href="#get_relative_distance_function"><span class="secno">5.9.3</span> <span class="content">Get relative distance function</span></a>
        <li><a href="#reference_frame_marking_function"><span class="secno">5.9.4</span> <span class="content">Reference frame marking function</span></a>
        <li><a href="#frame_size_syntax"><span class="secno">5.9.5</span> <span class="content">Frame size syntax</span></a>
        <li><a href="#render_size_syntax"><span class="secno">5.9.6</span> <span class="content">Render size syntax</span></a>
        <li><a href="#frame_size_with_refs_syntax"><span class="secno">5.9.7</span> <span class="content">Frame size with refs syntax</span></a>
        <li><a href="#superres_params_syntax"><span class="secno">5.9.8</span> <span class="content">Superres params syntax</span></a>
        <li><a href="#compute_image_size_function"><span class="secno">5.9.9</span> <span class="content">Compute image size function</span></a>
        <li><a href="#interpolation_filter_syntax"><span class="secno">5.9.10</span> <span class="content">Interpolation filter syntax</span></a>
        <li><a href="#loop_filter_params_syntax"><span class="secno">5.9.11</span> <span class="content">Loop filter params syntax</span></a>
        <li><a href="#quantization_params_syntax"><span class="secno">5.9.12</span> <span class="content">Quantization params syntax</span></a>
        <li><a href="#delta_quantizer_syntax"><span class="secno">5.9.13</span> <span class="content">Delta quantizer syntax</span></a>
        <li><a href="#segmentation_params_syntax"><span class="secno">5.9.14</span> <span class="content">Segmentation params syntax</span></a>
        <li><a href="#tile_info_syntax"><span class="secno">5.9.15</span> <span class="content">Tile info syntax</span></a>
        <li><a href="#tile_size_calculation_function"><span class="secno">5.9.16</span> <span class="content">Tile size calculation function</span></a>
        <li><a href="#quantizer_index_delta_parameters_syntax"><span class="secno">5.9.17</span> <span class="content">Quantizer index delta parameters syntax</span></a>
        <li><a href="#loop_filter_delta_parameters_syntax"><span class="secno">5.9.18</span> <span class="content">Loop filter delta parameters syntax</span></a>
        <li><a href="#cdef_params_syntax"><span class="secno">5.9.19</span> <span class="content">CDEF params syntax</span></a>
        <li><a href="#loop_restoration_params_syntax"><span class="secno">5.9.20</span> <span class="content">Loop restoration params syntax</span></a>
        <li><a href="#tx_mode_syntax"><span class="secno">5.9.21</span> <span class="content">TX mode syntax</span></a>
        <li><a href="#skip_mode_params_syntax"><span class="secno">5.9.22</span> <span class="content">Skip mode params syntax</span></a>
        <li><a href="#frame_reference_mode_syntax"><span class="secno">5.9.23</span> <span class="content">Frame reference mode syntax</span></a>
        <li><a href="#global_motion_params_syntax"><span class="secno">5.9.24</span> <span class="content">Global motion params syntax</span></a>
        <li><a href="#global_param_syntax"><span class="secno">5.9.25</span> <span class="content">Global param syntax</span></a>
        <li><a href="#decode_signed_subexp_with_ref_syntax"><span class="secno">5.9.26</span> <span class="content">Decode signed subexp with ref syntax</span></a>
        <li><a href="#decode_unsigned_subexp_with_ref_syntax"><span class="secno">5.9.27</span> <span class="content">Decode unsigned subexp with ref syntax</span></a>
        <li><a href="#decode_subexp_syntax"><span class="secno">5.9.28</span> <span class="content">Decode subexp syntax</span></a>
        <li><a href="#inverse_recenter_function"><span class="secno">5.9.29</span> <span class="content">Inverse recenter function</span></a>
        <li><a href="#film_grain_params_syntax"><span class="secno">5.9.30</span> <span class="content">Film grain params syntax</span></a>
        <li><a href="#temporal_point_info_syntax"><span class="secno">5.9.31</span> <span class="content">Temporal point info syntax</span></a>
       </ol>
      <li><a href="#frame_obu_syntax"><span class="secno">5.10</span> <span class="content">Frame OBU syntax</span></a>
      <li>
       <a href="#tile_group_obu_syntax"><span class="secno">5.11</span> <span class="content">Tile group OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_tile_group_obu_syntax"><span class="secno">5.11.1</span> <span class="content">General tile group OBU syntax</span></a>
        <li><a href="#decode_tile_syntax"><span class="secno">5.11.2</span> <span class="content">Decode tile syntax</span></a>
        <li><a href="#clear_block_decoded_flags_function"><span class="secno">5.11.3</span> <span class="content">Clear block decoded flags function</span></a>
        <li><a href="#decode_partition_syntax"><span class="secno">5.11.4</span> <span class="content">Decode partition syntax</span></a>
        <li><a href="#decode_block_syntax"><span class="secno">5.11.5</span> <span class="content">Decode block syntax</span></a>
        <li><a href="#mode_info_syntax"><span class="secno">5.11.6</span> <span class="content">Mode info syntax</span></a>
        <li><a href="#intra_frame_mode_info_syntax"><span class="secno">5.11.7</span> <span class="content">Intra frame mode info syntax</span></a>
        <li><a href="#intra_segment_id_syntax"><span class="secno">5.11.8</span> <span class="content">Intra segment ID syntax</span></a>
        <li><a href="#read_segment_id_syntax"><span class="secno">5.11.9</span> <span class="content">Read segment ID syntax</span></a>
        <li><a href="#skip_mode_syntax"><span class="secno">5.11.10</span> <span class="content">Skip mode syntax</span></a>
        <li><a href="#skip_syntax"><span class="secno">5.11.11</span> <span class="content">Skip syntax</span></a>
        <li><a href="#quantizer_index_delta_syntax"><span class="secno">5.11.12</span> <span class="content">Quantizer index delta syntax</span></a>
        <li><a href="#loop_filter_delta_syntax"><span class="secno">5.11.13</span> <span class="content">Loop filter delta syntax</span></a>
        <li><a href="#segmentation_feature_active_function"><span class="secno">5.11.14</span> <span class="content">Segmentation feature active function</span></a>
        <li><a href="#tx_size_syntax"><span class="secno">5.11.15</span> <span class="content">TX size syntax</span></a>
        <li><a href="#block_tx_size_syntax"><span class="secno">5.11.16</span> <span class="content">Block TX size syntax</span></a>
        <li><a href="#var_tx_size_syntax"><span class="secno">5.11.17</span> <span class="content">Var TX size syntax</span></a>
        <li><a href="#inter_frame_mode_info_syntax"><span class="secno">5.11.18</span> <span class="content">Inter frame mode info syntax</span></a>
        <li><a href="#inter_segment_id_syntax"><span class="secno">5.11.19</span> <span class="content">Inter segment ID syntax</span></a>
        <li><a href="#is_inter_syntax"><span class="secno">5.11.20</span> <span class="content">Is inter syntax</span></a>
        <li><a href="#get_segment_id_function"><span class="secno">5.11.21</span> <span class="content">Get segment ID function</span></a>
        <li><a href="#intra_block_mode_info_syntax"><span class="secno">5.11.22</span> <span class="content">Intra block mode info syntax</span></a>
        <li><a href="#inter_block_mode_info_syntax"><span class="secno">5.11.23</span> <span class="content">Inter block mode info syntax</span></a>
        <li><a href="#filter_intra_mode_info_syntax"><span class="secno">5.11.24</span> <span class="content">Filter intra mode info syntax</span></a>
        <li><a href="#ref_frames_syntax"><span class="secno">5.11.25</span> <span class="content">Ref frames syntax</span></a>
        <li><a href="#assign_mv_syntax"><span class="secno">5.11.26</span> <span class="content">Assign MV syntax</span></a>
        <li><a href="#read_motion_mode_syntax"><span class="secno">5.11.27</span> <span class="content">Read motion mode syntax</span></a>
        <li><a href="#read_inter_intra_syntax"><span class="secno">5.11.28</span> <span class="content">Read inter intra syntax</span></a>
        <li><a href="#read_compound_type_syntax"><span class="secno">5.11.29</span> <span class="content">Read compound type syntax</span></a>
        <li><a href="#get_mode_function"><span class="secno">5.11.30</span> <span class="content">Get mode function</span></a>
        <li><a href="#mv_syntax"><span class="secno">5.11.31</span> <span class="content">MV syntax</span></a>
        <li><a href="#mv_component_syntax"><span class="secno">5.11.32</span> <span class="content">MV component syntax</span></a>
        <li><a href="#compute_prediction_syntax"><span class="secno">5.11.33</span> <span class="content">Compute prediction syntax</span></a>
        <li><a href="#residual_syntax"><span class="secno">5.11.34</span> <span class="content">Residual syntax</span></a>
        <li><a href="#transform_block_syntax"><span class="secno">5.11.35</span> <span class="content">Transform block syntax</span></a>
        <li><a href="#transform_tree_syntax"><span class="secno">5.11.36</span> <span class="content">Transform tree syntax</span></a>
        <li><a href="#get_tx_size_function"><span class="secno">5.11.37</span> <span class="content">Get TX size function</span></a>
        <li><a href="#get_plane_residual_size_function"><span class="secno">5.11.38</span> <span class="content">Get plane residual size function</span></a>
        <li><a href="#coefficients_syntax"><span class="secno">5.11.39</span> <span class="content">Coefficients syntax</span></a>
        <li><a href="#compute_transform_type_function"><span class="secno">5.11.40</span> <span class="content">Compute transform type function</span></a>
        <li><a href="#get_scan_function"><span class="secno">5.11.41</span> <span class="content">Get scan function</span></a>
        <li><a href="#intra_angle_info_luma_syntax"><span class="secno">5.11.42</span> <span class="content">Intra angle info luma syntax</span></a>
        <li><a href="#intra_angle_info_chroma_syntax"><span class="secno">5.11.43</span> <span class="content">Intra angle info chroma syntax</span></a>
        <li><a href="#is_directional_mode_function"><span class="secno">5.11.44</span> <span class="content">Is directional mode function</span></a>
        <li><a href="#read_cfl_alphas_syntax"><span class="secno">5.11.45</span> <span class="content">Read CFL alphas syntax</span></a>
        <li><a href="#palette_mode_info_syntax"><span class="secno">5.11.46</span> <span class="content">Palette mode info syntax</span></a>
        <li><a href="#transform_type_syntax"><span class="secno">5.11.47</span> <span class="content">Transform type syntax</span></a>
        <li><a href="#get_transform_set_function"><span class="secno">5.11.48</span> <span class="content">Get transform set function</span></a>
        <li><a href="#palette_tokens_syntax"><span class="secno">5.11.49</span> <span class="content">Palette tokens syntax</span></a>
        <li><a href="#palette_color_context_function"><span class="secno">5.11.50</span> <span class="content">Palette color context function</span></a>
        <li><a href="#is_inside_function"><span class="secno">5.11.51</span> <span class="content">Is inside function</span></a>
        <li><a href="#is_inside_filter_region_function"><span class="secno">5.11.52</span> <span class="content">Is inside filter region function</span></a>
        <li><a href="#clamp_mv_row_function"><span class="secno">5.11.53</span> <span class="content">Clamp MV row function</span></a>
        <li><a href="#clamp_mv_col_function"><span class="secno">5.11.54</span> <span class="content">Clamp MV col function</span></a>
        <li><a href="#clear_cdef_function"><span class="secno">5.11.55</span> <span class="content">Clear CDEF function</span></a>
        <li><a href="#read_cdef_syntax"><span class="secno">5.11.56</span> <span class="content">Read CDEF syntax</span></a>
        <li><a href="#read_loop_restoration_syntax"><span class="secno">5.11.57</span> <span class="content">Read loop restoration syntax</span></a>
        <li><a href="#read_loop_restoration_unit_syntax"><span class="secno">5.11.58</span> <span class="content">Read loop restoration unit syntax</span></a>
       </ol>
      <li>
       <a href="#tile_list_obu_syntax"><span class="secno">5.12</span> <span class="content">Tile list OBU syntax</span></a>
       <ol class="toc">
        <li><a href="#general_tile_list_obu_syntax"><span class="secno">5.12.1</span> <span class="content">General tile list OBU syntax</span></a>
        <li><a href="#tile_list_entry_syntax"><span class="secno">5.12.2</span> <span class="content">Tile list entry syntax</span></a>
       </ol>
     </ol>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="scope"><span class="secno">1. </span><span class="content">Scope</span><a class="self-link" href="#scope"></a></h2>
   <p>This document specifies the Alliance for Open Media AV1 bitstream formats and
decoding process.</p>
   <h2 class="heading settled" data-level="2" id="terms_and_definitions"><span class="secno">2. </span><span class="content">Terms and definitions</span><a class="self-link" href="#terms_and_definitions"></a></h2>
   <p>For the purposes of this document, the following terms and definitions apply:</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="ac-coefficient">AC coefficient<a class="self-link" href="#ac-coefficient"></a></dfn></p>
   <p>Any transform coefficient whose frequency indices are non-zero in at least one dimension.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="altref">Altref<a class="self-link" href="#altref"></a></dfn></p>
   <p>(Alternative reference frame) A frame that can be used in inter coding.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="base-layer">Base layer<a class="self-link" href="#base-layer"></a></dfn></p>
   <p>The layer with spatial_id and temporal_id values equal to 0.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="bitstream">Bitstream<a class="self-link" href="#bitstream"></a></dfn></p>
   <p>The sequence of bits generated by encoding a sequence of frames.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="bit-string">Bit string<a class="self-link" href="#bit-string"></a></dfn></p>
   <p>An ordered string with limited number of bits. The left most bit is the most significant bit (MSB), the right most bit is the least significant bit (LSB).</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="block">Block<a class="self-link" href="#block"></a></dfn></p>
   <p>A square or rectangular region of samples.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="block-scan">Block scan<a class="self-link" href="#block-scan"></a></dfn></p>
   <p>A specified serial ordering of quantized coefficients.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="byte">Byte<a class="self-link" href="#byte"></a></dfn></p>
   <p>An 8-bit bit string.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="byte-alignment">Byte alignment<a class="self-link" href="#byte-alignment"></a></dfn></p>
   <p>One bit is byte aligned if the position of the bit is an integer multiple of eight from the position of the first bit in the bitstream.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="cdef">CDEF<a class="self-link" href="#cdef"></a></dfn></p>
   <p>Constrained Directional Enhancement Filter designed to adaptively filter blocks based on identifying the direction.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="cdf">CDF<a class="self-link" href="#cdf"></a></dfn></p>
   <p>Cumulative distribution function representing the probability times 32768 that a symbol has value less than or equal to a given level.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="chroma">Chroma<a class="self-link" href="#chroma"></a></dfn></p>
   <p>A sample value matrix or a single sample value of one of the two color difference signals.</p>
   <p class="note" role="note"><span class="marker">NOTE:</span> Symbols of chroma are U and V.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="coded-frame">Coded frame<a class="self-link" href="#coded-frame"></a></dfn></p>
   <p>The representation of one frame before the decoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="component">Component<a class="self-link" href="#component"></a></dfn></p>
   <p>One of the three sample value matrices (one luma matrix and two chroma matrices) or its single sample value.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="compound-prediction">Compound prediction<a class="self-link" href="#compound-prediction"></a></dfn></p>
   <p>A type of inter prediction where sample values are computed by blending together predictions from two reference frames (the frames blended can be the same or different).</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="dc-coefficient">DC coefficient<a class="self-link" href="#dc-coefficient"></a></dfn></p>
   <p>A transform coefficient whose frequency indices are zero in both dimensions.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="decoded-frame">Decoded frame<a class="self-link" href="#decoded-frame"></a></dfn></p>
   <p>The frame reconstructed out of the bitstream by the decoder.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="decoder">Decoder<a class="self-link" href="#decoder"></a></dfn></p>
   <p>One embodiment of the decoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="decoding-process">Decoding process<a class="self-link" href="#decoding-process"></a></dfn></p>
   <p>The process that derives decoded frames from syntax elements, including any processing  steps used prior to and for the film grain synthesis process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="dequantization">Dequantization<a class="self-link" href="#dequantization"></a></dfn></p>
   <p>The process in which transform coefficients are obtained by scaling the quantized coefficients.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="encoder">Encoder<a class="self-link" href="#encoder"></a></dfn></p>
   <p>One embodiment of the encoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="encoding-process">Encoding process<a class="self-link" href="#encoding-process"></a></dfn></p>
   <p>A process not specified in this Specification that generates the bitstream that conforms to the description provided in this document.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="enhancement-layer">Enhancement layer<a class="self-link" href="#enhancement-layer"></a></dfn></p>
   <p>A layer with either spatial_id greater than 0 or temporal_id greater than 0.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="flag">Flag<a class="self-link" href="#flag"></a></dfn></p>
   <p>A binary variable - some variables and syntax elements (e.g. obu_extension_flag) are described using the word flag to highlight that the syntax element can only be equal to 0 or equal to 1.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="frame">Frame<a class="self-link" href="#frame"></a></dfn></p>
   <p>The representation of video signals in the spatial domain, composed of one luma sample matrix (Y) and two chroma sample matrices (U and V).</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="frame-context">Frame context<a class="self-link" href="#frame-context"></a></dfn></p>
   <p>A set of probabilities used in the decoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="golden-frame">Golden frame<a class="self-link" href="#golden-frame"></a></dfn></p>
   <p>A frame that can be used in inter coding. Typically the golden frame is encoded with higher quality and is used as a reference for multiple inter frames.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="inter-coding">Inter coding<a class="self-link" href="#inter-coding"></a></dfn></p>
   <p>Coding one block or frame using inter prediction.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="inter-frame">Inter frame<a class="self-link" href="#inter-frame"></a></dfn></p>
   <p>A frame compressed by referencing previously decoded frames and which may use intra prediction or inter prediction.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="inter-prediction">Inter prediction<a class="self-link" href="#inter-prediction"></a></dfn></p>
   <p>The process of deriving the prediction value for the current frame using previously decoded frames.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="intra-coding">Intra coding<a class="self-link" href="#intra-coding"></a></dfn></p>
   <p>Coding one block or frame using intra prediction.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="intra-frame">Intra frame<a class="self-link" href="#intra-frame"></a></dfn></p>
   <p>A frame compressed using only intra prediction which can be independently decoded.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="intra-prediction">Intra prediction<a class="self-link" href="#intra-prediction"></a></dfn></p>
   <p>The process of deriving the prediction value for the current sample using previously decoded sample values in the same decoded frame.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="inverse-transform">Inverse transform<a class="self-link" href="#inverse-transform"></a></dfn></p>
   <p>The process in which a transform coefficient matrix is transformed into a spatial sample value matrix.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="key-frame">Key frame<a class="self-link" href="#key-frame"></a></dfn></p>
   <p>An Intra frame which resets the decoding process when it is shown.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="layer">Layer<a class="self-link" href="#layer"></a></dfn></p>
   <p>A set of tile group OBUs with identical spatial_id and identical temporal_id values.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="level">Level<a class="self-link" href="#level"></a></dfn></p>
   <p>A defined set of constraints on the values for the syntax elements and variables.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="loop-filter">Loop filter<a class="self-link" href="#loop-filter"></a></dfn></p>
   <p>A filtering process applied to the reconstruction intended to reduce the visibility of block edges.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="luma">Luma<a class="self-link" href="#luma"></a></dfn></p>
   <p>A sample value matrix or a single sample value representing the monochrome signal related to the primary colors.</p>
   <p class="note" role="note"><span class="marker">NOTE:</span> The symbol representing luma is Y.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="mode-info">Mode info<a class="self-link" href="#mode-info"></a></dfn></p>
   <p>Syntax elements sent for a block containing an indication of how a block is to be predicted during the decoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="mode-info-block">Mode info block<a class="self-link" href="#mode-info-block"></a></dfn></p>
   <p>A luma sample value block of size 4x4 or larger and its two corresponding chroma sample value blocks (if present).</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="motion-vector">Motion vector<a class="self-link" href="#motion-vector"></a></dfn></p>
   <p>A two-dimensional vector used for inter prediction which refers the current frame to the reference frame, the value of which provides the coordinate offsets from a location in the current frame to a location in the reference frame.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="obu">OBU<a class="self-link" href="#obu"></a></dfn></p>
   <p>All structures are packetized in "Open Bitstream Units" or OBUs. Each OBU has a header, which provides identifying information for the contained data (payload).</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="parse">Parse<a class="self-link" href="#parse"></a></dfn></p>
   <p>The procedure of getting the syntax element from the bitstream.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="prediction">Prediction<a class="self-link" href="#prediction"></a></dfn></p>
   <p>The implementation of the prediction process consisting of either inter or intra prediction.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="prediction-process">Prediction process<a class="self-link" href="#prediction-process"></a></dfn></p>
   <p>The process of estimating the decoded sample value or data element using a predictor.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="prediction-value">Prediction value<a class="self-link" href="#prediction-value"></a></dfn></p>
   <p>The value, which is the combination of the previously decoded sample values or data elements, used in the decoding process of the next sample value or data element.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="profile">Profile<a class="self-link" href="#profile"></a></dfn></p>
   <p>A subset of syntax, semantics and algorithms defined in a part.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="quantization-parameter">Quantization parameter<a class="self-link" href="#quantization-parameter"></a></dfn></p>
   <p>A variable used for scaling the quantized coefficients in the decoding process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="quantized-coefficient">Quantized coefficient<a class="self-link" href="#quantized-coefficient"></a></dfn></p>
   <p>A transform coefficient before dequantization.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="raster-scan">Raster scan<a class="self-link" href="#raster-scan"></a></dfn></p>
   <p>Maps a two dimensional rectangular raster into a one dimensional raster, in which the entry of the one dimensional raster starts from the first row of the two dimensional raster, and the scanning then goes through the second row and the third row, and so on. Each raster row is scanned in left to right order.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="reconstruction">Reconstruction<a class="self-link" href="#reconstruction"></a></dfn></p>
   <p>Obtaining the addition of the decoded residual and the corresponding prediction values.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="reference">Reference<a class="self-link" href="#reference"></a></dfn></p>
   <p>One of a set of tags, each of which is mapped to a reference frame.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="reference-frame">Reference frame<a class="self-link" href="#reference-frame"></a></dfn></p>
   <p>A storage area for a previously decoded frame and associated information.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="reserved">Reserved<a class="self-link" href="#reserved"></a></dfn></p>
   <p>A special syntax element value which may be used to extend this part in the future.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="residual">Residual<a class="self-link" href="#residual"></a></dfn></p>
   <p>The differences between the reconstructed samples and the corresponding prediction values.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="sample">Sample<a class="self-link" href="#sample"></a></dfn></p>
   <p>The basic elements that compose the frame.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="sample-value">Sample value<a class="self-link" href="#sample-value"></a></dfn></p>
   <p>The value of a sample. This is an integer from 0 to 255 (inclusive) for 8-bit frames, from 0 to 1023 (inclusive) for 10-bit frames, and from 0 to 4095 (inclusive) for 12-bit frames.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="segmentation-map">Segmentation map<a class="self-link" href="#segmentation-map"></a></dfn></p>
   <p>One 3-bit number per 4x4 block in the frame specifying the segment affiliation of that block. A segmentation map is stored for each reference frame to allow new frames to use a previously coded map.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="sequence">Sequence<a class="self-link" href="#sequence"></a></dfn></p>
   <p>The highest level syntax structure of coding bitstream, including one or several consecutive coded frames.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="superblock">Superblock<a class="self-link" href="#superblock"></a></dfn></p>
   <p>The top level of the block quadtree within a tile. All superblocks within a frame are the same size and are square. The superblocks may be 128x128 luma samples or 64x64 luma samples. A superblock may contain 1 or 2 or 4 mode info blocks, or may be bisected in each direction to create 4 sub-blocks, which may themselves be further subpartitioned, forming the block quadtree.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="switch-frame">Switch Frame<a class="self-link" href="#switch-frame"></a></dfn></p>
   <p>An inter frame that can be used as a point to switch between sequences. Switch frames overwrite all the reference frames without forcing the use of intra coding.  The intention is to allow a streaming use case where videos can be encoded in small chunks (say of 1 second duration), each starting with a switch frame.  If the available bandwidth drops, the server can start sending chunks from a lower bitrate encoding instead. When this happens the inter prediction uses the existing higher quality reference frames to decode the switch frame.  This approach allows a bitrate switch without the cost of a full key frame.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="syntax-element">Syntax element<a class="self-link" href="#syntax-element"></a></dfn></p>
   <p>An element of data represented in the bitstream.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="temporal-delimiter-obu">Temporal delimiter OBU<a class="self-link" href="#temporal-delimiter-obu"></a></dfn></p>
   <p>An indication that the following OBUs will have a different presentation/decoding time stamp from the one of the last frame prior to the temporal delimiter.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="temporal-unit">Temporal unit<a class="self-link" href="#temporal-unit"></a></dfn></p>
   <p>A Temporal unit consists of all the OBUs that are associated with a specific, distinct time instant. It consists of a temporal delimiter OBU, and all the OBUs that follow, up to but not including the next temporal delimiter.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="temporal-group">Temporal group<a class="self-link" href="#temporal-group"></a></dfn></p>
   <p>A set of frames whose temporal prediction structure is used periodically in a video sequence.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="tier">Tier<a class="self-link" href="#tier"></a></dfn></p>
   <p>A specified category of level constraints imposed on the values of the syntax elements in the bitstream.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="tile">Tile<a class="self-link" href="#tile"></a></dfn></p>
   <p>A rectangular region of the frame that can be decoded and encoded independently, although loop-filtering across tile edges is still applied.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="transform-block">Transform block<a class="self-link" href="#transform-block"></a></dfn></p>
   <p>A rectangular transform coefficient matrix, used as input to the inverse transform process.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="transform-coefficient">Transform coefficient<a class="self-link" href="#transform-coefficient"></a></dfn></p>
   <p>A scalar value, considered to be in a frequency domain, contained in a transform block.</p>
   <p><dfn data-dfn-type="dfn" data-noexport id="uncompressed-header">Uncompressed header<a class="self-link" href="#uncompressed-header"></a></dfn></p>
   <p>High level description of the frame to be decoded that is encoded without the use of arithmetic encoding.</p>
   <h2 class="heading settled" data-level="3" id="symbols_and_abbreviated_terms"><span class="secno">3. </span><span class="content">Symbols and abbreviated terms</span><a class="self-link" href="#symbols_and_abbreviated_terms"></a></h2>
   <p>DCT</p>
   <dl>
    <dt data-md>Discrete Cosine Transform
   </dl>
   <p>ADST</p>
   <dl>
    <dt data-md>Asymmetric Discrete Sine Transform
   </dl>
   <p>LSB</p>
   <dl>
    <dt data-md>Least Significant Bit
   </dl>
   <p>MSB</p>
   <dl>
    <dt data-md>Most Significant Bit
   </dl>
   <p>WHT</p>
   <dl>
    <dt data-md>Walsh Hadamard Transform
   </dl>
   <p>The specification makes use of a number of constant integers.  Constants that
relate to the semantics of a particular syntax element are defined in
[section 6][].</p>
   <p>Additional constants are defined below:</p>
   <table class="table table-sm table-bordered table-striped">
    <thead>
     <tr>
      <th>Symbol name
      <th style="text-align: center">Value
      <th>Description
    <tbody>
     <tr>
      <td><code>REFS_PER_FRAME</code>
      <td style="text-align: center">7
      <td>Number of reference frames that can be used for inter prediction
     <tr>
      <td><code>TOTAL_REFS_PER_FRAME</code>
      <td style="text-align: center">8
      <td>Number of reference frame types (including intra type)
     <tr>
      <td><code>BLOCK_SIZE_GROUPS</code>
      <td style="text-align: center">4
      <td>Number of contexts when decoding <code>y_mode</code>
     <tr>
      <td><code>BLOCK_SIZES</code>
      <td style="text-align: center">22
      <td>Number of different block sizes used
     <tr>
      <td><code>BLOCK_INVALID</code>
      <td style="text-align: center">22
      <td>Sentinel value to mark partition choices that are not allowed
     <tr>
      <td><code>MAX_SB_SIZE</code>
      <td style="text-align: center">128
      <td>Maximum size of a superblock in luma samples
     <tr>
      <td><code>MI_SIZE</code>
      <td style="text-align: center">4
      <td>Smallest size of a mode info block in luma samples
     <tr>
      <td><code>MI_SIZE_LOG2</code>
      <td style="text-align: center">2
      <td>Base 2 logarithm of smallest size of a mode info block
     <tr>
      <td><code>MAX_TILE_WIDTH</code>
      <td style="text-align: center">4096
      <td>Maximum width of a tile in units of luma samples
     <tr>
      <td><code>MAX_TILE_AREA</code>
      <td style="text-align: center">4096 * 2304
      <td>Maximum area of a tile in units of luma samples
     <tr>
      <td><code>MAX_TILE_ROWS</code>
      <td style="text-align: center">64
      <td>Maximum number of tile rows
     <tr>
      <td><code>MAX_TILE_COLS</code>
      <td style="text-align: center">64
      <td>Maximum number of tile columns
     <tr>
      <td><code>INTRABC_DELAY_PIXELS</code>
      <td style="text-align: center">256
      <td>Number of horizontal luma samples before intra block copy can be used
     <tr>
      <td><code>INTRABC_DELAY_SB64</code>
      <td style="text-align: center">4
      <td>Number of 64 by 64 blocks before intra block copy can be used
     <tr>
      <td><code>NUM_REF_FRAMES</code>
      <td style="text-align: center">8
      <td>Number of frames that can be stored for future reference
     <tr>
      <td><code>IS_INTER_CONTEXTS</code>
      <td style="text-align: center">4
      <td>Number of contexts for <code>is_inter</code>
     <tr>
      <td><code>REF_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for <code>single_ref</code>, <code>comp_ref</code>, <code>comp_bwdref</code>, <code>uni_comp_ref</code>, <code>uni_comp_ref_p1</code> and <code>uni_comp_ref_p2</code>
     <tr>
      <td><code>MAX_SEGMENTS</code>
      <td style="text-align: center">8
      <td>Number of segments allowed in segmentation map
     <tr>
      <td><code>SEGMENT_ID_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for <code>segment_id</code>
     <tr>
      <td><code>SEG_LVL_ALT_Q</code>
      <td style="text-align: center">0
      <td>Index for quantizer segment feature
     <tr>
      <td><code>SEG_LVL_ALT_LF_Y_V</code>
      <td style="text-align: center">1
      <td>Index for vertical luma loop filter segment feature
     <tr>
      <td><code>SEG_LVL_REF_FRAME</code>
      <td style="text-align: center">5
      <td>Index for reference frame segment feature
     <tr>
      <td><code>SEG_LVL_SKIP</code>
      <td style="text-align: center">6
      <td>Index for skip segment feature
     <tr>
      <td><code>SEG_LVL_GLOBALMV</code>
      <td style="text-align: center">7
      <td>Index for global mv feature
     <tr>
      <td><code>SEG_LVL_MAX</code>
      <td style="text-align: center">8
      <td>Number of segment features
     <tr>
      <td><code>PLANE_TYPES</code>
      <td style="text-align: center">2
      <td>Number of different plane types (luma or chroma)
     <tr>
      <td><code>TX_SIZE_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for transform size
     <tr>
      <td><code>INTERP_FILTERS</code>
      <td style="text-align: center">3
      <td>Number of values for <code>interp_filter</code>
     <tr>
      <td><code>INTERP_FILTER_CONTEXTS</code>
      <td style="text-align: center">16
      <td>Number of contexts for <code>interp_filter</code>
     <tr>
      <td><code>SKIP_MODE_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for decoding skip_mode
     <tr>
      <td><code>SKIP_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for decoding skip
     <tr>
      <td><code>PARTITION_CONTEXTS</code>
      <td style="text-align: center">4
      <td>Number of contexts when decoding <code>partition</code>
     <tr>
      <td><code>TX_SIZES</code>
      <td style="text-align: center">5
      <td>Number of square transform sizes
     <tr>
      <td><code>TX_SIZES_ALL</code>
      <td style="text-align: center">19
      <td>Number of transform sizes (including non-square sizes)
     <tr>
      <td><code>TX_MODES</code>
      <td style="text-align: center">3
      <td>Number of values for <code>tx_mode</code>
     <tr>
      <td><code>DCT_DCT</code>
      <td style="text-align: center">0
      <td>Inverse transform rows with <code>DCT</code> and columns with <code>DCT</code>
     <tr>
      <td><code>ADST_DCT</code>
      <td style="text-align: center">1
      <td>Inverse transform rows with <code>DCT</code> and columns with <code>ADST</code>
     <tr>
      <td><code>DCT_ADST</code>
      <td style="text-align: center">2
      <td>Inverse transform rows with <code>ADST</code> and columns with <code>DCT</code>
     <tr>
      <td><code>ADST_ADST</code>
      <td style="text-align: center">3
      <td>Inverse transform rows with <code>ADST</code> and columns with <code>ADST</code>
     <tr>
      <td><code>FLIPADST_DCT</code>
      <td style="text-align: center">4
      <td>Inverse transform rows with <code>DCT</code> and columns with <code>FLIPADST</code>
     <tr>
      <td><code>DCT_FLIPADST</code>
      <td style="text-align: center">5
      <td>Inverse transform rows with <code>FLIPADST</code> and columns with <code>DCT</code>
     <tr>
      <td><code>FLIPADST_FLIPADST</code>
      <td style="text-align: center">6
      <td>Inverse transform rows with <code>FLIPADST</code> and columns with <code>FLIPADST</code>
     <tr>
      <td><code>ADST_FLIPADST</code>
      <td style="text-align: center">7
      <td>Inverse transform rows with <code>FLIPADST</code> and columns with <code>ADST</code>
     <tr>
      <td><code>FLIPADST_ADST</code>
      <td style="text-align: center">8
      <td>Inverse transform rows with <code>ADST</code> and columns with <code>FLIPADST</code>
     <tr>
      <td><code>IDTX</code>
      <td style="text-align: center">9
      <td>Inverse transform rows with identity and columns with identity
     <tr>
      <td><code>V_DCT</code>
      <td style="text-align: center">10
      <td>Inverse transform rows with identity and columns with <code>DCT</code>
     <tr>
      <td><code>H_DCT</code>
      <td style="text-align: center">11
      <td>Inverse transform rows with <code>DCT</code> and columns with identity
     <tr>
      <td><code>V_ADST</code>
      <td style="text-align: center">12
      <td>Inverse transform rows with identity and columns with <code>ADST</code>
     <tr>
      <td><code>H_ADST</code>
      <td style="text-align: center">13
      <td>Inverse transform rows with <code>ADST</code> and columns with identity
     <tr>
      <td><code>V_FLIPADST</code>
      <td style="text-align: center">14
      <td>Inverse transform rows with identity and columns with <code>FLIPADST</code>
     <tr>
      <td><code>H_FLIPADST</code>
      <td style="text-align: center">15
      <td>Inverse transform rows with <code>FLIPADST</code> and columns with identity
     <tr>
      <td><code>TX_TYPES</code>
      <td style="text-align: center">16
      <td>Number of inverse transform types
     <tr>
      <td><code>MB_MODE_COUNT</code>
      <td style="text-align: center">17
      <td>Number of values for <code>YMode</code>
     <tr>
      <td><code>INTRA_MODES</code>
      <td style="text-align: center">13
      <td>Number of values for <code>y_mode</code>
     <tr>
      <td><code>UV_INTRA_MODES_CFL_NOT_ALLOWED</code>
      <td style="text-align: center">13
      <td>Number of values for <code>uv_mode</code> when chroma from luma is not allowed
     <tr>
      <td><code>UV_INTRA_MODES_CFL_ALLOWED</code>
      <td style="text-align: center">14
      <td>Number of values for <code>uv_mode</code> when chroma from luma is allowed
     <tr>
      <td><code>COMPOUND_MODES</code>
      <td style="text-align: center">8
      <td>Number of values for <code>compound_mode</code>
     <tr>
      <td><code>COMPOUND_MODE_CONTEXTS</code>
      <td style="text-align: center">8
      <td>Number of contexts for <code>compound_mode</code>
     <tr>
      <td><code>COMP_NEWMV_CTXS</code>
      <td style="text-align: center">5
      <td>Number of new mv values used when constructing context for <code>compound_mode</code>
     <tr>
      <td><code>NEW_MV_CONTEXTS</code>
      <td style="text-align: center">6
      <td>Number of contexts for <code>new_mv</code>
     <tr>
      <td><code>ZERO_MV_CONTEXTS</code>
      <td style="text-align: center">2
      <td>Number of contexts for <code>zero_mv</code>
     <tr>
      <td><code>REF_MV_CONTEXTS</code>
      <td style="text-align: center">6
      <td>Number of contexts for <code>ref_mv</code>
     <tr>
      <td><code>DRL_MODE_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for <code>drl_mode</code>
     <tr>
      <td><code>MV_CONTEXTS</code>
      <td style="text-align: center">2
      <td>Number of contexts for decoding motion vectors including one for intra block copy
     <tr>
      <td><code>MV_INTRABC_CONTEXT</code>
      <td style="text-align: center">1
      <td>Motion vector context used for intra block copy
     <tr>
      <td><code>MV_JOINTS</code>
      <td style="text-align: center">4
      <td>Number of values for <code>mv_joint</code>
     <tr>
      <td><code>MV_CLASSES</code>
      <td style="text-align: center">11
      <td>Number of values for <code>mv_class</code>
     <tr>
      <td><code>CLASS0_SIZE</code>
      <td style="text-align: center">2
      <td>Number of values for <code>mv_class0_bit</code>
     <tr>
      <td><code>MV_OFFSET_BITS</code>
      <td style="text-align: center">10
      <td>Maximum number of bits for decoding motion vectors
     <tr>
      <td><code>MAX_LOOP_FILTER</code>
      <td style="text-align: center">63
      <td>Maximum value used for loop filtering
     <tr>
      <td><code>REF_SCALE_SHIFT</code>
      <td style="text-align: center">14
      <td>Number of bits of precision when scaling reference frames
     <tr>
      <td><code>SUBPEL_BITS</code>
      <td style="text-align: center">4
      <td>Number of bits of precision when choosing an inter prediction filter kernel
     <tr>
      <td><code>SUBPEL_MASK</code>
      <td style="text-align: center">15
      <td><code>( 1 &lt;&lt; SUBPEL_BITS ) - 1</code>
     <tr>
      <td><code>SCALE_SUBPEL_BITS</code>
      <td style="text-align: center">10
      <td>Number of bits of precision when computing inter prediction locations
     <tr>
      <td><code>MV_BORDER</code>
      <td style="text-align: center">128
      <td>Value used when clipping motion vectors
     <tr>
      <td><code>PALETTE_COLOR_CONTEXTS</code>
      <td style="text-align: center">5
      <td>Number of values for color contexts
     <tr>
      <td><code>PALETTE_MAX_COLOR_CONTEXT_HASH</code>
      <td style="text-align: center">8
      <td>Number of mappings between color context hash and color context
     <tr>
      <td><code>PALETTE_BLOCK_SIZE_CONTEXTS</code>
      <td style="text-align: center">7
      <td>Number of values for palette block size
     <tr>
      <td><code>PALETTE_Y_MODE_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of values for palette Y plane mode contexts
     <tr>
      <td><code>PALETTE_UV_MODE_CONTEXTS</code>
      <td style="text-align: center">2
      <td>Number of values for palette U and V plane mode contexts
     <tr>
      <td><code>PALETTE_SIZES</code>
      <td style="text-align: center">7
      <td>Number of values for palette_size
     <tr>
      <td><code>PALETTE_COLORS</code>
      <td style="text-align: center">8
      <td>Number of values for palette_color
     <tr>
      <td><code>PALETTE_NUM_NEIGHBORS</code>
      <td style="text-align: center">3
      <td>Number of neighbors considered within palette computation
     <tr>
      <td><code>DELTA_Q_SMALL</code>
      <td style="text-align: center">3
      <td>Value indicating alternative encoding of quantizer index delta values
     <tr>
      <td><code>DELTA_LF_SMALL</code>
      <td style="text-align: center">3
      <td>Value indicating alternative encoding of loop filter delta values
     <tr>
      <td><code>QM_TOTAL_SIZE</code>
      <td style="text-align: center">3344
      <td>Number of values in the quantizer matrix
     <tr>
      <td><code>MAX_ANGLE_DELTA</code>
      <td style="text-align: center">3
      <td>Maximum magnitude of AngleDeltaY and AngleDeltaUV
     <tr>
      <td><code>DIRECTIONAL_MODES</code>
      <td style="text-align: center">8
      <td>Number of directional intra modes
     <tr>
      <td><code>ANGLE_STEP</code>
      <td style="text-align: center">3
      <td>Number of degrees of step per unit increase in AngleDeltaY or AngleDeltaUV.
     <tr>
      <td><code>TX_SET_TYPES_INTRA</code>
      <td style="text-align: center">3
      <td>Number of intra transform set types
     <tr>
      <td><code>TX_SET_TYPES_INTER</code>
      <td style="text-align: center">4
      <td>Number of inter transform set types
     <tr>
      <td><code>WARPEDMODEL_PREC_BITS</code>
      <td style="text-align: center">16
      <td>Internal precision of warped motion models
     <tr>
      <td><code>IDENTITY</code>
      <td style="text-align: center">0
      <td>Warp model is just an identity transform
     <tr>
      <td><code>TRANSLATION</code>
      <td style="text-align: center">1
      <td>Warp model is a pure translation
     <tr>
      <td><code>ROTZOOM</code>
      <td style="text-align: center">2
      <td>Warp model is a rotation + symmetric zoom + translation
     <tr>
      <td><code>AFFINE</code>
      <td style="text-align: center">3
      <td>Warp model is a general affine transform
     <tr>
      <td><code>GM_ABS_TRANS_BITS</code>
      <td style="text-align: center">12
      <td>Number of bits encoded for translational components of global motion models, if part of a ROTZOOM or AFFINE model
     <tr>
      <td><code>GM_ABS_TRANS_ONLY_BITS</code>
      <td style="text-align: center">9
      <td>Number of bits encoded for translational components of global motion models, if part of a TRANSLATION model
     <tr>
      <td><code>GM_ABS_ALPHA_BITS</code>
      <td style="text-align: center">12
      <td>Number of bits encoded for non-translational components of global motion models
     <tr>
      <td><code>DIV_LUT_PREC_BITS</code>
      <td style="text-align: center">14
      <td>Number of fractional bits of entries in divisor lookup table
     <tr>
      <td><code>DIV_LUT_BITS</code>
      <td style="text-align: center">8
      <td>Number of fractional bits for lookup in divisor lookup table
     <tr>
      <td><code>DIV_LUT_NUM</code>
      <td style="text-align: center">257
      <td>Number of entries in divisor lookup table
     <tr>
      <td><code>MOTION_MODES</code>
      <td style="text-align: center">3
      <td>Number of values for motion modes
     <tr>
      <td><code>SIMPLE</code>
      <td style="text-align: center">0
      <td>Use translation or global motion compensation
     <tr>
      <td><code>OBMC</code>
      <td style="text-align: center">1
      <td>Use overlapped block motion compensation
     <tr>
      <td><code>LOCALWARP</code>
      <td style="text-align: center">2
      <td>Use local warp motion compensation
     <tr>
      <td><code>LEAST_SQUARES_SAMPLES_MAX</code>
      <td style="text-align: center">8
      <td>Largest number of samples used when computing a local warp
     <tr>
      <td><code>LS_MV_MAX</code>
      <td style="text-align: center">256
      <td>Largest motion vector difference to include in local warp computation
     <tr>
      <td><code>WARPEDMODEL_TRANS_CLAMP</code>
      <td style="text-align: center">1&lt;&lt;23
      <td>Clamping value used for translation components of warp
     <tr>
      <td><code>WARPEDMODEL_NONDIAGAFFINE_CLAMP</code>
      <td style="text-align: center">1&lt;&lt;13
      <td>Clamping value used for matrix components of warp
     <tr>
      <td><code>WARPEDPIXEL_PREC_SHIFTS</code>
      <td style="text-align: center">1&lt;&lt;6
      <td>Number of phases used in warped filtering
     <tr>
      <td><code>WARPEDDIFF_PREC_BITS</code>
      <td style="text-align: center">10
      <td>Number of extra bits of precision in warped filtering
     <tr>
      <td><code>GM_ALPHA_PREC_BITS</code>
      <td style="text-align: center">15
      <td>Number of fractional bits for sending non-translational warp model coefficients
     <tr>
      <td><code>GM_TRANS_PREC_BITS</code>
      <td style="text-align: center">6
      <td>Number of fractional bits for sending translational warp model coefficients
     <tr>
      <td><code>GM_TRANS_ONLY_PREC_BITS</code>
      <td style="text-align: center">3
      <td>Number of fractional bits used for pure translational warps
     <tr>
      <td><code>INTERINTRA_MODES</code>
      <td style="text-align: center">4
      <td>Number of inter intra modes
     <tr>
      <td><code>MASK_MASTER_SIZE</code>
      <td style="text-align: center">64
      <td>Size of MasterMask array
     <tr>
      <td><code>SEGMENT_ID_PREDICTED_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for <code>segment_id_predicted</code>
     <tr>
      <td><code>IS_INTER_CONTEXTS</code>
      <td style="text-align: center">4
      <td>Number of contexts for <code>is_inter</code>
     <tr>
      <td><code>FWD_REFS</code>
      <td style="text-align: center">4
      <td>Number of syntax elements for forward reference frames
     <tr>
      <td><code>BWD_REFS</code>
      <td style="text-align: center">3
      <td>Number of syntax elements for backward reference frames
     <tr>
      <td><code>SINGLE_REFS</code>
      <td style="text-align: center">7
      <td>Number of syntax elements for single reference frames
     <tr>
      <td><code>UNIDIR_COMP_REFS</code>
      <td style="text-align: center">4
      <td>Number of syntax elements for unidirectional compound reference frames
     <tr>
      <td><code>COMPOUND_TYPES</code>
      <td style="text-align: center">2
      <td>Number of values for <code>compound_type</code>
     <tr>
      <td><code>CFL_JOINT_SIGNS</code>
      <td style="text-align: center">8
      <td>Number of values for <code>cfl_alpha_signs</code>
     <tr>
      <td><code>CFL_ALPHABET_SIZE</code>
      <td style="text-align: center">16
      <td>Number of values for <code>cfl_alpha_u</code> and <code>cfl_alpha_v</code>
     <tr>
      <td><code>COMP_INTER_CONTEXTS</code>
      <td style="text-align: center">5
      <td>Number of contexts for <code>comp_mode</code>
     <tr>
      <td><code>COMP_REF_TYPE_CONTEXTS</code>
      <td style="text-align: center">5
      <td>Number of contexts for <code>comp_ref_type</code>
     <tr>
      <td><code>CFL_ALPHA_CONTEXTS</code>
      <td style="text-align: center">6
      <td>Number of contexts for <code>cfl_alpha_u</code> and <code>cfl_alpha_v</code>
     <tr>
      <td><code>INTRA_MODE_CONTEXTS</code>
      <td style="text-align: center">5
      <td>Number of each of left and above contexts for <code>intra_frame_y_mode</code>
     <tr>
      <td><code>COMP_GROUP_IDX_CONTEXTS</code>
      <td style="text-align: center">6
      <td>Number of contexts for <code>comp_group_idx</code>
     <tr>
      <td><code>COMPOUND_IDX_CONTEXTS</code>
      <td style="text-align: center">6
      <td>Number of contexts for <code>compound_idx</code>
     <tr>
      <td><code>INTRA_EDGE_KERNELS</code>
      <td style="text-align: center">3
      <td>Number of filter kernels for the intra edge filter
     <tr>
      <td><code>INTRA_EDGE_TAPS</code>
      <td style="text-align: center">5
      <td>Number of kernel taps for the intra edge filter
     <tr>
      <td><code>FRAME_LF_COUNT</code>
      <td style="text-align: center">4
      <td>Number of loop filter strength values
     <tr>
      <td><code>MAX_VARTX_DEPTH</code>
      <td style="text-align: center">2
      <td>Maximum depth for variable transform trees
     <tr>
      <td><code>TXFM_PARTITION_CONTEXTS</code>
      <td style="text-align: center">21
      <td>Number of contexts for txfm_split
     <tr>
      <td><code>REF_CAT_LEVEL</code>
      <td style="text-align: center">640
      <td>Bonus weight for close motion vectors
     <tr>
      <td><code>MAX_REF_MV_STACK_SIZE</code>
      <td style="text-align: center">8
      <td>Maximum number of motion vectors in the stack
     <tr>
      <td><code>MFMV_STACK_SIZE</code>
      <td style="text-align: center">3
      <td>Stack size for motion field motion vectors
     <tr>
      <td><code>MAX_TX_DEPTH</code>
      <td style="text-align: center">2
      <td>Maximum times the transform can be split
     <tr>
      <td><code>WEDGE_TYPES</code>
      <td style="text-align: center">16
      <td>Number of directions for the wedge mask process
     <tr>
      <td><code>FILTER_BITS</code>
      <td style="text-align: center">7
      <td>Number of bits used in Wiener filter coefficients
     <tr>
      <td><code>WIENER_COEFFS</code>
      <td style="text-align: center">3
      <td>Number of Wiener filter coefficients to read
     <tr>
      <td><code>SGRPROJ_PARAMS_BITS</code>
      <td style="text-align: center">4
      <td>Number of bits needed to specify self guided filter set
     <tr>
      <td><code>SGRPROJ_PRJ_SUBEXP_K</code>
      <td style="text-align: center">4
      <td>Controls how self guided deltas are read
     <tr>
      <td><code>SGRPROJ_PRJ_BITS</code>
      <td style="text-align: center">7
      <td>Precision bits during self guided restoration
     <tr>
      <td><code>SGRPROJ_RST_BITS</code>
      <td style="text-align: center">4
      <td>Restoration precision bits generated higher than source before projection
     <tr>
      <td><code>SGRPROJ_MTABLE_BITS</code>
      <td style="text-align: center">20
      <td>Precision of mtable division table
     <tr>
      <td><code>SGRPROJ_RECIP_BITS</code>
      <td style="text-align: center">12
      <td>Precision of division by n table
     <tr>
      <td><code>SGRPROJ_SGR_BITS</code>
      <td style="text-align: center">8
      <td>Internal precision bits for core selfguided_restoration
     <tr>
      <td><code>EC_PROB_SHIFT</code>
      <td style="text-align: center">6
      <td>Number of bits to reduce CDF precision during arithmetic coding
     <tr>
      <td><code>EC_MIN_PROB</code>
      <td style="text-align: center">4
      <td>Minimum probability assigned to each symbol during arithmetic coding
     <tr>
      <td><code>SELECT_SCREEN_CONTENT_TOOLS</code>
      <td style="text-align: center">2
      <td>Value that indicates the allow_screen_content_tools syntax element is coded
     <tr>
      <td><code>SELECT_INTEGER_MV</code>
      <td style="text-align: center">2
      <td>Value that indicates the force_integer_mv syntax element is coded
     <tr>
      <td><code>RESTORATION_TILESIZE_MAX</code>
      <td style="text-align: center">256
      <td>Maximum size of a loop restoration tile
     <tr>
      <td><code>MAX_FRAME_DISTANCE</code>
      <td style="text-align: center">31
      <td>Maximum distance when computing weighted prediction
     <tr>
      <td><code>MAX_OFFSET_WIDTH</code>
      <td style="text-align: center">8
      <td>Maximum horizontal offset of a projected motion vector
     <tr>
      <td><code>MAX_OFFSET_HEIGHT</code>
      <td style="text-align: center">0
      <td>Maximum vertical offset of a projected motion vector
     <tr>
      <td><code>WARP_PARAM_REDUCE_BITS</code>
      <td style="text-align: center">6
      <td>Rounding bitwidth for the parameters to the shear process
     <tr>
      <td><code>NUM_BASE_LEVELS</code>
      <td style="text-align: center">2
      <td>Number of quantizer base levels
     <tr>
      <td><code>COEFF_BASE_RANGE</code>
      <td style="text-align: center">12
      <td>The quantizer range above NUM_BASE_LEVELS above which the Exp-Golomb coding process is activated
     <tr>
      <td><code>BR_CDF_SIZE</code>
      <td style="text-align: center">4
      <td>Number of values for <code>coeff_br</code>
     <tr>
      <td><code>SIG_COEF_CONTEXTS_EOB</code>
      <td style="text-align: center">4
      <td>Number of contexts for <code>coeff_base_eob</code>
     <tr>
      <td><code>SIG_COEF_CONTEXTS_2D</code>
      <td style="text-align: center">26
      <td>Context offset for <code>coeff_base</code> for horizontal-only or vertical-only transforms.
     <tr>
      <td><code>SIG_COEF_CONTEXTS</code>
      <td style="text-align: center">42
      <td>Number of contexts for <code>coeff_base</code>
     <tr>
      <td><code>SIG_REF_DIFF_OFFSET_NUM</code>
      <td style="text-align: center">5
      <td>Maximum number of context samples to be used in determining the context index for <code>coeff_base</code> and <code>coeff_base_eob</code>.
     <tr>
      <td><code>SUPERRES_NUM</code>
      <td style="text-align: center">8
      <td>Numerator for upscaling ratio
     <tr>
      <td><code>SUPERRES_DENOM_MIN</code>
      <td style="text-align: center">9
      <td>Smallest denominator for upscaling ratio
     <tr>
      <td><code>SUPERRES_DENOM_BITS</code>
      <td style="text-align: center">3
      <td>Number of bits sent to specify denominator of upscaling ratio
     <tr>
      <td><code>SUPERRES_FILTER_BITS</code>
      <td style="text-align: center">6
      <td>Number of bits of fractional precision for upscaling filter selection
     <tr>
      <td><code>SUPERRES_FILTER_SHIFTS</code>
      <td style="text-align: center">1 &lt;&lt; SUPERRES_FILTER_BITS
      <td>Number of phases of upscaling filters
     <tr>
      <td><code>SUPERRES_FILTER_TAPS</code>
      <td style="text-align: center">8
      <td>Number of taps of upscaling filters
     <tr>
      <td><code>SUPERRES_FILTER_OFFSET</code>
      <td style="text-align: center">3
      <td>Sample offset for upscaling filters
     <tr>
      <td><code>SUPERRES_SCALE_BITS</code>
      <td style="text-align: center">14
      <td>Number of fractional bits for computing position in upscaling
     <tr>
      <td><code>SUPERRES_SCALE_MASK</code>
      <td style="text-align: center">(1 &lt;&lt; 14) - 1
      <td>Mask for computing position in upscaling
     <tr>
      <td><code>SUPERRES_EXTRA_BITS</code>
      <td style="text-align: center">8
      <td>Difference in precision between SUPERRES_SCALE_BITS and SUPERRES_FILTER_BITS
     <tr>
      <td><code>TXB_SKIP_CONTEXTS</code>
      <td style="text-align: center">13
      <td>Number of contexts for <code>all_zero</code>
     <tr>
      <td><code>EOB_COEF_CONTEXTS</code>
      <td style="text-align: center">9
      <td>Number of contexts for <code>eob_extra</code>
     <tr>
      <td><code>DC_SIGN_CONTEXTS</code>
      <td style="text-align: center">3
      <td>Number of contexts for <code>dc_sign</code>
     <tr>
      <td><code>LEVEL_CONTEXTS</code>
      <td style="text-align: center">21
      <td>Number of contexts for <code>coeff_br</code>
     <tr>
      <td><code>TX_CLASS_2D</code>
      <td style="text-align: center">0
      <td>Transform class for transform types performing non-identity transforms in both directions
     <tr>
      <td><code>TX_CLASS_HORIZ</code>
      <td style="text-align: center">1
      <td>Transform class for transforms performing only a horizontal non-identity transform
     <tr>
      <td><code>TX_CLASS_VERT</code>
      <td style="text-align: center">2
      <td>Transform class for transforms performing only a vertical non-identity transform
     <tr>
      <td><code>REFMVS_LIMIT</code>
      <td style="text-align: center">( 1 &lt;&lt; 12 ) - 1
      <td>Largest reference MV component that can be saved
     <tr>
      <td><code>INTRA_FILTER_SCALE_BITS</code>
      <td style="text-align: center">4
      <td>Scaling shift for intra filtering process
     <tr>
      <td><code>INTRA_FILTER_MODES</code>
      <td style="text-align: center">5
      <td>Number of types of intra filtering
     <tr>
      <td><code>COEFF_CDF_Q_CTXS</code>
      <td style="text-align: center">4
      <td>Number of selectable context types for the coeff( ) syntax structure
     <tr>
      <td><code>PRIMARY_REF_NONE</code>
      <td style="text-align: center">7
      <td>Value of <code>primary_ref_frame</code> indicating that there is no primary reference frame
     <tr>
      <td><code>BUFFER_POOL_MAX_SIZE</code>
      <td style="text-align: center">10
      <td>Number of frames in buffer pool
   </table>
   <h2 class="heading settled" data-level="4" id="conventions"><span class="secno">4. </span><span class="content">Conventions</span><a class="self-link" href="#conventions"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="conventions-general"><span class="secno">4.1. </span><span class="content">General</span><a class="self-link" href="#conventions-general"></a></h3>
   <p>The mathematical operators and their precedence rules used to describe this Specification are similar to those used in the C programming language. However, the operation of integer division with truncation is specifically defined.</p>
   <p>In addition, a length 2 array used to hold a motion vector (indicated by the variable name ending with the letters Mv or Mvs) can be accessed using either array notation (e.g. <code>Mv[ 0 ]</code> and <code>Mv[ 1 ]</code>), or by just the name (e.g., <code>Mv</code>). The only operations defined when using the name are assignment and equality/inequality testing. Assignment of an array is represented using the notation <code>A = B</code> and is specified to mean the same as doing both the individual assignments <code>A[ 0 ] = B[ 0 ]</code> and <code>A[ 1 ] = B[ 1 ]</code>. Equality testing of 2 motion vectors is represented using the notation <code>A == B</code> and is specified to mean the same as (<code>A[ 0 ] == B[ 0 ] &amp;&amp; A[ 1 ] == B[ 1 ]</code>). Inequality testing is defined as <code>A != B</code> and is specified to mean the same as (<code>A[ 0 ] != B[ 0 ] || A[ 1 ] != B[ 1 ]</code>).</p>
   <p>When a variable is said to be representable by a signed integer with <code>x</code> bits, it means that the variable is greater than or equal to <code>-(1 &lt;&lt; (x-1))</code>, and that the variable is less than or equal to <code>(1 &lt;&lt; (x-1))-1</code>.</p>
   <p>The key words “must”, “must not”, “required”, “shall”, “shall not”, “should”, “should not”, “recommended”, “may”, and “optional” in this document are to be interpreted as described in RFC 2119.</p>
   <h3 class="heading settled" data-level="4.2" id="conventions-arithmetic-operators"><span class="secno">4.2. </span><span class="content">Arithmetic operators</span><a class="self-link" href="#conventions-arithmetic-operators"></a></h3>
   <table class="table table-sm table-bordered table-nohead">
    <tbody>
     <tr>
      <td>+
      <td>Addition
     <tr>
      <td>–
      <td>Subtraction (as a binary operator) or negation (as a unary prefix operator)
     <tr>
      <td>*
      <td>Multiplication
     <tr>
      <td>/
      <td>Integer division with truncation of the result toward zero. For example, <code>7/4</code> and <code>-7/-4</code> are truncated to <code>1</code> and <code>-7/4</code> and <code>7/-4</code> are truncated to <code>-1</code>.
     <tr>
      <td>a % b
      <td>Remainder from division of <code>a</code> by <code>b</code>. Both <code>a</code> and <code>b</code> are positive integers.
     <tr>
      <td>÷
      <td>Floating point (arithmetical) division.
     <tr>
      <td>ceil(x)
      <td>The smallest integer that is greater or equal than <code>x</code>.
     <tr>
      <td>floor(x)
      <td>The largest integer that is smaller or equal than <code>x</code>.
   </table>
   <h3 class="heading settled" data-level="4.3" id="conventions-logical-operators"><span class="secno">4.3. </span><span class="content">Logical operators</span><a class="self-link" href="#conventions-logical-operators"></a></h3>
   <table class="table table-sm table-bordered table-nohead">
    <tbody>
     <tr>
      <td>a &amp;&amp; b
      <td>Logical AND operation between <code>a</code> and <code>b</code>
     <tr>
      <td>a || b
      <td>Logical OR operation between <code>a</code> and <code>b</code>
     <tr>
      <td>!
      <td>Logical NOT operation.
   </table>
   <h3 class="heading settled" data-level="4.4" id="conventions-relational-operators"><span class="secno">4.4. </span><span class="content">Relational operators</span><a class="self-link" href="#conventions-relational-operators"></a></h3>
   <table class="table table-sm table-bordered table-nohead">
    <tbody>
     <tr>
      <td>>
      <td>Greater than
     <tr>
      <td>>=
      <td>Greater than or equal to
     <tr>
      <td>&lt;
      <td>Less than
     <tr>
      <td>&lt;=
      <td>Less than or equal to
     <tr>
      <td>==
      <td>Equal to
     <tr>
      <td>!=
      <td>Not equal to
   </table>
   <h3 class="heading settled" data-level="4.5" id="conventions-bitwise-operators"><span class="secno">4.5. </span><span class="content">Bitwise operators</span><a class="self-link" href="#conventions-bitwise-operators"></a></h3>
   <table class="table table-sm table-bordered table-nohead">
    <tbody>
     <tr>
      <td>&amp;
      <td>AND operation
     <tr>
      <td>|
      <td>OR operation
     <tr>
      <td>^
      <td>XOR operation
     <tr>
      <td>~
      <td>Negation operation
     <tr>
      <td>a >> b
      <td>Shift <code>a</code> in 2’s complement binary integer representation format to the right by <code>b</code> bit positions. This operator is only used with <code>b</code> being a non-negative integer. Bits shifted into the MSBs as a result of the right shift have a value equal to the MSB of <code>a</code> prior to the shift operation.
     <tr>
      <td>a &lt;&lt; b
      <td>Shift <code>a</code> in 2’s complement binary integer representation format to the left by <code>b</code> bit positions. This operator is only used with <code>b</code> being a non-negative integer. Bits shifted into the LSBs as a result of the left shift have a value equal to <code>0</code>.
   </table>
   <h3 class="heading settled" data-level="4.6" id="conventions-assignment"><span class="secno">4.6. </span><span class="content">Assignment</span><a class="self-link" href="#conventions-assignment"></a></h3>
   <table class="table table-sm table-bordered table-nohead">
    <tbody>
     <tr>
      <td>=
      <td>Assignment operator
     <tr>
      <td>++
      <td>Increment, <code>x++</code> is equivalent to <code>x = x + 1</code>. When this operator is used for an array index, the variable value is obtained before the auto increment operation
     <tr>
      <td>- -
      <td>Decrement, i.e. <code>x--</code> is equivalent to <code>x = x - 1</code>. When this operator is used for an array index, the variable value is obtained before the auto decrement operation
     <tr>
      <td>+=
      <td>Addition assignment operator, for example <code>x += 3</code> corresponds to <code>x = x + 3</code>
     <tr>
      <td>-=
      <td>Subtraction assignment operator, for example <code>x -= 3</code> corresponds to <code>x = x - 3</code>
   </table>
   <h3 class="heading settled" data-level="4.7" id="conventions-mathematical-functions"><span class="secno">4.7. </span><span class="content">Mathematical functions</span><a class="self-link" href="#conventions-mathematical-functions"></a></h3>
   <p>The following mathematical functions (Abs, Clip3, Clip1, Min, Max, Round2 and Round2Signed) are defined as follows:</p>
   <p>\[
\text{Abs}(x) =
\begin{cases}
x; &amp; x \geq 0\\
-x; &amp; x &lt; 0
\end{cases}
\]</p>
   <p>\[
  \text{Clip1}(x) = \text{Clip3}(0, 2^{BitDepth}-1, x)
\]</p>
   <p>\[
\text{Clip3}(x,y,z) =
\begin{cases}
x; &amp; z &lt; x \\
y; &amp; z > y \\
z; &amp; \text{otherwise}
\end{cases}
\]</p>
   <p>\[
\text{Min}(x, y) =
\begin{cases}
x; &amp; x \leq y \\
y; &amp; x > y
\end{cases}
\]</p>
   <p>\[
\text{Max}(x, y) =
\begin{cases}
x; &amp; x \geq y \\
y; &amp; x &lt; y
\end{cases}
\]</p>
   <p>\[
  \text{Round2}(x,n) = \left\lfloor \frac{x+2^{n-1}}{2^n} \right\rfloor
\]</p>
   <p>\[
  \text{Round2Signed}(x,n) =
\begin{cases}
\text{Round2}(x,n); &amp; x \geq 0\\
-\text{Round2}(-x,n); &amp; x &lt; 0
\end{cases}
\]</p>
   <p>The definition of Round2 uses standard mathematical power and division operations, not integer operations. An equivalent definition using integer operations is:</p>
<pre class="language-cpp highlight"><c- n>Round2</c-><c- p>(</c-> <c- n>x</c-><c- p>,</c-> <c- n>n</c-> <c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
    <c- k>return</c-> <c- n>x</c-><c- p>;</c->
  <c- k>return</c-> <c- p>(</c-><c- n>x</c-> <c- o>+</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- p>(</c-><c- n>n</c-> <c- o>-</c-> <c- mi>1</c-><c- p>))</c-> <c- p>)</c-> <c- o>></c-> <c- o>></c-> <c- n>n</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <p>The <code>FloorLog2(x)</code> function is defined to be the floor of the base 2 logarithm of the input x.</p>
   <p>The input x will always be an integer, and will always be greater than or equal to 1.</p>
   <p>This function extracts the location of the most significant bit in x.</p>
   <p>An equivalent definition (using the pseudo-code notation introduced in the following section) is:</p>
<pre class="language-cpp highlight"><c- n>FloorLog2</c-><c- p>(</c-> <c- n>x</c-> <c- p>)</c-> <c- p>{</c->
  <c- n>s</c-> <c- o>=</c-> <c- mi>0</c->
  <c- k>while</c-> <c- p>(</c-> <c- n>x</c-> <c- o>!=</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
    <c- n>x</c-> <c- o>=</c-> <c- n>x</c-> <c- o>>></c-> <c- mi>1</c->
    <c- n>s</c-><c- o>++</c->
  <c- p>}</c->
  <c- k>return</c-> <c- n>s</c-> <c- o>-</c-> <c- mi>1</c->
<c- p>}</c->
</pre>
   <p>The <code>CeilLog2(x)</code> function is defined to be the ceiling of the base 2 logarithm of the input x (when x is 0, it is defined to return 0).</p>
   <p>The input x will always be an integer, and will always be greater than or equal to 0.</p>
   <p>This function extracts the number of bits needed to code a value in the range 0 to x-1.</p>
   <p>An equivalent definition (using the pseudo-code notation introduced in the following section) is:</p>
<pre class="language-cpp highlight"><c- n>CeilLog2</c-><c- p>(</c-> <c- n>x</c-> <c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- mi>2</c-> <c- p>)</c->
    <c- k>return</c-> <c- mi>0</c->
  <c- n>i</c-> <c- o>=</c-> <c- mi>1</c->
  <c- n>p</c-> <c- o>=</c-> <c- mi>2</c->
  <c- k>while</c-> <c- p>(</c-> <c- n>p</c-> <c- o>&lt;</c-> <c- n>x</c-> <c- p>)</c-> <c- p>{</c->
    <c- n>i</c-><c- o>++</c->
    <c- n>p</c-> <c- o>=</c-> <c- n>p</c-> <c- o>&lt;&lt;</c-> <c- mi>1</c->
  <c- p>}</c->
  <c- k>return</c-> <c- n>i</c->
<c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="4.8" id="conventions-bitstream-syntax"><span class="secno">4.8. </span><span class="content">Method of describing bitstream syntax</span><a class="self-link" href="#conventions-bitstream-syntax"></a></h3>
   <p>The description style of the syntax is similar to the C programming language. Syntax elements in the bitstream are represented in bold type. Each syntax element is described by its name (using only lower case letters with underscore characters) and a descriptor for its method of coded representation. The decoding process behaves according to the value of the syntax element and to the values of previously decoded syntax elements. When a value of a syntax element is used in the syntax tables or the text, it appears in regular (i.e. not bold) type. If the value of a syntax element is being computed (e.g. being written with a default value instead of being coded in the bitstream), it also appears in regular type (e.g. tile_size_minus_1).</p>
   <p>In some cases the syntax tables may use the values of other variables derived from syntax elements values. Such variables appear in the syntax tables, or text, named by a mixture of lower case and upper case letter and without any underscore characters. Variables starting with an upper case letter are derived for the decoding of the current syntax structure and all depending syntax structures. These variables may be used in the decoding process for later syntax structures. Variables starting with a lower case letter are only used within the process from which they are derived. (Single character variables are allowed.)</p>
   <p>Constant values appear in all upper case letters with underscore characters (e.g. MI_SIZE).</p>
   <p>Constant lookup tables appear as words (with the first letter of each word in upper case, and remaining letters in lower case) separated with underscore characters (e.g. Block_Width[…]).</p>
   <p>Hexadecimal notation, indicated by prefixing the hexadecimal number by <code>0x</code>, may be used when the number of bits is an integer multiple of 4. For example, <code>0x1a</code> represents a bit string <code>0001 1010</code>.</p>
   <p>Binary notation is indicated by prefixing the binary number by <code>0b</code>. For example, <code>0b00011010</code> represents a bit string <code>0001 1010</code>. Binary numbers may include underscore characters to enhance readability. If present, the underscore characters appear every 4 binary digits starting from the LSB. For example, <code>0b11010</code> may also be written as <code>0b1_1010</code>.</p>
   <p>A value equal to 0 represents a FALSE condition in a test statement. The value TRUE is represented by any value not equal to 0.</p>
   <p>The following table lists examples of the syntax specification format. When <code>syntax_element</code> appears (with bold face font), it specifies that this syntax element is parsed from the bitstream.</p>
   <p>TBD</p>
   <h3 class="heading settled" data-level="4.9" id="conventions-functions"><span class="secno">4.9. </span><span class="content">Functions</span><a class="self-link" href="#conventions-functions"></a></h3>
   <p>Bitstream functions used for syntax description are specified in this section.</p>
   <p>Other functions are included in the syntax tables. The convention is that a section is called syntax if it causes syntax elements to be read from the bitstream, either directly or indirectly through subprocesses. The remaining sections are called functions.</p>
   <p>The specification of these functions makes use of a bitstream position indicator. This bitstream position indicator locates the position of the bit that is going to be read next.</p>
   <p><strong>get_position( )</strong>: Return the value of the bitstream position indicator.</p>
   <p><strong>init_symbol( sz )</strong>: Initialize the arithmetic decode process for the Symbol decoder with a size of sz bytes as specified in section 8.2.2 (TBD).</p>
   <p><strong>exit_symbol( )</strong>: Exit the arithmetic decode process as described in section 8.2.4 (TBD) (this includes reading trailing bits).</p>
   <h3 class="heading settled" data-level="4.10" id="conventions-descriptors"><span class="secno">4.10. </span><span class="content">Descriptors</span><a class="self-link" href="#conventions-descriptors"></a></h3>
   <h4 class="heading settled" data-level="4.10.1" id="conventions-descriptors-general"><span class="secno">4.10.1. </span><span class="content">General</span><a class="self-link" href="#conventions-descriptors-general"></a></h4>
   <p>The following descriptors specify the parsing of syntax elements. Lower case descriptors specify syntax elements that are represented by an integer number of bits in the bitstream; upper case descriptors specify syntax elements that are represented by arithmetic coding.</p>
   <h4 class="heading settled" data-level="4.10.2" id="conventions-descriptors-fn"><span class="secno">4.10.2. </span><span class="content">f(n)</span><a class="self-link" href="#conventions-descriptors-fn"></a></h4>
   <h4 class="heading settled" data-level="4.10.3" id="conventions-descriptors-uvlc"><span class="secno">4.10.3. </span><span class="content">uvlc()</span><a class="self-link" href="#conventions-descriptors-uvlc"></a></h4>
   <h4 class="heading settled" data-level="4.10.4" id="conventions-descriptors-len"><span class="secno">4.10.4. </span><span class="content">le(n)</span><a class="self-link" href="#conventions-descriptors-len"></a></h4>
   <h4 class="heading settled" data-level="4.10.5" id="conventions-descriptors-leb128"><span class="secno">4.10.5. </span><span class="content">leb128()</span><a class="self-link" href="#conventions-descriptors-leb128"></a></h4>
   <h4 class="heading settled" data-level="4.10.6" id="conventions-descriptors-sun"><span class="secno">4.10.6. </span><span class="content">su(n)</span><a class="self-link" href="#conventions-descriptors-sun"></a></h4>
   <h4 class="heading settled" data-level="4.10.7" id="conventions-descriptors-nsn"><span class="secno">4.10.7. </span><span class="content">ns(n)</span><a class="self-link" href="#conventions-descriptors-nsn"></a></h4>
   <h4 class="heading settled" data-level="4.10.8" id="conventions-descriptors-ln"><span class="secno">4.10.8. </span><span class="content">L(n)</span><a class="self-link" href="#conventions-descriptors-ln"></a></h4>
   <h4 class="heading settled" data-level="4.10.9" id="conventions-descriptors-s"><span class="secno">4.10.9. </span><span class="content">S()</span><a class="self-link" href="#conventions-descriptors-s"></a></h4>
   <h4 class="heading settled" data-level="4.10.10" id="conventions-descriptors-nsn2"><span class="secno">4.10.10. </span><span class="content">NS(n)</span><a class="self-link" href="#conventions-descriptors-nsn2"></a></h4>
   <h2 class="heading settled" data-level="5" id="syntax_structures"><span class="secno">5. </span><span class="content">Syntax structures</span><a class="self-link" href="#syntax_structures"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="general"><span class="secno">5.1. </span><span class="content">General</span><a class="self-link" href="#general"></a></h3>
   <p>This section presents the syntax structures in a tabular form. The meaning of
each of the syntax elements is presented in [Section 6][].</p>
   <h3 class="heading settled" data-level="5.2" id="low_overhead_bitstream_format"><span class="secno">5.2. </span><span class="content">Low overhead bitstream format</span><a class="self-link" href="#low_overhead_bitstream_format"></a></h3>
   <p>This specification defines a low-overhead bitstream format as a sequence of the OBU syntactical elements defined in this section.
When using this format, obu_has_size_field must be equal to 1.
For applications requiring a format where it is easier to skip through frames or temporal units,
a length-delimited bitstream format is defined in Annex B.</p>
   <p>Derived specifications, such as container formats enabling storage of AV1 videos together with audio or
subtitles, should indicate which of these formats they rely on.
Other methods of packing OBUs into a bitstream format are also allowed.</p>
   <h3 class="heading settled" data-level="5.3" id="obu_syntax"><span class="secno">5.3. </span><span class="content">OBU syntax</span><a class="self-link" href="#obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.3.1" id="general_obu_syntax"><span class="secno">5.3.1. </span><span class="content">General OBU syntax</span><a class="self-link" href="#general_obu_syntax"></a></h4>
   <table class="syntax">
    <tbody>
     <tr>
      <td>
<pre>open_bitstream_unit( sz ) {
    obu_header()
    if ( obu_has_size_field ) {
        @@obu_size
    } else {
        obu_size = sz - 1 - obu_extension_flag
    }
    startPosition = get_position( )
    if ( obu_type != OBU_SEQUENCE_HEADER &amp;&amp;
         obu_type != OBU_TEMPORAL_DELIMITER &amp;&amp;
         OperatingPointIdc != 0 &amp;&amp;
         obu_extension_flag == 1 )
    {
        inTemporalLayer = (OperatingPointIdc \>\> temporal_id ) &amp; 1
        inSpatialLayer = (OperatingPointIdc \>\> ( spatial_id + 8 ) ) &amp; 1
        if ( !inTemporalLayer \|\| ! inSpatialLayer ) {
            drop_obu( )
            return
        }
    }
    if ( obu_type == OBU_SEQUENCE_HEADER )
        sequence_header_obu( )
    else if ( obu_type == OBU_TEMPORAL_DELIMITER )
        temporal_delimiter_obu( )
    else if ( obu_type == OBU_FRAME_HEADER )
        frame_header_obu( )
    else if ( obu_type == OBU_REDUNDANT_FRAME_HEADER )
        frame_header_obu( )
    else if ( obu_type == OBU_TILE_GROUP )
        tile_group_obu( obu_size )
    else if ( obu_type == OBU_METADATA )
        metadata_obu( )
    else if ( obu_type == OBU_FRAME )
        frame_obu( obu_size )
    else if ( obu_type == OBU_TILE_LIST )
        tile_list_obu( )
    else if ( obu_type == OBU_PADDING )
        padding_obu( )
    else
        reserved_obu( )
    currentPosition = get_position( )
    payloadBits = currentPosition - startPosition
    if ( obu_size > 0 &amp;&amp; obu_type != OBU_TILE_GROUP &amp;&amp;
         obu_type != OBU_TILE_LIST &amp;&amp;
         obu_type != OBU_FRAME ) {
        trailing_bits( obu_size * 8 - payloadBits )
    }
}
</pre>
      <td>
        <strong>Type</strong> 
       <p>leb128()</p>
   </table>
<pre class="language-cpp highlight"><c- n>open_bitstream_unit</c-><c- p>(</c-> <c- n>sz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>obu_header</c-><c- p>()</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>obu_has_size_field</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>leb128</c-><c- p>()</c-> <c- n>obu_size</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>obu_size</c-> <c- o>=</c-> <c- n>sz</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>obu_extension_flag</c->
     <c- p>}</c->
     <c- n>startPosition</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>!=</c-> <c- n>OBU_SEQUENCE_HEADER</c-> <c- o>&amp;&amp;</c->
          <c- n>obu_type</c-> <c- o>!=</c-> <c- n>OBU_TEMPORAL_DELIMITER</c-> <c- o>&amp;&amp;</c->
          <c- n>OperatingPointIdc</c-> <c- o>!=</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c->
          <c- n>obu_extension_flag</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
     <c- p>{</c->
         <c- n>inTemporalLayer</c-> <c- o>=</c-> <c- p>(</c-><c- n>OperatingPointIdc</c-> <c- o>>></c-> <c- n>temporal_id</c-> <c- p>)</c-> <c- o>&amp;</c-> <c- mi>1</c->
         <c- n>inSpatialLayer</c-> <c- o>=</c-> <c- p>(</c-><c- n>OperatingPointIdc</c-> <c- o>>></c-> <c- p>(</c-> <c- n>spatial_id</c-> <c- o>+</c-> <c- mi>8</c-> <c- p>)</c-> <c- p>)</c-> <c- o>&amp;</c-> <c- mi>1</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>inTemporalLayer</c-> \
             <c- n>drop_obu</c-><c- p>(</c-> <c- p>)</c->
             <c- k>return</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_SEQUENCE_HEADER</c-> <c- p>)</c->
         <c- n>sequence_header_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_TEMPORAL_DELIMITER</c-> <c- p>)</c->
         <c- n>temporal_delimiter_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_FRAME_HEADER</c-> <c- p>)</c->
         <c- n>frame_header_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_REDUNDANT_FRAME_HEADER</c-> <c- p>)</c->
         <c- n>frame_header_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_TILE_GROUP</c-> <c- p>)</c->
         <c- n>tile_group_obu</c-><c- p>(</c-> <c- n>obu_size</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_METADATA</c-> <c- p>)</c->
         <c- n>metadata_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_FRAME</c-> <c- p>)</c->
         <c- n>frame_obu</c-><c- p>(</c-> <c- n>obu_size</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_TILE_LIST</c-> <c- p>)</c->
         <c- n>tile_list_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>obu_type</c-> <c- o>==</c-> <c- n>OBU_PADDING</c-> <c- p>)</c->
         <c- n>padding_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c->
         <c- n>reserved_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- n>currentPosition</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- n>payloadBits</c-> <c- o>=</c-> <c- n>currentPosition</c-> <c- o>-</c-> <c- n>startPosition</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>obu_size</c-> <c- o>></c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>obu_type</c-> <c- o>!=</c-> <c- n>OBU_TILE_GROUP</c-> <c- o>&amp;&amp;</c->
          <c- n>obu_type</c-> <c- o>!=</c-> <c- n>OBU_TILE_LIST</c-> <c- o>&amp;&amp;</c->
          <c- n>obu_type</c-> <c- o>!=</c-> <c- n>OBU_FRAME</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>trailing_bits</c-><c- p>(</c-> <c- n>obu_size</c-> <c- o>*</c-> <c- mi>8</c-> <c- o>-</c-> <c- n>payloadBits</c-> <c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.3.2" id="obu_header_syntax"><span class="secno">5.3.2. </span><span class="content">OBU header syntax</span><a class="self-link" href="#obu_header_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>obu_header</c-><c- p>()</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>obu_forbidden_bit</c->
      <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>obu_type</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>obu_extension_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>obu_has_size_field</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>obu_reserved_1bit</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>obu_extension_flag</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
         <c- n>obu_extension_header</c-><c- p>()</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.3.3" id="obu_extension_header_syntax"><span class="secno">5.3.3. </span><span class="content">OBU extension header syntax</span><a class="self-link" href="#obu_extension_header_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>obu_extension_header</c-><c- p>()</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>temporal_id</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>spatial_id</c->
      <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>extension_header_reserved_3bits</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.3.4" id="trailing_bits_syntax"><span class="secno">5.3.4. </span><span class="content">Trailing bits syntax</span><a class="self-link" href="#trailing_bits_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>trailing_bits</c-><c- p>(</c-> <c- n>nbBits</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>trailing_one_bit</c->
     <c- n>nbBits</c-><c- o>--</c-><c- p>;</c->
     <c- k>while</c-> <c- p>(</c-> <c- n>nbBits</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>trailing_zero_bit</c->
         <c- n>nbBits</c-><c- o>--</c-><c- p>;</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.3.5" id="byte_alignment_syntax"><span class="secno">5.3.5. </span><span class="content">Byte alignment syntax</span><a class="self-link" href="#byte_alignment_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>byte_alignment</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>while</c-> <c- p>(</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c-> <c- o>&amp;</c-> <c- mi>7</c-> <c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>zero_bit</c->
 <c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="5.4" id="reserved_obu_syntax"><span class="secno">5.4. </span><span class="content">Reserved OBU syntax</span><a class="self-link" href="#reserved_obu_syntax"></a></h3>
<pre class="language-cpp highlight"><c- n>reserved_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> Reserved OBUs do not have a defined syntax. The obu_type reserved
values are reserved for future use. Decoders should ignore the entire OBU if
they do not understand the obu_type. Ignoring the OBU can be done based on
obu_size. The last byte of the valid content of the payload data for this OBU type
is considered to be the last byte that is not equal to zero.
This rule is to prevent the dropping of valid bytes by systems that
interpret trailing zero bytes as a continuation of the trailing bits in an OBU.
This implies that when any payload data is present for this OBU type,
at least one byte of the payload data (including the trailing bit) shall not be equal to 0.
{:.alert .alert-info }</p>
   <h3 class="heading settled" data-level="5.5" id="sequence_header_obu_syntax"><span class="secno">5.5. </span><span class="content">Sequence header OBU syntax</span><a class="self-link" href="#sequence_header_obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.5.1" id="general_sequence_header_obu_syntax"><span class="secno">5.5.1. </span><span class="content">General sequence header OBU syntax</span><a class="self-link" href="#general_sequence_header_obu_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>sequence_header_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>seq_profile</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>still_picture</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>reduced_still_picture_header</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>timing_info_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>decoder_model_info_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>initial_display_delay_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>operating_points_cnt_minus_1</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>operating_point_idc</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
          <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>seq_level_idx</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
         <c- n>seq_tier</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>decoder_model_present_for_this_op</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>initial_display_delay_present_for_this_op</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>timing_info_present_flag</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>timing_info_present_flag</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>timing_info</c-><c- p>(</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>decoder_model_info_present_flag</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_info_present_flag</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>decoder_model_info</c-><c- p>(</c-> <c- p>)</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>decoder_model_info_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>initial_display_delay_present_flag</c->
          <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>operating_points_cnt_minus_1</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>operating_points_cnt_minus_1</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>12</c-><c- p>)</c-> <c- n>operating_point_idc</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>seq_level_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>seq_level_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>></c-> <c- mi>7</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seq_tier</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>seq_tier</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_info_present_flag</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>decoder_model_present_for_this_op</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_present_for_this_op</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>operating_parameters_info</c-><c- p>(</c-> <c- n>i</c-> <c- p>)</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>decoder_model_present_for_this_op</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>initial_display_delay_present_flag</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>initial_display_delay_present_for_this_op</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>initial_display_delay_present_for_this_op</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>initial_display_delay_minus_1</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>operatingPoint</c-> <c- o>=</c-> <c- n>choose_operating_point</c-><c- p>(</c-> <c- p>)</c->
     <c- n>OperatingPointIdc</c-> <c- o>=</c-> <c- n>operating_point_idc</c-><c- p>[</c-> <c- n>operatingPoint</c-> <c- p>]</c->
      <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>frame_width_bits_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>frame_height_bits_minus_1</c->
     <c- n>n</c-> <c- o>=</c-> <c- n>frame_width_bits_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
      <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>max_frame_width_minus_1</c->
     <c- n>n</c-> <c- o>=</c-> <c- n>frame_height_bits_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
      <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>max_frame_height_minus_1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> <c- p>)</c->
         <c- n>frame_id_numbers_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>else</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>frame_id_numbers_present_flag</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_id_numbers_present_flag</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>delta_frame_id_length_minus_2</c->
          <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>additional_frame_id_length_minus_1</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>use_128x128_superblock</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_filter_intra</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_intra_edge_filter</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>enable_interintra_compound</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_masked_compound</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_warped_motion</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_dual_filter</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_order_hint</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_jnt_comp</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>enable_ref_frame_mvs</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>seq_force_screen_content_tools</c-> <c- o>=</c-> <c- n>SELECT_SCREEN_CONTENT_TOOLS</c->
         <c- n>seq_force_integer_mv</c-> <c- o>=</c-> <c- n>SELECT_INTEGER_MV</c->
         <c- n>OrderHintBits</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_interintra_compound</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_masked_compound</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_warped_motion</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_dual_filter</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_order_hint</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>enable_order_hint</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_jnt_comp</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_ref_frame_mvs</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>enable_jnt_comp</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>enable_ref_frame_mvs</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seq_choose_screen_content_tools</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>seq_choose_screen_content_tools</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>seq_force_screen_content_tools</c-> <c- o>=</c-> <c- n>SELECT_SCREEN_CONTENT_TOOLS</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seq_force_screen_content_tools</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>seq_force_screen_content_tools</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seq_choose_integer_mv</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>seq_choose_integer_mv</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>seq_force_integer_mv</c-> <c- o>=</c-> <c- n>SELECT_INTEGER_MV</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seq_force_integer_mv</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>seq_force_integer_mv</c-> <c- o>=</c-> <c- n>SELECT_INTEGER_MV</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>enable_order_hint</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>order_hint_bits_minus_1</c->
             <c- n>OrderHintBits</c-> <c- o>=</c-> <c- n>order_hint_bits_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>OrderHintBits</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_superres</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_cdef</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>enable_restoration</c->
     <c- n>color_config</c-><c- p>(</c-> <c- p>)</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>film_grain_params_present</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.5.2" id="color_config_syntax"><span class="secno">5.5.2. </span><span class="content">Color config syntax</span><a class="self-link" href="#color_config_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>color_config</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>high_bitdepth</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>seq_profile</c-> <c- o>==</c-> <c- mi>2</c-> <c- o>&amp;&amp;</c-> <c- n>high_bitdepth</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>twelve_bit</c->
         <c- n>BitDepth</c-> <c- o>=</c-> <c- n>twelve_bit</c-> <c- o>?</c-> <c- mi>12</c-> <c- o>:</c-> <c- mi>10</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seq_profile</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>BitDepth</c-> <c- o>=</c-> <c- n>high_bitdepth</c-> <c- o>?</c-> <c- mi>10</c-> <c- o>:</c-> <c- mi>8</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>seq_profile</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>mono_chrome</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>mono_chrome</c->
     <c- p>}</c->
     <c- n>NumPlanes</c-> <c- o>=</c-> <c- n>mono_chrome</c-> <c- o>?</c-> <c- mi>1</c-> <c- o>:</c-> <c- mi>3</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>color_description_present_flag</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>color_description_present_flag</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>color_primaries</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>transfer_characteristics</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>matrix_coefficients</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>color_primaries</c-> <c- o>=</c-> <c- n>CP_UNSPECIFIED</c->
         <c- n>transfer_characteristics</c-> <c- o>=</c-> <c- n>TC_UNSPECIFIED</c->
         <c- n>matrix_coefficients</c-> <c- o>=</c-> <c- n>MC_UNSPECIFIED</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mono_chrome</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>color_range</c->
         <c- n>subsampling_x</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>chroma_sample_position</c-> <c- o>=</c-> <c- n>CSP_UNKNOWN</c->
         <c- n>separate_uv_delta_q</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>return</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>color_primaries</c-> <c- o>==</c-> <c- n>CP_BT_709</c-> <c- o>&amp;&amp;</c->
                 <c- n>transfer_characteristics</c-> <c- o>==</c-> <c- n>TC_SRGB</c-> <c- o>&amp;&amp;</c->
                 <c- n>matrix_coefficients</c-> <c- o>==</c-> <c- n>MC_IDENTITY</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>color_range</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>subsampling_x</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>color_range</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>seq_profile</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>subsampling_x</c-> <c- o>=</c-> <c- mi>1</c->
             <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seq_profile</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>subsampling_x</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>BitDepth</c-> <c- o>==</c-> <c- mi>12</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>subsampling_x</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>subsampling_x</c-> <c- p>)</c->
                      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>subsampling_y</c->
                 <c- k>else</c->
                     <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>subsampling_x</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- n>subsampling_y</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>subsampling_x</c-> <c- o>&amp;&amp;</c-> <c- n>subsampling_y</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>chroma_sample_position</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>separate_uv_delta_q</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.5.3" id="timing_info_syntax"><span class="secno">5.5.3. </span><span class="content">Timing info syntax</span><a class="self-link" href="#timing_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>timing_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>32</c-><c- p>)</c-> <c- n>num_units_in_display_tick</c->
      <c- n>f</c-><c- p>(</c-><c- mi>32</c-><c- p>)</c-> <c- n>time_scale</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>equal_picture_interval</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>equal_picture_interval</c-> <c- p>)</c->
         <c- n>uvlc</c-><c- p>()</c-> <c- n>num_ticks_per_picture_minus_1</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.5.4" id="decoder_model_info_syntax"><span class="secno">5.5.4. </span><span class="content">Decoder model info syntax</span><a class="self-link" href="#decoder_model_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decoder_model_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>buffer_delay_length_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>32</c-><c- p>)</c-> <c- n>num_units_in_decoding_tick</c->
      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>buffer_removal_time_length_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>frame_presentation_time_length_minus_1</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.5.5" id="operating_parameters_info_syntax"><span class="secno">5.5.5. </span><span class="content">Operating parameters info syntax</span><a class="self-link" href="#operating_parameters_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>operating_parameters_info</c-><c- p>(</c-> <c- n>op</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>n</c-> <c- o>=</c-> <c- n>buffer_delay_length_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
      <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>decoder_buffer_delay</c-><c- p>[</c-> <c- n>op</c-> <c- p>]</c->
      <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>encoder_buffer_delay</c-><c- p>[</c-> <c- n>op</c-> <c- p>]</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>low_delay_mode_flag</c-><c- p>[</c-> <c- n>op</c-> <c- p>]</c->
 <c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="5.6" id="temporal_delimiter_obu_syntax"><span class="secno">5.6. </span><span class="content">Temporal delimiter obu syntax</span><a class="self-link" href="#temporal_delimiter_obu_syntax"></a></h3>
<pre class="language-cpp highlight"><c- n>temporal_delimiter_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>SeenFrameHeader</c-> <c- o>=</c-> <c- mi>0</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> The temporal delimiter has an empty payload.
{:.alert .alert-info }</p>
   <h3 class="heading settled" data-level="5.7" id="padding_obu_syntax"><span class="secno">5.7. </span><span class="content">Padding OBU syntax</span><a class="self-link" href="#padding_obu_syntax"></a></h3>
<pre class="language-cpp highlight"><c- n>padding_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>obu_padding_length</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>obu_padding_byte</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> obu_padding_length is not coded in the bitstream but can be computed
based on obu_size minus the number of trailing bytes.
In practice, though, since this is
padding data meant to be skipped, decoders do not need to determine either
that length nor the number of trailing bytes. They can ignore the entire OBU.
Ignoring the OBU can be done based on obu_size.
The last byte of the valid content of the payload data for this OBU type
is considered to be the last byte that is not equal to zero.
This rule is to prevent the dropping of valid bytes by systems that
interpret trailing zero bytes as a continuation of the trailing bits in an OBU.
This implies that when any payload data is present for this OBU type,
at least one byte of the payload data (including the trailing bit) shall not be equal to 0.
{:.alert .alert-info }</p>
   <h3 class="heading settled" data-level="5.8" id="metadata_obu_syntax"><span class="secno">5.8. </span><span class="content">Metadata OBU syntax</span><a class="self-link" href="#metadata_obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.8.1" id="general_metadata_obu_syntax"><span class="secno">5.8.1. </span><span class="content">General metadata OBU syntax</span><a class="self-link" href="#general_metadata_obu_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>leb128</c-><c- p>()</c-> <c- n>metadata_type</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>metadata_type</c-> <c- o>==</c-> <c- n>METADATA_TYPE_ITUT_T35</c-> <c- p>)</c->
         <c- n>metadata_itut_t35</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>metadata_type</c-> <c- o>==</c-> <c- n>METADATA_TYPE_HDR_CLL</c-> <c- p>)</c->
         <c- n>metadata_hdr_cll</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>metadata_type</c-> <c- o>==</c-> <c- n>METADATA_TYPE_HDR_MDCV</c-> <c- p>)</c->
         <c- n>metadata_hdr_mdcv</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>metadata_type</c-> <c- o>==</c-> <c- n>METADATA_TYPE_SCALABILITY</c-> <c- p>)</c->
         <c- n>metadata_scalability</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>metadata_type</c-> <c- o>==</c-> <c- n>METADATA_TYPE_TIMECODE</c-> <c- p>)</c->
         <c- n>metadata_timecode</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> The exact syntax of metadata_obu is not defined
in this specification when metadata_type is equal to
a value reserved for future use or a user private value.
Decoders should ignore the entire OBU if they do not understand the metadata_type.
The last byte of the valid content of the data is
considered to be the last byte that is not equal to zero. This rule is to
prevent the dropping of valid bytes by systems that interpret trailing zero
bytes as a padding continuation of the trailing bits in an OBU.
This implies that when any payload data is present for this OBU type,
at least one byte of the payload data (including the trailing bit) shall not be equal to 0.
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.8.2" id="metadata_itut_t35_syntax"><span class="secno">5.8.2. </span><span class="content">Metadata ITUT T35 syntax</span><a class="self-link" href="#metadata_itut_t35_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_itut_t35</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>itu_t_t35_country_code</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>itu_t_t35_country_code</c-> <c- o>==</c-> <c- mh>0xFF</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>itu_t_t35_country_code_extension_byte</c->
     <c- p>}</c->
     <c- n>itu_t_t35_payload_bytes</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> The exact syntax of itu_t_t35_payload_bytes is not defined
in this specification. External
specifications can define the syntax.
Decoders should ignore the entire OBU if they do not understand it.
The last byte of the valid content of the data is
considered to be the last byte that is not equal to zero. This rule is to
prevent the dropping of valid bytes by systems that interpret trailing zero
bytes as a padding continuation of the trailing bits in an OBU.
This implies that when any payload data is present for this OBU type,
at least one byte of the payload data (including the trailing bit) shall not be equal to 0.
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.8.3" id="metadata_high_dynamic_range_content_light_level_syntax"><span class="secno">5.8.3. </span><span class="content">Metadata high dynamic range content light level syntax</span><a class="self-link" href="#metadata_high_dynamic_range_content_light_level_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_hdr_cll</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>max_cll</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>max_fall</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.8.4" id="metadata_high_dynamic_range_mastering_display_color_volume_syntax"><span class="secno">5.8.4. </span><span class="content">Metadata high dynamic range mastering display color volume syntax</span><a class="self-link" href="#metadata_high_dynamic_range_mastering_display_color_volume_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_hdr_mdcv</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>3</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>primary_chromaticity_x</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
          <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>primary_chromaticity_y</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>white_point_chromaticity_x</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>white_point_chromaticity_y</c->
      <c- n>f</c-><c- p>(</c-><c- mi>32</c-><c- p>)</c-> <c- n>luminance_max</c->
      <c- n>f</c-><c- p>(</c-><c- mi>32</c-><c- p>)</c-> <c- n>luminance_min</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.8.5" id="metadata_scalability_syntax"><span class="secno">5.8.5. </span><span class="content">Metadata scalability syntax</span><a class="self-link" href="#metadata_scalability_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_scalability</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>scalability_mode_idc</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>scalability_mode_idc</c-> <c- o>==</c-> <c- n>SCALABILITY_SS</c-> <c- p>)</c->
         <c- n>scalability_structure</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.8.6" id="scalability_structure_syntax"><span class="secno">5.8.6. </span><span class="content">Scalability structure syntax</span><a class="self-link" href="#scalability_structure_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>scalability_structure</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>spatial_layers_cnt_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>spatial_layer_dimensions_present_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>spatial_layer_description_present_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>temporal_group_description_present_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>scalability_structure_reserved_3bits</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>spatial_layer_dimensions_present_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>spatial_layers_cnt_minus_1</c-> <c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>spatial_layer_max_width</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>spatial_layer_max_height</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>spatial_layer_description_present_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>spatial_layers_cnt_minus_1</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>spatial_layer_ref_id</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>temporal_group_description_present_flag</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>temporal_group_size</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>temporal_group_size</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>temporal_group_temporal_id</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>temporal_group_temporal_switching_up_point_flag</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>temporal_group_spatial_switching_up_point_flag</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>temporal_group_ref_cnt</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>temporal_group_ref_cnt</c-><c- p>[</c-> <c- n>i</c-> <c- p>];</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>temporal_group_ref_pic_diff</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.8.7" id="metadata_timecode_syntax"><span class="secno">5.8.7. </span><span class="content">Metadata timecode syntax</span><a class="self-link" href="#metadata_timecode_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>metadata_timecode</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>counting_type</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>full_timestamp_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>discontinuity_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>cnt_dropped_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>9</c-><c- p>)</c-> <c- n>n_frames</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>full_timestamp_flag</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>seconds_value</c->
          <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>minutes_value</c->
          <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>hours_value</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>seconds_flag</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>seconds_flag</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>seconds_value</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>minutes_flag</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>minutes_flag</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>minutes_value</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>hours_flag</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>hours_flag</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>hours_value</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>5</c-><c- p>)</c-> <c- n>time_offset_length</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>time_offset_length</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- n>time_offset_length</c-><c- p>)</c-> <c- n>time_offset_value</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="5.9" id="frame_header_obu_syntax"><span class="secno">5.9. </span><span class="content">Frame header OBU syntax</span><a class="self-link" href="#frame_header_obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.9.1" id="general_frame_header_obu_syntax"><span class="secno">5.9.1. </span><span class="content">General frame header OBU syntax</span><a class="self-link" href="#general_frame_header_obu_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>frame_header_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>SeenFrameHeader</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>frame_header_copy</c-><c- p>()</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>SeenFrameHeader</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>uncompressed_header</c-><c- p>(</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>show_existing_frame</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>decode_frame_wrapup</c-><c- p>(</c-> <c- p>)</c->
             <c- n>SeenFrameHeader</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>TileNum</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>SeenFrameHeader</c-> <c- o>=</c-> <c- mi>1</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.2" id="uncompressed_header_syntax"><span class="secno">5.9.2. </span><span class="content">Uncompressed header syntax</span><a class="self-link" href="#uncompressed_header_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>uncompressed_header</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_id_numbers_present_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>idLen</c-> <c- o>=</c-> <c- p>(</c-> <c- n>additional_frame_id_length_minus_1</c-> <c- o>+</c->
                   <c- n>delta_frame_id_length_minus_2</c-> <c- o>+</c-> <c- mi>3</c-> <c- p>)</c->
     <c- p>}</c->
     <c- n>allFrames</c-> <c- o>=</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>NUM_REF_FRAMES</c-><c- p>)</c-> <c- o>-</c-> <c- mi>1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>show_existing_frame</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>frame_type</c-> <c- o>=</c-> <c- n>KEY_FRAME</c->
         <c- n>FrameIsIntra</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>show_frame</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>showable_frame</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>show_existing_frame</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>show_existing_frame</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>frame_to_show_map_idx</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_info_present_flag</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>equal_picture_interval</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>temporal_point_info</c-><c- p>(</c-> <c- p>)</c->
             <c- p>}</c->
             <c- n>refresh_frame_flags</c-> <c- o>=</c-> <c- mi>0</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>frame_id_numbers_present_flag</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- n>idLen</c-><c- p>)</c-> <c- n>display_frame_id</c->
             <c- p>}</c->
             <c- n>frame_type</c-> <c- o>=</c-> <c- n>RefFrameType</c-><c- p>[</c-> <c- n>frame_to_show_map_idx</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>KEY_FRAME</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>refresh_frame_flags</c-> <c- o>=</c-> <c- n>allFrames</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>film_grain_params_present</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>load_grain_params</c-><c- p>(</c-> <c- n>frame_to_show_map_idx</c-> <c- p>)</c->
             <c- p>}</c->
             <c- k>return</c->
         <c- p>}</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>frame_type</c->
         \ <c- n>FrameIsIntra</c-> <c- o>=</c-> <c- p>(</c-><c- n>frame_type</c-> <c- o>==</c-> <c- n>INTRA_ONLY_FRAME</c-> \
                         <c- n>frame_type</c-> <c- o>==</c-> <c- n>KEY_FRAME</c-><c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>show_frame</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>show_frame</c-> <c- o>&amp;&amp;</c-> <c- n>decoder_model_info_present_flag</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>equal_picture_interval</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>temporal_point_info</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>show_frame</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>showable_frame</c-> <c- o>=</c-> <c- n>frame_type</c-> <c- o>!=</c-> <c- n>KEY_FRAME</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>showable_frame</c->
         <c- p>}</c->
         \ <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>SWITCH_FRAME</c-> \
              <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>KEY_FRAME</c-> <c- o>&amp;&amp;</c-> <c- n>show_frame</c-> <c- p>)</c-> <c- p>)</c->
             <c- n>error_resilient_mode</c-> <c- o>=</c-> <c- mi>1</c->
         <c- k>else</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>error_resilient_mode</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>KEY_FRAME</c-> <c- o>&amp;&amp;</c-> <c- n>show_frame</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>NUM_REF_FRAMES</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>RefValid</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>RefOrderHint</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>OrderHints</c-><c- p>[</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>disable_cdf_update</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>seq_force_screen_content_tools</c-> <c- o>==</c-> <c- n>SELECT_SCREEN_CONTENT_TOOLS</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>allow_screen_content_tools</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>allow_screen_content_tools</c-> <c- o>=</c-> <c- n>seq_force_screen_content_tools</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>allow_screen_content_tools</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>seq_force_integer_mv</c-> <c- o>==</c-> <c- n>SELECT_INTEGER_MV</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>force_integer_mv</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>force_integer_mv</c-> <c- o>=</c-> <c- n>seq_force_integer_mv</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>force_integer_mv</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>force_integer_mv</c-> <c- o>=</c-> <c- mi>1</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_id_numbers_present_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>PrevFrameID</c-> <c- o>=</c-> <c- n>current_frame_id</c->
          <c- n>f</c-><c- p>(</c-><c- n>idLen</c-><c- p>)</c-> <c- n>current_frame_id</c->
         <c- n>mark_ref_frames</c-><c- p>(</c-> <c- n>idLen</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>current_frame_id</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>SWITCH_FRAME</c-> <c- p>)</c->
         <c- n>frame_size_override_flag</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> <c- p>)</c->
         <c- n>frame_size_override_flag</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>else</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>frame_size_override_flag</c->
      <c- n>f</c-><c- p>(</c-><c- n>OrderHintBits</c-><c- p>)</c-> <c- n>order_hint</c->
     <c- n>OrderHint</c-> <c- o>=</c-> <c- n>order_hint</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> \
         <c- n>primary_ref_frame</c-> <c- o>=</c-> <c- n>PRIMARY_REF_NONE</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>primary_ref_frame</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_info_present_flag</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>buffer_removal_time_present_flag</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>buffer_removal_time_present_flag</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>opNum</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>opNum</c-> <c- o>&lt;=</c-> <c- n>operating_points_cnt_minus_1</c-><c- p>;</c-> <c- n>opNum</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>decoder_model_present_for_this_op</c-><c- p>[</c-> <c- n>opNum</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>opPtIdc</c-> <c- o>=</c-> <c- n>operating_point_idc</c-><c- p>[</c-> <c- n>opNum</c-> <c- p>]</c->
                     <c- n>inTemporalLayer</c-> <c- o>=</c-> <c- p>(</c-> <c- n>opPtIdc</c-> <c- o>>></c-> <c- n>temporal_id</c-> <c- p>)</c-> <c- o>&amp;</c-> <c- mi>1</c->
                     <c- n>inSpatialLayer</c-> <c- o>=</c-> <c- p>(</c-> <c- n>opPtIdc</c-> <c- o>>></c-> <c- p>(</c-> <c- n>spatial_id</c-> <c- o>+</c-> <c- mi>8</c-> <c- p>)</c-> <c- p>)</c-> <c- o>&amp;</c-> <c- mi>1</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>opPtIdc</c-> <c- o>==</c-> <c- mi>0</c-> \
                         <c- n>n</c-> <c- o>=</c-> <c- n>buffer_removal_time_length_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
                          <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>buffer_removal_time</c-><c- p>[</c-> <c- n>opNum</c-> <c- p>]</c->
                     <c- p>}</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>allow_high_precision_mv</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>use_ref_frame_mvs</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>allow_intrabc</c-> <c- o>=</c-> <c- mi>0</c->
     \ <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>SWITCH_FRAME</c-> \
          <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>KEY_FRAME</c-> <c- o>&amp;&amp;</c-> <c- n>show_frame</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>refresh_frame_flags</c-> <c- o>=</c-> <c- n>allFrames</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>refresh_frame_flags</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>FrameIsIntra</c-> \
         <c- k>if</c-> <c- p>(</c-> <c- n>error_resilient_mode</c-> <c- o>&amp;&amp;</c-> <c- n>enable_order_hint</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>NUM_REF_FRAMES</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-><c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- n>OrderHintBits</c-><c- p>)</c-> <c- n>ref_order_hint</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>ref_order_hint</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>!=</c-> <c- n>RefOrderHint</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>RefValid</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c->  <c- n>FrameIsIntra</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>frame_size</c-><c- p>(</c-> <c- p>)</c->
         <c- n>render_size</c-><c- p>(</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>allow_screen_content_tools</c-> <c- o>&amp;&amp;</c-> <c- n>UpscaledWidth</c-> <c- o>==</c-> <c- n>FrameWidth</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>allow_intrabc</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>enable_order_hint</c-> <c- p>)</c-> <c- p>{</c->
           <c- n>frame_refs_short_signaling</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
            <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>frame_refs_short_signaling</c->
           <c- k>if</c-> <c- p>(</c-> <c- n>frame_refs_short_signaling</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>last_frame_idx</c->
              <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>gold_frame_idx</c->
             <c- n>set_frame_refs</c-><c- p>()</c->
           <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>frame_refs_short_signaling</c-> <c- p>)</c->
                <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>frame_id_numbers_present_flag</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>n</c-> <c- o>=</c-> <c- n>delta_frame_id_length_minus_2</c-> <c- o>+</c-> <c- mi>2</c->
                  <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>delta_frame_id_minus_1</c->
                 <c- n>DeltaFrameId</c-> <c- o>=</c-> <c- n>delta_frame_id_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
                 <c- n>expectedFrameId</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- p>((</c-><c- n>current_frame_id</c-> <c- o>+</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>idLen</c-><c- p>)</c-> <c- o>-</c->
                                         <c- n>DeltaFrameId</c-> <c- p>)</c-> <c- o>%</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>idLen</c-><c- p>))</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>frame_size_override_flag</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>error_resilient_mode</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>frame_size_with_refs</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>frame_size</c-><c- p>(</c-> <c- p>)</c->
             <c- n>render_size</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>force_integer_mv</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>allow_high_precision_mv</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>allow_high_precision_mv</c->
         <c- p>}</c->
         <c- n>read_interpolation_filter</c-><c- p>(</c-> <c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>is_motion_mode_switchable</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>error_resilient_mode</c-> \
             <c- n>use_ref_frame_mvs</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>use_ref_frame_mvs</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>refFrame</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>i</c->
             <c- n>hint</c-> <c- o>=</c-> <c- n>RefOrderHint</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- n>OrderHints</c-><c- p>[</c-> <c- n>refFrame</c-> <c- p>]</c-> <c- o>=</c-> <c- n>hint</c->
             <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>enable_order_hint</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>RefFrameSignBias</c-><c- p>[</c-> <c- n>refFrame</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>RefFrameSignBias</c-><c- p>[</c-> <c- n>refFrame</c-> <c- p>]</c-> <c- o>=</c-> <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>hint</c-><c- p>,</c-> <c- n>OrderHint</c-><c- p>)</c-> <c- o>></c-> <c- mi>0</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>reduced_still_picture_header</c-> \
         <c- n>disable_frame_end_update_cdf</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>else</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>disable_frame_end_update_cdf</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>primary_ref_frame</c-> <c- o>==</c-> <c- n>PRIMARY_REF_NONE</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>init_non_coeff_cdfs</c-><c- p>(</c-> <c- p>)</c->
         <c- n>setup_past_independence</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>load_cdfs</c-><c- p>(</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>primary_ref_frame</c-> <c- p>]</c-> <c- p>)</c->
         <c- n>load_previous</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>use_ref_frame_mvs</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
         <c- n>motion_field_estimation</c-><c- p>(</c-> <c- p>)</c->
     <c- n>tile_info</c-><c- p>(</c-> <c- p>)</c->
     <c- n>quantization_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>segmentation_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>delta_q_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>delta_lf_params</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>primary_ref_frame</c-> <c- o>==</c-> <c- n>PRIMARY_REF_NONE</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>init_coeff_cdfs</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>load_previous_segment_ids</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
     <c- n>CodedLossless</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>segmentId</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>segmentId</c-> <c- o>&lt;</c-> <c- n>MAX_SEGMENTS</c-><c- p>;</c-> <c- n>segmentId</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>qindex</c-> <c- o>=</c-> <c- n>get_qindex</c-><c- p>(</c-> <c- mi>1</c-><c- p>,</c-> <c- n>segmentId</c-> <c- p>)</c->
         <c- n>LosslessArray</c-><c- p>[</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- n>qindex</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>DeltaQYDc</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c->
                                      <c- n>DeltaQUAc</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>DeltaQUDc</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c->
                                      <c- n>DeltaQVAc</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>DeltaQVDc</c-> <c- o>==</c-> <c- mi>0</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>LosslessArray</c-><c- p>[</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- p>)</c->
             <c- n>CodedLossless</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>using_qmatrix</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>LosslessArray</c-><c- p>[</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>15</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>15</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>2</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>15</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- n>qm_y</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- n>qm_u</c->
                 <c- n>SegQMLevel</c-><c- p>[</c-> <c- mi>2</c-> <c- p>][</c-> <c- n>segmentId</c-> <c- p>]</c-> <c- o>=</c-> <c- n>qm_v</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>AllLossless</c-> <c- o>=</c-> <c- n>CodedLossless</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-> <c- n>FrameWidth</c-> <c- o>==</c-> <c- n>UpscaledWidth</c-> <c- p>)</c->
     <c- n>loop_filter_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>cdef_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>lr_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_tx_mode</c-><c- p>(</c-> <c- p>)</c->
     <c- n>frame_reference_mode</c-><c- p>(</c-> <c- p>)</c->
     <c- n>skip_mode_params</c-><c- p>(</c-> <c- p>)</c->
     \ <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> \
          \ <c- n>error_resilient_mode</c-> \
          <c- o>!</c-><c- n>enable_warped_motion</c-> <c- p>)</c->
         <c- n>allow_warped_motion</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>else</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>allow_warped_motion</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>reduced_tx_set</c->
     <c- n>global_motion_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>film_grain_params</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.3" id="get_relative_distance_function"><span class="secno">5.9.3. </span><span class="content">Get relative distance function</span><a class="self-link" href="#get_relative_distance_function"></a></h4>
   <p>This function computes the distance between
two order hints by sign extending the result of subtracting the values.</p>
<pre class="language-cpp highlight"><c- n>get_relative_dist</c-><c- p>(</c-> <c- n>a</c-><c- p>,</c-> <c- n>b</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>enable_order_hint</c-> <c- p>)</c->
         <c- k>return</c-> <c- mi>0</c->
     <c- n>diff</c-> <c- o>=</c-> <c- n>a</c-> <c- o>-</c-> <c- n>b</c->
     <c- n>m</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- p>(</c-><c- n>OrderHintBits</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c->
     <c- n>diff</c-> <c- o>=</c-> <c- p>(</c-><c- n>diff</c-> <c- o>&amp;</c-> <c- p>(</c-><c- n>m</c-> <c- o>-</c-> <c- mi>1</c-><c- p>))</c-> <c- o>-</c-> <c- p>(</c-><c- n>diff</c-> <c- o>&amp;</c-> <c- n>m</c-><c- p>)</c->
     <c- k>return</c-> <c- n>diff</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.4" id="reference_frame_marking_function"><span class="secno">5.9.4. </span><span class="content">Reference frame marking function</span><a class="self-link" href="#reference_frame_marking_function"></a></h4>
<pre class="language-cpp highlight"><c- n>mark_ref_frames</c-><c- p>(</c-> <c- n>idLen</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>diffLen</c-> <c- o>=</c-> <c- n>delta_frame_id_length_minus_2</c-> <c- o>+</c-> <c- mi>2</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>NUM_REF_FRAMES</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>current_frame_id</c-> <c- o>></c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>diffLen</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
             \ <c- k>if</c-> <c- p>(</c-> <c- n>RefFrameId</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>></c-> <c- n>current_frame_id</c-> \
                  <c- n>RefFrameId</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- n>current_frame_id</c-> <c- o>-</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>diffLen</c-> <c- p>)</c-> <c- p>)</c-> <c- p>)</c->
                 <c- n>RefValid</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>RefFrameId</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>></c-> <c- n>current_frame_id</c-> <c- o>&amp;&amp;</c->
                  <c- n>RefFrameId</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>idLen</c-> <c- p>)</c-> <c- o>+</c->
                                      <c- n>current_frame_id</c-> <c- o>-</c->
                                      <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>diffLen</c-> <c- p>)</c-> <c- p>)</c-> <c- p>)</c->
                 <c- n>RefValid</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.5" id="frame_size_syntax"><span class="secno">5.9.5. </span><span class="content">Frame size syntax</span><a class="self-link" href="#frame_size_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>frame_size</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_size_override_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>n</c-> <c- o>=</c-> <c- n>frame_width_bits_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
          <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>frame_width_minus_1</c->
         <c- n>n</c-> <c- o>=</c-> <c- n>frame_height_bits_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
          <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>frame_height_minus_1</c->
         <c- n>FrameWidth</c-> <c- o>=</c-> <c- n>frame_width_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
         <c- n>FrameHeight</c-> <c- o>=</c-> <c- n>frame_height_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>FrameWidth</c-> <c- o>=</c-> <c- n>max_frame_width_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
         <c- n>FrameHeight</c-> <c- o>=</c-> <c- n>max_frame_height_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
     <c- p>}</c->
     <c- n>superres_params</c-><c- p>(</c-> <c- p>)</c->
     <c- n>compute_image_size</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.6" id="render_size_syntax"><span class="secno">5.9.6. </span><span class="content">Render size syntax</span><a class="self-link" href="#render_size_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>render_size</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>render_and_frame_size_different</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>render_and_frame_size_different</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>render_width_minus_1</c->
          <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>render_height_minus_1</c->
         <c- n>RenderWidth</c-> <c- o>=</c-> <c- n>render_width_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
         <c- n>RenderHeight</c-> <c- o>=</c-> <c- n>render_height_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>RenderWidth</c-> <c- o>=</c-> <c- n>UpscaledWidth</c->
         <c- n>RenderHeight</c-> <c- o>=</c-> <c- n>FrameHeight</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.7" id="frame_size_with_refs_syntax"><span class="secno">5.9.7. </span><span class="content">Frame size with refs syntax</span><a class="self-link" href="#frame_size_with_refs_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>frame_size_with_refs</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>found_ref</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>found_ref</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>UpscaledWidth</c-> <c- o>=</c-> <c- n>RefUpscaledWidth</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- n>FrameWidth</c-> <c- o>=</c-> <c- n>UpscaledWidth</c->
             <c- n>FrameHeight</c-> <c- o>=</c-> <c- n>RefFrameHeight</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- n>RenderWidth</c-> <c- o>=</c-> <c- n>RefRenderWidth</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- n>RenderHeight</c-> <c- o>=</c-> <c- n>RefRenderHeight</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- k>break</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>found_ref</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>frame_size</c-><c- p>(</c-> <c- p>)</c->
         <c- n>render_size</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>superres_params</c-><c- p>(</c-> <c- p>)</c->
         <c- n>compute_image_size</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.8" id="superres_params_syntax"><span class="secno">5.9.8. </span><span class="content">Superres params syntax</span><a class="self-link" href="#superres_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>superres_params</c-><c- p>()</c-> <c- p>{</c->
   <c- k>if</c-> <c- p>(</c-> <c- n>enable_superres</c-> <c- p>)</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>use_superres</c->
   <c- k>else</c->
     <c- n>use_superres</c-> <c- o>=</c-> <c- mi>0</c->
   <c- k>if</c-> <c- p>(</c-> <c- n>use_superres</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- n>SUPERRES_DENOM_BITS</c-><c- p>)</c-> <c- n>coded_denom</c->
     <c- n>SuperresDenom</c-> <c- o>=</c-> <c- n>coded_denom</c-> <c- o>+</c-> <c- n>SUPERRES_DENOM_MIN</c->
   <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
     <c- n>SuperresDenom</c-> <c- o>=</c-> <c- n>SUPERRES_NUM</c->
   <c- p>}</c->
   <c- n>UpscaledWidth</c-> <c- o>=</c-> <c- n>FrameWidth</c->
   <c- n>FrameWidth</c-> <c- o>=</c-> <c- p>(</c-><c- n>UpscaledWidth</c-> <c- o>*</c-> <c- n>SUPERRES_NUM</c-> <c- o>+</c->
                 <c- p>(</c-><c- n>SuperresDenom</c-> <c- o>/</c-> <c- mi>2</c-><c- p>))</c-> <c- o>/</c-> <c- n>SuperresDenom</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.9" id="compute_image_size_function"><span class="secno">5.9.9. </span><span class="content">Compute image size function</span><a class="self-link" href="#compute_image_size_function"></a></h4>
<pre class="language-cpp highlight"><c- n>compute_image_size</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>MiCols</c-> <c- o>=</c-> <c- mi>2</c-> <c- o>*</c-> <c- p>(</c-> <c- p>(</c-> <c- n>FrameWidth</c-> <c- o>+</c-> <c- mi>7</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>3</c-> <c- p>)</c->
     <c- n>MiRows</c-> <c- o>=</c-> <c- mi>2</c-> <c- o>*</c-> <c- p>(</c-> <c- p>(</c-> <c- n>FrameHeight</c-> <c- o>+</c-> <c- mi>7</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>3</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.10" id="interpolation_filter_syntax"><span class="secno">5.9.10. </span><span class="content">Interpolation filter syntax</span><a class="self-link" href="#interpolation_filter_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_interpolation_filter</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>is_filter_switchable</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>is_filter_switchable</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>interpolation_filter</c-> <c- o>=</c-> <c- n>SWITCHABLE</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>interpolation_filter</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.11" id="loop_filter_params_syntax"><span class="secno">5.9.11. </span><span class="content">Loop filter params syntax</span><a class="self-link" href="#loop_filter_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>loop_filter_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>CodedLossless</c-> \
         <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>INTRA_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>LAST_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>LAST2_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>LAST3_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>BWDREF_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>GOLDEN_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>ALTREF_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>ALTREF2_FRAME</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>loop_filter_mode_deltas</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
         <c- k>return</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
      <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>NumPlanes</c-> <c- o>></c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> \
              <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>2</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_level</c-><c- p>[</c-> <c- mi>3</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>loop_filter_sharpness</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>loop_filter_delta_enabled</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>loop_filter_delta_enabled</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>loop_filter_delta_update</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>loop_filter_delta_update</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>TOTAL_REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>update_ref_delta</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>update_ref_delta</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
                      <c- n>su</c-><c- p>(</c-><c- mi>1</c-><c- o>+</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_ref_deltas</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- p>}</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>update_mode_delta</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>update_mode_delta</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
                      <c- n>su</c-><c- p>(</c-><c- mi>1</c-><c- o>+</c-><c- mi>6</c-><c- p>)</c-> <c- n>loop_filter_mode_deltas</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.12" id="quantization_params_syntax"><span class="secno">5.9.12. </span><span class="content">Quantization params syntax</span><a class="self-link" href="#quantization_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>quantization_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>base_q_idx</c->
     <c- n>DeltaQYDc</c-> <c- o>=</c-> <c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>NumPlanes</c-> <c- o>></c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>separate_uv_delta_q</c-> <c- p>)</c->
            <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>diff_uv_delta</c->
         <c- k>else</c->
           <c- n>diff_uv_delta</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>DeltaQUDc</c-> <c- o>=</c-> <c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c->
         <c- n>DeltaQUAc</c-> <c- o>=</c-> <c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>diff_uv_delta</c-> <c- p>)</c-> <c- p>{</c->
           <c- n>DeltaQVDc</c-> <c- o>=</c-> <c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c->
           <c- n>DeltaQVAc</c-> <c- o>=</c-> <c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
           <c- n>DeltaQVDc</c-> <c- o>=</c-> <c- n>DeltaQUDc</c->
           <c- n>DeltaQVAc</c-> <c- o>=</c-> <c- n>DeltaQUAc</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>DeltaQUDc</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>DeltaQUAc</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>DeltaQVDc</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>DeltaQVAc</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>using_qmatrix</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>using_qmatrix</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>qm_y</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>qm_u</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>separate_uv_delta_q</c-> <c- p>)</c->
             <c- n>qm_v</c-> <c- o>=</c-> <c- n>qm_u</c->
         <c- k>else</c->
              <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>qm_v</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.13" id="delta_quantizer_syntax"><span class="secno">5.9.13. </span><span class="content">Delta quantizer syntax</span><a class="self-link" href="#delta_quantizer_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_delta_q</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_coded</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>delta_coded</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>su</c-><c- p>(</c-><c- mi>1</c-><c- o>+</c-><c- mi>6</c-><c- p>)</c-> <c- n>delta_q</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>delta_q</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>delta_q</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.14" id="segmentation_params_syntax"><span class="secno">5.9.14. </span><span class="content">Segmentation params syntax</span><a class="self-link" href="#segmentation_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>segmentation_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>segmentation_enabled</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_enabled</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>primary_ref_frame</c-> <c- o>==</c-> <c- n>PRIMARY_REF_NONE</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>segmentation_update_map</c-> <c- o>=</c-> <c- mi>1</c->
             <c- n>segmentation_temporal_update</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>segmentation_update_data</c-> <c- o>=</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>segmentation_update_map</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_update_map</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>segmentation_temporal_update</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>segmentation_update_data</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_update_data</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>MAX_SEGMENTS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>SEG_LVL_MAX</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>feature_enabled</c->
                     <c- n>FeatureEnabled</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>feature_enabled</c->
                     <c- n>clippedValue</c-> <c- o>=</c-> <c- mi>0</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>feature_enabled</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                         <c- n>bitsToRead</c-> <c- o>=</c-> <c- n>Segmentation_Feature_Bits</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                         <c- n>limit</c-> <c- o>=</c-> <c- n>Segmentation_Feature_Max</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                         <c- k>if</c-> <c- p>(</c-> <c- n>Segmentation_Feature_Signed</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                              <c- n>su</c-><c- p>(</c-><c- mi>1</c-><c- o>+</c-><c- n>bitsToRead</c-><c- p>)</c-> <c- n>feature_value</c->
                             <c- n>clippedValue</c-> <c- o>=</c-> <c- n>Clip3</c-><c- p>(</c-> <c- o>-</c-><c- n>limit</c-><c- p>,</c-> <c- n>limit</c-><c- p>,</c-> <c- n>feature_value</c-><c- p>)</c->
                         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                              <c- n>f</c-><c- p>(</c-><c- n>bitsToRead</c-><c- p>)</c-> <c- n>feature_value</c->
                             <c- n>clippedValue</c-> <c- o>=</c-> <c- n>Clip3</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>limit</c-><c- p>,</c-> <c- n>feature_value</c-><c- p>)</c->
                         <c- p>}</c->
                     <c- p>}</c->
                     <c- n>FeatureData</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>clippedValue</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>MAX_SEGMENTS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>SEG_LVL_MAX</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>FeatureEnabled</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- n>FeatureData</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>SegIdPreSkip</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>LastActiveSegId</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>MAX_SEGMENTS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>SEG_LVL_MAX</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>FeatureEnabled</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>LastActiveSegId</c-> <c- o>=</c-> <c- n>i</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>j</c-> <c- o>></c->\<c- o>=</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>SegIdPreSkip</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>The constant lookup tables used in this syntax are defined as:</p>
<pre class="language-c highlight"><c- n>Segmentation_Feature_Bits</c-><c- p>[</c-> <c- n>SEG_LVL_MAX</c-> <c- p>]</c->   <c- o>=</c-> <c- p>{</c-> <c- mi>8</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-> <c- p>}</c->
<c- n>Segmentation_Feature_Signed</c-><c- p>[</c-> <c- n>SEG_LVL_MAX</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-> <c- p>}</c->
<c- n>Segmentation_Feature_Max</c-><c- p>[</c-> <c- n>SEG_LVL_MAX</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c->
  <c- mi>255</c-><c- p>,</c-> <c- n>MAX_LOOP_FILTER</c-><c- p>,</c-> <c- n>MAX_LOOP_FILTER</c-><c- p>,</c->
  <c- n>MAX_LOOP_FILTER</c-><c- p>,</c-> <c- n>MAX_LOOP_FILTER</c-><c- p>,</c-> <c- mi>7</c-><c- p>,</c->
  <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-> <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.15" id="tile_info_syntax"><span class="secno">5.9.15. </span><span class="content">Tile info syntax</span><a class="self-link" href="#tile_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>tile_info</c-> <c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>sbCols</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiCols</c-> <c- o>+</c-> <c- mi>31</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>5</c-> <c- p>)</c-> <c- o>:</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiCols</c-> <c- o>+</c-> <c- mi>15</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>4</c-> <c- p>)</c->
     <c- n>sbRows</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiRows</c-> <c- o>+</c-> <c- mi>31</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>5</c-> <c- p>)</c-> <c- o>:</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiRows</c-> <c- o>+</c-> <c- mi>15</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>4</c-> <c- p>)</c->
     <c- n>sbShift</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- mi>5</c-> <c- o>:</c-> <c- mi>4</c->
     <c- n>sbSize</c-> <c- o>=</c-> <c- n>sbShift</c-> <c- o>+</c-> <c- mi>2</c->
     <c- n>maxTileWidthSb</c-> <c- o>=</c-> <c- n>MAX_TILE_WIDTH</c-> <c- o>>></c-> <c- n>sbSize</c->
     <c- n>maxTileAreaSb</c-> <c- o>=</c-> <c- n>MAX_TILE_AREA</c-> <c- o>>></c-> <c- p>(</c-> <c- mi>2</c-> <c- o>*</c-> <c- n>sbSize</c-> <c- p>)</c->
     <c- n>minLog2TileCols</c-> <c- o>=</c-> <c- n>tile_log2</c-><c- p>(</c-><c- n>maxTileWidthSb</c-><c- p>,</c-> <c- n>sbCols</c-><c- p>)</c->
     <c- n>maxLog2TileCols</c-> <c- o>=</c-> <c- n>tile_log2</c-><c- p>(</c-><c- mi>1</c-><c- p>,</c-> <c- n>Min</c-><c- p>(</c-><c- n>sbCols</c-><c- p>,</c-> <c- n>MAX_TILE_COLS</c-><c- p>))</c->
     <c- n>maxLog2TileRows</c-> <c- o>=</c-> <c- n>tile_log2</c-><c- p>(</c-><c- mi>1</c-><c- p>,</c-> <c- n>Min</c-><c- p>(</c-><c- n>sbRows</c-><c- p>,</c-> <c- n>MAX_TILE_ROWS</c-><c- p>))</c->
     <c- n>minLog2Tiles</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-><c- n>minLog2TileCols</c-><c- p>,</c->
                        <c- n>tile_log2</c-><c- p>(</c-><c- n>maxTileAreaSb</c-><c- p>,</c-> <c- n>sbRows</c-> <c- o>*</c-> <c- n>sbCols</c-><c- p>))</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>uniform_tile_spacing_flag</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>uniform_tile_spacing_flag</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>TileColsLog2</c-> <c- o>=</c-> <c- n>minLog2TileCols</c->
         <c- k>while</c-> <c- p>(</c-> <c- n>TileColsLog2</c-> <c- o>&lt;</c-> <c- n>maxLog2TileCols</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>increment_tile_cols_log2</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>increment_tile_cols_log2</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
                 <c- n>TileColsLog2</c-><c- o>++</c->
             <c- k>else</c->
                 <c- k>break</c->
         <c- p>}</c->
         <c- n>tileWidthSb</c-> <c- o>=</c-> <c- p>(</c-><c- n>sbCols</c-> <c- o>+</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- n>TileColsLog2</c-><c- p>)</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- n>TileColsLog2</c-><c- p>)</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>TileColsLog2</c->
         <c- n>i</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>startSb</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>&lt;</c-> <c- n>sbCols</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>+=</c-> <c- n>tileWidthSb</c-> <c- p>)</c-> <c- p>{</c->
           <c- n>MiColStarts</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>startSb</c-> <c- o>&lt;&lt;</c-> <c- n>sbShift</c->
           <c- n>i</c-> <c- o>+=</c-> <c- mi>1</c->
         <c- p>}</c->
         <c- n>MiColStarts</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>=</c-> <c- n>MiCols</c->
         <c- n>TileCols</c-> <c- o>=</c-> <c- n>i</c->
         <c- n>minLog2TileRows</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- n>minLog2Tiles</c-> <c- o>-</c-> <c- n>TileColsLog2</c-><c- p>,</c-> <c- mi>0</c-><c- p>)</c->
         <c- n>TileRowsLog2</c-> <c- o>=</c-> <c- n>minLog2TileRows</c->
         <c- k>while</c-> <c- p>(</c-> <c- n>TileRowsLog2</c-> <c- o>&lt;</c-> <c- n>maxLog2TileRows</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>increment_tile_rows_log2</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>increment_tile_rows_log2</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
                 <c- n>TileRowsLog2</c-><c- o>++</c->
             <c- k>else</c->
                 <c- k>break</c->
         <c- p>}</c->
         <c- n>tileHeightSb</c-> <c- o>=</c-> <c- p>(</c-><c- n>sbRows</c-> <c- o>+</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- n>TileRowsLog2</c-><c- p>)</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- n>TileRowsLog2</c-><c- p>)</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>TileRowsLog2</c->
         <c- n>i</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>startSb</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>&lt;</c-> <c- n>sbRows</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>+=</c-> <c- n>tileHeightSb</c-> <c- p>)</c-> <c- p>{</c->
           <c- n>MiRowStarts</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>startSb</c-> <c- o>&lt;&lt;</c-> <c- n>sbShift</c->
           <c- n>i</c-> <c- o>+=</c-> <c- mi>1</c->
         <c- p>}</c->
         <c- n>MiRowStarts</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>=</c-> <c- n>MiRows</c->
         <c- n>TileRows</c-> <c- o>=</c-> <c- n>i</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>widestTileSb</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>startSb</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>&lt;</c-> <c- n>sbCols</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>MiColStarts</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>startSb</c-> <c- o>&lt;&lt;</c-> <c- n>sbShift</c->
             <c- n>maxWidth</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-><c- n>sbCols</c-> <c- o>-</c-> <c- n>startSb</c-><c- p>,</c-> <c- n>maxTileWidthSb</c-><c- p>)</c->
              <c- n>ns</c-><c- p>(</c-><c- n>maxWidth</c-><c- p>)</c-> <c- n>width_in_sbs_minus_1</c->
             <c- n>sizeSb</c-> <c- o>=</c-> <c- n>width_in_sbs_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
             <c- n>widestTileSb</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- n>sizeSb</c-><c- p>,</c-> <c- n>widestTileSb</c-> <c- p>)</c->
             <c- n>startSb</c-> <c- o>+=</c-> <c- n>sizeSb</c->
         <c- p>}</c->
         <c- n>MiColStarts</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>=</c-> <c- n>MiCols</c->
         <c- n>TileCols</c-> <c- o>=</c-> <c- n>i</c->
         <c- n>TileColsLog2</c-> <c- o>=</c-> <c- n>tile_log2</c-><c- p>(</c-><c- mi>1</c-><c- p>,</c-> <c- n>TileCols</c-><c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>minLog2Tiles</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c->
             <c- n>maxTileAreaSb</c-> <c- o>=</c-> <c- p>(</c-><c- n>sbRows</c-> <c- o>*</c-> <c- n>sbCols</c-><c- p>)</c-> <c- o>>></c-> <c- p>(</c-><c- n>minLog2Tiles</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c->
         <c- k>else</c->
             <c- n>maxTileAreaSb</c-> <c- o>=</c-> <c- n>sbRows</c-> <c- o>*</c-> <c- n>sbCols</c->
         <c- n>maxTileHeightSb</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- n>maxTileAreaSb</c-> <c- o>/</c-> <c- n>widestTileSb</c-><c- p>,</c-> <c- mi>1</c-> <c- p>)</c->
         <c- n>startSb</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>startSb</c-> <c- o>&lt;</c-> <c- n>sbRows</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>MiRowStarts</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>startSb</c-> <c- o>&lt;&lt;</c-> <c- n>sbShift</c->
             <c- n>maxHeight</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-><c- n>sbRows</c-> <c- o>-</c-> <c- n>startSb</c-><c- p>,</c-> <c- n>maxTileHeightSb</c-><c- p>)</c->
              <c- n>ns</c-><c- p>(</c-><c- n>maxHeight</c-><c- p>)</c-> <c- n>height_in_sbs_minus_1</c->
             <c- n>sizeSb</c-> <c- o>=</c-> <c- n>height_in_sbs_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
             <c- n>startSb</c-> <c- o>+=</c-> <c- n>sizeSb</c->
         <c- p>}</c->
         <c- n>MiRowStarts</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>MiRows</c->
         <c- n>TileRows</c-> <c- o>=</c-> <c- n>i</c->
         <c- n>TileRowsLog2</c-> <c- o>=</c-> <c- n>tile_log2</c-><c- p>(</c-><c- mi>1</c-><c- p>,</c-> <c- n>TileRows</c-><c- p>)</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>TileColsLog2</c-> <c- o>></c-> <c- mi>0</c-> \
          <c- n>f</c-><c- p>(</c-><c- n>TileRowsLog2</c-> <c- o>+</c-> <c- n>TileColsLog2</c-><c- p>)</c-> <c- n>context_update_tile_id</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>tile_size_bytes_minus_1</c->
         <c- n>TileSizeBytes</c-> <c- o>=</c-> <c- n>tile_size_bytes_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>context_update_tile_id</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.16" id="tile_size_calculation_function"><span class="secno">5.9.16. </span><span class="content">Tile size calculation function</span><a class="self-link" href="#tile_size_calculation_function"></a></h4>
   <p>tile_log2 returns the smallest value for k such that blkSize \&lt;\&lt; k is greater than or equal to target.</p>
<pre class="language-cpp highlight"><c- n>tile_log2</c-><c- p>(</c-> <c- n>blkSize</c-><c- p>,</c-> <c- n>target</c-> <c- p>)</c-> <c- p>{</c->
   <c- k>for</c-> <c- p>(</c-> <c- n>k</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- p>(</c-><c- n>blkSize</c-> <c- o>&lt;&lt;</c-> <c- n>k</c-><c- p>)</c-> <c- o>&lt;</c-> <c- n>target</c-><c- p>;</c-> <c- n>k</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
   <c- p>}</c->
   <c- k>return</c-> <c- n>k</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.17" id="quantizer_index_delta_parameters_syntax"><span class="secno">5.9.17. </span><span class="content">Quantizer index delta parameters syntax</span><a class="self-link" href="#quantizer_index_delta_parameters_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>delta_q_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>delta_q_res</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>delta_q_present</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>base_q_idx</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_q_present</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>delta_q_present</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>delta_q_res</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.18" id="loop_filter_delta_parameters_syntax"><span class="secno">5.9.18. </span><span class="content">Loop filter delta parameters syntax</span><a class="self-link" href="#loop_filter_delta_parameters_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>delta_lf_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>delta_lf_present</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>delta_lf_res</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>delta_lf_multi</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>delta_q_present</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>allow_intrabc</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_lf_present</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>delta_lf_present</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>delta_lf_res</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_lf_multi</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.19" id="cdef_params_syntax"><span class="secno">5.9.19. </span><span class="content">CDEF params syntax</span><a class="self-link" href="#cdef_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>cdef_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>CodedLossless</c-> \
          <c- o>!</c-><c- n>enable_cdef</c-><c- p>)</c-> <c- p>{</c->
         <c- n>cdef_bits</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>cdef_y_pri_strength</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>cdef_y_sec_strength</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>cdef_uv_pri_strength</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>cdef_uv_sec_strength</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>CdefDamping</c-> <c- o>=</c-> <c- mi>3</c->
         <c- k>return</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>cdef_damping_minus_3</c->
     <c- n>CdefDamping</c-> <c- o>=</c-> <c- n>cdef_damping_minus_3</c-> <c- o>+</c-> <c- mi>3</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>cdef_bits</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>cdef_bits</c-><c- p>);</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>cdef_y_pri_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>cdef_y_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>cdef_y_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>==</c-> <c- mi>3</c-> <c- p>)</c->
             <c- n>cdef_y_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>+=</c-> <c- mi>1</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>NumPlanes</c-> <c- o>></c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>cdef_uv_pri_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>cdef_uv_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>cdef_uv_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>==</c-> <c- mi>3</c-> <c- p>)</c->
                 <c- n>cdef_uv_sec_strength</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>+=</c-> <c- mi>1</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.20" id="loop_restoration_params_syntax"><span class="secno">5.9.20. </span><span class="content">Loop restoration params syntax</span><a class="self-link" href="#loop_restoration_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>lr_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>AllLossless</c-> \
          <c- o>!</c-><c- n>enable_restoration</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>FrameRestorationType</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>RESTORE_NONE</c->
         <c- n>FrameRestorationType</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>RESTORE_NONE</c->
         <c- n>FrameRestorationType</c-><c- p>[</c-><c- mi>2</c-><c- p>]</c-> <c- o>=</c-> <c- n>RESTORE_NONE</c->
         <c- n>UsesLr</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- n>UsesLr</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>usesChromaLr</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>NumPlanes</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>lr_type</c->
         <c- n>FrameRestorationType</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>=</c-> <c- n>Remap_Lr_Type</c-><c- p>[</c-><c- n>lr_type</c-><c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>FrameRestorationType</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>!=</c-> <c- n>RESTORE_NONE</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>UsesLr</c-> <c- o>=</c-> <c- mi>1</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>i</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>usesChromaLr</c-> <c- o>=</c-> <c- mi>1</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>UsesLr</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>use_128x128_superblock</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>lr_unit_shift</c->
             <c- n>lr_unit_shift</c-><c- o>++</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>lr_unit_shift</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>lr_unit_shift</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>lr_unit_extra_shift</c->
                 <c- n>lr_unit_shift</c-> <c- o>+=</c-> <c- n>lr_unit_extra_shift</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>RESTORATION_TILESIZE_MAX</c-> <c- o>>></c-> <c- p>(</c-><c- mi>2</c-> <c- o>-</c-> <c- n>lr_unit_shift</c-><c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>subsampling_x</c-> <c- o>&amp;&amp;</c-> <c- n>subsampling_y</c-> <c- o>&amp;&amp;</c-> <c- n>usesChromaLr</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>lr_uv_shift</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>lr_uv_shift</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c->
         <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>>></c-> <c- n>lr_uv_shift</c->
         <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- mi>2</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>>></c-> <c- n>lr_uv_shift</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where Remap_Lr_Type is a constant lookup table specified as:</p>
<pre class="language-c highlight"><c- n>Remap_Lr_Type</c-><c- p>[</c-><c- mi>4</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c->
  <c- n>RESTORE_NONE</c-><c- p>,</c-> <c- n>RESTORE_SWITCHABLE</c-><c- p>,</c-> <c- n>RESTORE_WIENER</c-><c- p>,</c-> <c- n>RESTORE_SGRPROJ</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.21" id="tx_mode_syntax"><span class="secno">5.9.21. </span><span class="content">TX mode syntax</span><a class="self-link" href="#tx_mode_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_tx_mode</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>CodedLossless</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>TxMode</c-> <c- o>=</c-> <c- n>ONLY_4X4</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>tx_mode_select</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>tx_mode_select</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>TxMode</c-> <c- o>=</c-> <c- n>TX_MODE_SELECT</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>TxMode</c-> <c- o>=</c-> <c- n>TX_MODE_LARGEST</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.22" id="skip_mode_params_syntax"><span class="secno">5.9.22. </span><span class="content">Skip mode params syntax</span><a class="self-link" href="#skip_mode_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>skip_mode_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> \
         <c- n>skipModeAllowed</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>forwardIdx</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- n>backwardIdx</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>refHint</c-> <c- o>=</c-> <c- n>RefOrderHint</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>OrderHint</c-> <c- p>)</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 \ <c- k>if</c-> <c- p>(</c-> <c- n>forwardIdx</c-> <c- o>&lt;</c-> <c- mi>0</c-> \
                      <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>forwardHint</c-><c- p>)</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>forwardIdx</c-> <c- o>=</c-> <c- n>i</c->
                     <c- n>forwardHint</c-> <c- o>=</c-> <c- n>refHint</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>OrderHint</c-><c- p>)</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 \ <c- k>if</c-> <c- p>(</c-> <c- n>backwardIdx</c-> <c- o>&lt;</c-> <c- mi>0</c-> \
                      <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>backwardHint</c-><c- p>)</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>backwardIdx</c-> <c- o>=</c-> <c- n>i</c->
                     <c- n>backwardHint</c-> <c- o>=</c-> <c- n>refHint</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>forwardIdx</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>skipModeAllowed</c-> <c- o>=</c-> <c- mi>0</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>backwardIdx</c-> <c- o>></c->\<c- o>=</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>skipModeAllowed</c-> <c- o>=</c-> <c- mi>1</c->
             <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>Min</c-><c- p>(</c-><c- n>forwardIdx</c-><c- p>,</c-> <c- n>backwardIdx</c-><c- p>)</c->
             <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>Max</c-><c- p>(</c-><c- n>forwardIdx</c-><c- p>,</c-> <c- n>backwardIdx</c-><c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>secondForwardIdx</c-> <c- o>=</c-> <c- mi>-1</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>REFS_PER_FRAME</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>refHint</c-> <c- o>=</c-> <c- n>RefOrderHint</c-><c- p>[</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- p>]</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>forwardHint</c-> <c- p>)</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                     \ <c- k>if</c-> <c- p>(</c-> <c- n>secondForwardIdx</c-> <c- o>&lt;</c-> <c- mi>0</c-> \
                          <c- n>get_relative_dist</c-><c- p>(</c-> <c- n>refHint</c-><c- p>,</c-> <c- n>secondForwardHint</c-> <c- p>)</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                         <c- n>secondForwardIdx</c-> <c- o>=</c-> <c- n>i</c->
                         <c- n>secondForwardHint</c-> <c- o>=</c-> <c- n>refHint</c->
                     <c- p>}</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>secondForwardIdx</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>skipModeAllowed</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>skipModeAllowed</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>Min</c-><c- p>(</c-><c- n>forwardIdx</c-><c- p>,</c-> <c- n>secondForwardIdx</c-><c- p>)</c->
                 <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-> <c- o>+</c-> <c- n>Max</c-><c- p>(</c-><c- n>forwardIdx</c-><c- p>,</c-> <c- n>secondForwardIdx</c-><c- p>)</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skipModeAllowed</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>skip_mode_present</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>skip_mode_present</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.23" id="frame_reference_mode_syntax"><span class="secno">5.9.23. </span><span class="content">Frame reference mode syntax</span><a class="self-link" href="#frame_reference_mode_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>frame_reference_mode</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>reference_select</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>reference_select</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.24" id="global_motion_params_syntax"><span class="secno">5.9.24. </span><span class="content">Global motion params syntax</span><a class="self-link" href="#global_motion_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>global_motion_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>ref</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-><c- p>;</c-> <c- n>ref</c-> <c- o>&lt;=</c-> <c- n>ALTREF_FRAME</c-><c- p>;</c-> <c- n>ref</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>GmType</c-><c- p>[</c-> <c- n>ref</c-> <c- p>]</c-> <c- o>=</c-> <c- n>IDENTITY</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>6</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>gm_params</c-><c- p>[</c-> <c- n>ref</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- p>(</c-> <c- p>(</c-> <c- n>i</c-> <c- o>%</c-> <c- mi>3</c-> <c- o>==</c-> <c- mi>2</c-> <c- p>)</c-> <c- o>?</c->
                       <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>WARPEDMODEL_PREC_BITS</c-> <c- o>:</c-> <c- mi>0</c-> <c- p>)</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> <c- p>)</c->
         <c- k>return</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>ref</c-> <c- o>=</c-> <c- n>LAST_FRAME</c-><c- p>;</c-> <c- n>ref</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>ALTREF_FRAME</c-><c- p>;</c-> <c- n>ref</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>is_global</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>is_global</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>is_rot_zoom</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>is_rot_zoom</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>type</c-> <c- o>=</c-> <c- n>ROTZOOM</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>is_translation</c->
                 <c- n>type</c-> <c- o>=</c-> <c- n>is_translation</c-> <c- o>?</c-> <c- n>TRANSLATION</c-> <c- o>:</c-> <c- n>AFFINE</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>type</c-> <c- o>=</c-> <c- n>IDENTITY</c->
         <c- p>}</c->
         <c- n>GmType</c-><c- p>[</c-><c- n>ref</c-><c- p>]</c-> <c- o>=</c-> <c- n>type</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>type</c-> <c- o>></c->\<c- o>=</c-> <c- n>ROTZOOM</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>2</c-><c- p>)</c->
             <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>3</c-><c- p>)</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>type</c-> <c- o>==</c-> <c- n>AFFINE</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>4</c-><c- p>)</c->
                 <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>5</c-><c- p>)</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>gm_params</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- mi>4</c-><c- p>]</c-> <c- o>=</c-> <c- o>-</c-><c- n>gm_params</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- mi>3</c-><c- p>]</c->
                 <c- n>gm_params</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- mi>5</c-><c- p>]</c-> <c- o>=</c-> <c- n>gm_params</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- mi>2</c-><c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>type</c-> <c- o>></c->\<c- o>=</c-> <c- n>TRANSLATION</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>0</c-><c- p>)</c->
             <c- n>read_global_param</c-><c- p>(</c-><c- n>type</c-><c- p>,</c-><c- n>ref</c-><c- p>,</c-><c- mi>1</c-><c- p>)</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.25" id="global_param_syntax"><span class="secno">5.9.25. </span><span class="content">Global param syntax</span><a class="self-link" href="#global_param_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_global_param</c-><c- p>(</c-> <c- n>type</c-><c- p>,</c-> <c- n>ref</c-><c- p>,</c-> <c- n>idx</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>absBits</c-> <c- o>=</c-> <c- n>GM_ABS_ALPHA_BITS</c->
     <c- n>precBits</c-> <c- o>=</c-> <c- n>GM_ALPHA_PREC_BITS</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>type</c-> <c- o>==</c-> <c- n>TRANSLATION</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>absBits</c-> <c- o>=</c-> <c- n>GM_ABS_TRANS_ONLY_BITS</c-> <c- o>-</c-> <c- o>!</c-><c- n>allow_high_precision_mv</c->
             <c- n>precBits</c-> <c- o>=</c-> <c- n>GM_TRANS_ONLY_PREC_BITS</c-> <c- o>-</c-> <c- o>!</c-><c- n>allow_high_precision_mv</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>absBits</c-> <c- o>=</c-> <c- n>GM_ABS_TRANS_BITS</c->
             <c- n>precBits</c-> <c- o>=</c-> <c- n>GM_TRANS_PREC_BITS</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>precDiff</c-> <c- o>=</c-> <c- n>WARPEDMODEL_PREC_BITS</c-> <c- o>-</c-> <c- n>precBits</c->
     <c- n>round</c-> <c- o>=</c-> <c- p>(</c-><c- n>idx</c-> <c- o>%</c-> <c- mi>3</c-><c- p>)</c-> <c- o>==</c-> <c- mi>2</c-> <c- o>?</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>WARPEDMODEL_PREC_BITS</c-><c- p>)</c-> <c- o>:</c-> <c- mi>0</c->
     <c- n>sub</c-> <c- o>=</c-> <c- p>(</c-><c- n>idx</c-> <c- o>%</c-> <c- mi>3</c-><c- p>)</c-> <c- o>==</c-> <c- mi>2</c-> <c- o>?</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>precBits</c-><c- p>)</c-> <c- o>:</c-> <c- mi>0</c->
     <c- n>mx</c-> <c- o>=</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>absBits</c-><c- p>)</c->
     <c- n>r</c-> <c- o>=</c-> <c- p>(</c-><c- n>PrevGmParams</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- n>idx</c-><c- p>]</c-> <c- o>>></c-> <c- n>precDiff</c-><c- p>)</c-> <c- o>-</c-> <c- n>sub</c->
     <c- n>gm_params</c-><c- p>[</c-><c- n>ref</c-><c- p>][</c-><c- n>idx</c-><c- p>]</c-> <c- o>=</c->
         <c- p>(</c-><c- n>decode_signed_subexp_with_ref</c-><c- p>(</c-> <c- o>-</c-><c- n>mx</c-><c- p>,</c-> <c- n>mx</c-> <c- o>+</c-> <c- mi>1</c-><c- p>,</c-> <c- n>r</c-> <c- p>)</c-><c- o>&lt;&lt;</c-> <c- n>precDiff</c-><c- p>)</c-> <c- o>+</c-> <c- n>round</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> When force_integer_mv is equal to 1, some fractional bits are still
read for the translation components. However, these fractional bits will be
discarded during the Setup Global MV process.
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.9.26" id="decode_signed_subexp_with_ref_syntax"><span class="secno">5.9.26. </span><span class="content">Decode signed subexp with ref syntax</span><a class="self-link" href="#decode_signed_subexp_with_ref_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_signed_subexp_with_ref</c-><c- p>(</c-> <c- n>low</c-><c- p>,</c-> <c- n>high</c-><c- p>,</c-> <c- n>r</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>x</c-> <c- o>=</c-> <c- n>decode_unsigned_subexp_with_ref</c-><c- p>(</c-><c- n>high</c-> <c- o>-</c-> <c- n>low</c-><c- p>,</c-> <c- n>r</c-> <c- o>-</c-> <c- n>low</c-><c- p>)</c->
     <c- k>return</c-> <c- n>x</c-> <c- o>+</c-> <c- n>low</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> decode_signed_subexp_with_ref will return a value
in the range low to high - 1 (inclusive).
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.9.27" id="decode_unsigned_subexp_with_ref_syntax"><span class="secno">5.9.27. </span><span class="content">Decode unsigned subexp with ref syntax</span><a class="self-link" href="#decode_unsigned_subexp_with_ref_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_unsigned_subexp_with_ref</c-><c- p>(</c-> <c- n>mx</c-><c- p>,</c-> <c- n>r</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>v</c-> <c- o>=</c-> <c- n>decode_subexp</c-><c- p>(</c-> <c- n>mx</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- p>(</c-><c- n>r</c-> <c- o>&lt;&lt;</c-> <c- mi>1</c-><c- p>)</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>mx</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>inverse_recenter</c-><c- p>(</c-><c- n>r</c-><c- p>,</c-> <c- n>v</c-><c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>mx</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>inverse_recenter</c-><c- p>(</c-><c- n>mx</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>r</c-><c- p>,</c-> <c- n>v</c-><c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> decode_unsigned_subexp_with_ref will return a value
in the range 0 to mx - 1 (inclusive).
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.9.28" id="decode_subexp_syntax"><span class="secno">5.9.28. </span><span class="content">Decode subexp syntax</span><a class="self-link" href="#decode_subexp_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_subexp</c-><c- p>(</c-> <c- n>numSyms</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>i</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>mk</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>k</c-> <c- o>=</c-> <c- mi>3</c->
     <c- k>while</c-> <c- p>(</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>b2</c-> <c- o>=</c-> <c- n>i</c-> <c- o>?</c-> <c- n>k</c-> <c- o>+</c-> <c- n>i</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>:</c-> <c- n>k</c->
         <c- n>a</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>b2</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>numSyms</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>mk</c-> <c- o>+</c-> <c- mi>3</c-> <c- o>*</c-> <c- n>a</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>ns</c-><c- p>(</c-><c- n>numSyms</c-> <c- o>-</c-> <c- n>mk</c-><c- p>)</c-> <c- n>subexp_final_bits</c->
             <c- k>return</c-> <c- n>subexp_final_bits</c-> <c- o>+</c-> <c- n>mk</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>subexp_more_bits</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>subexp_more_bits</c-> <c- p>)</c-> <c- p>{</c->
                <c- n>i</c-><c- o>++</c->
                <c- n>mk</c-> <c- o>+=</c-> <c- n>a</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>f</c-><c- p>(</c-><c- n>b2</c-><c- p>)</c-> <c- n>subexp_bits</c->
                <c- k>return</c-> <c- n>subexp_bits</c-> <c- o>+</c-> <c- n>mk</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.29" id="inverse_recenter_function"><span class="secno">5.9.29. </span><span class="content">Inverse recenter function</span><a class="self-link" href="#inverse_recenter_function"></a></h4>
<pre class="language-cpp highlight"><c- n>inverse_recenter</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>v</c-> <c- p>)</c-> <c- p>{</c->
   <c- k>if</c-> <c- p>(</c-> <c- n>v</c-> <c- o>></c-> <c- mi>2</c-> <c- o>*</c-> <c- n>r</c-> <c- p>)</c->
     <c- k>return</c-> <c- n>v</c->
   <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>v</c-> <c- o>&amp;</c-> <c- mi>1</c-> <c- p>)</c->
     <c- k>return</c-> <c- n>r</c-> <c- o>-</c-> <c- p>((</c-><c- n>v</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
   <c- k>else</c->
     <c- k>return</c-> <c- n>r</c-> <c- o>+</c-> <c- p>(</c-><c- n>v</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.30" id="film_grain_params_syntax"><span class="secno">5.9.30. </span><span class="content">Film grain params syntax</span><a class="self-link" href="#film_grain_params_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>film_grain_params</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     \ <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>film_grain_params_present</c-> \
          <c- p>(</c-><c- o>!</c-><c- n>show_frame</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>showable_frame</c-><c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>reset_grain_params</c-><c- p>()</c->
         <c- k>return</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>apply_grain</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>apply_grain</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>reset_grain_params</c-><c- p>()</c->
         <c- k>return</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>grain_seed</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>frame_type</c-> <c- o>==</c-> <c- n>INTER_FRAME</c-> <c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>update_grain</c->
     <c- k>else</c->
         <c- n>update_grain</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>update_grain</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>film_grain_params_ref_idx</c->
         <c- n>tempGrainSeed</c-> <c- o>=</c-> <c- n>grain_seed</c->
         <c- n>load_grain_params</c-><c- p>(</c-> <c- n>film_grain_params_ref_idx</c-> <c- p>)</c->
         <c- n>grain_seed</c-> <c- o>=</c-> <c- n>tempGrainSeed</c->
         <c- k>return</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>num_y_points</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>num_y_points</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_y_value</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_y_scaling</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mono_chrome</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>chroma_scaling_from_luma</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>chroma_scaling_from_luma</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mono_chrome</c-> \
          <c- p>(</c-> <c- n>subsampling_x</c-> <c- o>==</c-> <c- mi>1</c-> <c- o>&amp;&amp;</c-> <c- n>subsampling_y</c-> <c- o>==</c-> <c- mi>1</c-> <c- o>&amp;&amp;</c->
            <c- n>num_y_points</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
        <c- p>)</c-> <c- p>{</c->
         <c- n>num_cb_points</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>num_cr_points</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>num_cb_points</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>num_cb_points</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_cb_value</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_cb_scaling</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
          <c- n>f</c-><c- p>(</c-><c- mi>4</c-><c- p>)</c-> <c- n>num_cr_points</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>num_cr_points</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_cr_value</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>point_cr_scaling</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>grain_scaling_minus_8</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>ar_coeff_lag</c->
     <c- n>numPosLuma</c-> <c- o>=</c-> <c- mi>2</c-> <c- o>*</c-> <c- n>ar_coeff_lag</c-> <c- o>*</c-> <c- p>(</c-> <c- n>ar_coeff_lag</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>num_y_points</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>numPosChroma</c-> <c- o>=</c-> <c- n>numPosLuma</c-> <c- o>+</c-> <c- mi>1</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>numPosLuma</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>ar_coeffs_y_plus_128</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>numPosChroma</c-> <c- o>=</c-> <c- n>numPosLuma</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>chroma_scaling_from_luma</c-> \
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>numPosChroma</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>ar_coeffs_cb_plus_128</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>chroma_scaling_from_luma</c-> \
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>numPosChroma</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
              <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>ar_coeffs_cr_plus_128</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>ar_coeff_shift_minus_6</c->
      <c- n>f</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>grain_scale_shift</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>num_cb_points</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>cb_mult</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>cb_luma_mult</c->
          <c- n>f</c-><c- p>(</c-><c- mi>9</c-><c- p>)</c-> <c- n>cb_offset</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>num_cr_points</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>cr_mult</c->
          <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>cr_luma_mult</c->
          <c- n>f</c-><c- p>(</c-><c- mi>9</c-><c- p>)</c-> <c- n>cr_offset</c->
     <c- p>}</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>overlap_flag</c->
      <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>clip_to_restricted_range</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.9.31" id="temporal_point_info_syntax"><span class="secno">5.9.31. </span><span class="content">Temporal point info syntax</span><a class="self-link" href="#temporal_point_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>temporal_point_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>n</c-> <c- o>=</c-> <c- n>frame_presentation_time_length_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
      <c- n>f</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>frame_presentation_time</c->
 <c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="5.10" id="frame_obu_syntax"><span class="secno">5.10. </span><span class="content">Frame OBU syntax</span><a class="self-link" href="#frame_obu_syntax"></a></h3>
<pre class="language-cpp highlight"><c- n>frame_obu</c-><c- p>(</c-> <c- n>sz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>startBitPos</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- n>frame_header_obu</c-><c- p>(</c-> <c- p>)</c->
     <c- n>byte_alignment</c-><c- p>(</c-> <c- p>)</c->
     <c- n>endBitPos</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- n>headerBytes</c-> <c- o>=</c-> <c- p>(</c-><c- n>endBitPos</c-> <c- o>-</c-> <c- n>startBitPos</c-><c- p>)</c-> <c- o>/</c-> <c- mi>8</c->
     <c- n>sz</c-> <c- o>-=</c-> <c- n>headerBytes</c->
     <c- n>tile_group_obu</c-><c- p>(</c-> <c- n>sz</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="5.11" id="tile_group_obu_syntax"><span class="secno">5.11. </span><span class="content">Tile group OBU syntax</span><a class="self-link" href="#tile_group_obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.11.1" id="general_tile_group_obu_syntax"><span class="secno">5.11.1. </span><span class="content">General tile group OBU syntax</span><a class="self-link" href="#general_tile_group_obu_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>tile_group_obu</c-><c- p>(</c-> <c- n>sz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>NumTiles</c-> <c- o>=</c-> <c- n>TileCols</c-> <c- o>*</c-> <c- n>TileRows</c->
     <c- n>startBitPos</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- n>tile_start_and_end_present_flag</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>NumTiles</c-> <c- o>></c-> <c- mi>1</c-> <c- p>)</c->
          <c- n>f</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>tile_start_and_end_present_flag</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>NumTiles</c-> <c- o>==</c-> <c- mi>1</c-> \
         <c- n>tg_start</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>tg_end</c-> <c- o>=</c-> <c- n>NumTiles</c-> <c- o>-</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>tileBits</c-> <c- o>=</c-> <c- n>TileColsLog2</c-> <c- o>+</c-> <c- n>TileRowsLog2</c->
          <c- n>f</c-><c- p>(</c-><c- n>tileBits</c-><c- p>)</c-> <c- n>tg_start</c->
          <c- n>f</c-><c- p>(</c-><c- n>tileBits</c-><c- p>)</c-> <c- n>tg_end</c->
     <c- p>}</c->
     <c- n>byte_alignment</c-><c- p>(</c-> <c- p>)</c->
     <c- n>endBitPos</c-> <c- o>=</c-> <c- n>get_position</c-><c- p>(</c-> <c- p>)</c->
     <c- n>headerBytes</c-> <c- o>=</c-> <c- p>(</c-><c- n>endBitPos</c-> <c- o>-</c-> <c- n>startBitPos</c-><c- p>)</c-> <c- o>/</c-> <c- mi>8</c->
     <c- n>sz</c-> <c- o>-=</c-> <c- n>headerBytes</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>TileNum</c-> <c- o>=</c-> <c- n>tg_start</c-><c- p>;</c-> <c- n>TileNum</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>tg_end</c-><c- p>;</c-> <c- n>TileNum</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>tileRow</c-> <c- o>=</c-> <c- n>TileNum</c-> <c- o>/</c-> <c- n>TileCols</c->
         <c- n>tileCol</c-> <c- o>=</c-> <c- n>TileNum</c-> <c- o>%</c-> <c- n>TileCols</c->
         <c- n>lastTile</c-> <c- o>=</c-> <c- n>TileNum</c-> <c- o>==</c-> <c- n>tg_end</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>lastTile</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>tileSize</c-> <c- o>=</c-> <c- n>sz</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>le</c-><c- p>(</c-><c- n>TileSizeBytes</c-><c- p>)</c-> <c- n>tile_size_minus_1</c->
             <c- n>tileSize</c-> <c- o>=</c-> <c- n>tile_size_minus_1</c-> <c- o>+</c-> <c- mi>1</c->
             <c- n>sz</c-> <c- o>-=</c-> <c- n>tileSize</c-> <c- o>+</c-> <c- n>TileSizeBytes</c->
         <c- p>}</c->
         <c- n>MiRowStart</c-> <c- o>=</c-> <c- n>MiRowStarts</c-><c- p>[</c-> <c- n>tileRow</c-> <c- p>]</c->
         <c- n>MiRowEnd</c-> <c- o>=</c-> <c- n>MiRowStarts</c-><c- p>[</c-> <c- n>tileRow</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>]</c->
         <c- n>MiColStart</c-> <c- o>=</c-> <c- n>MiColStarts</c-><c- p>[</c-> <c- n>tileCol</c-> <c- p>]</c->
         <c- n>MiColEnd</c-> <c- o>=</c-> <c- n>MiColStarts</c-><c- p>[</c-> <c- n>tileCol</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>]</c->
         <c- n>CurrentQIndex</c-> <c- o>=</c-> <c- n>base_q_idx</c->
         <c- n>init_symbol</c-><c- p>(</c-> <c- n>tileSize</c-> <c- p>)</c->
         <c- n>decode_tile</c-><c- p>(</c-> <c- p>)</c->
         <c- n>exit_symbol</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>tg_end</c-> <c- o>==</c-> <c- n>NumTiles</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>disable_frame_end_update_cdf</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>frame_end_update_cdf</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- n>decode_frame_wrapup</c-><c- p>(</c-> <c- p>)</c->
         <c- n>SeenFrameHeader</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.2" id="decode_tile_syntax"><span class="secno">5.11.2. </span><span class="content">Decode tile syntax</span><a class="self-link" href="#decode_tile_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_tile</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>clear_above_context</c-><c- p>(</c-> <c- p>)</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>FRAME_LF_COUNT</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
         <c- n>DeltaLF</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- n>NumPlanes</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>pass</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>pass</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>pass</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>RefSgrXqd</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Sgrproj_Xqd_Mid</c-><c- p>[</c-> <c- n>pass</c-> <c- p>]</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>WIENER_COEFFS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>RefLrWiener</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Wiener_Taps_Mid</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>sbSize</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- n>BLOCK_128X128</c-> <c- o>:</c-> <c- n>BLOCK_64X64</c->
     <c- n>sbSize4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>sbSize</c-> <c- p>]</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>r</c-> <c- o>=</c-> <c- n>MiRowStart</c-><c- p>;</c-> <c- n>r</c-> <c- o>&lt;</c-> <c- n>MiRowEnd</c-><c- p>;</c-> <c- n>r</c-> <c- o>+=</c-> <c- n>sbSize4</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>clear_left_context</c-><c- p>(</c-> <c- p>)</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>c</c-> <c- o>=</c-> <c- n>MiColStart</c-><c- p>;</c-> <c- n>c</c-> <c- o>&lt;</c-> <c- n>MiColEnd</c-><c- p>;</c-> <c- n>c</c-> <c- o>+=</c-> <c- n>sbSize4</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>ReadDeltas</c-> <c- o>=</c-> <c- n>delta_q_present</c->
             <c- n>clear_cdef</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- p>)</c->
             <c- n>clear_block_decoded_flags</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>sbSize4</c-> <c- p>)</c->
             <c- n>read_lr</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>sbSize</c-> <c- p>)</c->
             <c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>sbSize</c-> <c- p>)</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where Sgrproj_Xqd_Mid and Wiener_Taps_Mid are constant lookup tables specified as:</p>
<pre class="language-c highlight"><c- n>Wiener_Taps_Mid</c-><c- p>[</c-><c- mi>3</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c->  <c- mi>3</c-><c- p>,</c->  <c- mi>-7</c-><c- p>,</c->  <c- mi>15</c-> <c- p>}</c->

<c- n>Sgrproj_Xqd_Mid</c-><c- p>[</c-><c- mi>2</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>-32</c-><c- p>,</c->  <c- mi>31</c-> <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.3" id="clear_block_decoded_flags_function"><span class="secno">5.11.3. </span><span class="content">Clear block decoded flags function</span><a class="self-link" href="#clear_block_decoded_flags_function"></a></h4>
<pre class="language-cpp highlight"><c- n>clear_block_decoded_flags</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>sbSize4</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- n>NumPlanes</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
         <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
         <c- n>sbWidth4</c-> <c- o>=</c-> <c- p>(</c-> <c- n>MiColEnd</c-> <c- o>-</c-> <c- n>c</c-> <c- p>)</c-> <c- o>>></c-> <c- n>subX</c->
         <c- n>sbHeight4</c-> <c- o>=</c-> <c- p>(</c-> <c- n>MiRowEnd</c-> <c- o>-</c-> <c- n>r</c-> <c- p>)</c-> <c- o>>></c-> <c- n>subY</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>-1</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- p>(</c-> <c- n>sbSize4</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>);</c-> <c- n>y</c-><c- o>++</c-> <c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>-1</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- p>(</c-> <c- n>sbSize4</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>);</c-> <c- n>x</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>sbWidth4</c-> <c- p>)</c->
                     <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>y</c-> <c- p>][</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>sbHeight4</c-> <c- p>)</c->
                     <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>y</c-> <c- p>][</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- k>else</c->
                     <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>y</c-> <c- p>][</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
         <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>sbSize4</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>][</c-> <c- mi>-1</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.4" id="decode_partition_syntax"><span class="secno">5.11.4. </span><span class="content">Decode partition syntax</span><a class="self-link" href="#decode_partition_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>bSize</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>r</c-> <c- o>></c->\<c- o>=</c-> <c- n>MiRows</c-> \
         <c- k>return</c-> <c- mi>0</c->
     <c- n>AvailU</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-> <c- o>-</c-> <c- mi>1</c-><c- p>,</c-> <c- n>c</c-> <c- p>)</c->
     <c- n>AvailL</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c->
     <c- n>num4x4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>bSize</c-> <c- p>]</c->
     <c- n>halfBlock4x4</c-> <c- o>=</c-> <c- n>num4x4</c-> <c- o>>></c-> <c- mi>1</c->
     <c- n>quarterBlock4x4</c-> <c- o>=</c-> <c- n>halfBlock4x4</c-> <c- o>>></c-> <c- mi>1</c->
     <c- n>hasRows</c-> <c- o>=</c-> <c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-> <c- p>)</c-> <c- o>&lt;</c-> <c- n>MiRows</c->
     <c- n>hasCols</c-> <c- o>=</c-> <c- p>(</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-> <c- p>)</c-> <c- o>&lt;</c-> <c- n>MiCols</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>bSize</c-> <c- o>&lt;</c-> <c- n>BLOCK_8X8</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>partition</c-> <c- o>=</c-> <c- n>PARTITION_NONE</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>hasRows</c-> <c- o>&amp;&amp;</c-> <c- n>hasCols</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>partition</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>hasCols</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>split_or_horz</c->
         <c- n>partition</c-> <c- o>=</c-> <c- n>split_or_horz</c-> <c- o>?</c-> <c- n>PARTITION_SPLIT</c-> <c- o>:</c-> <c- n>PARTITION_HORZ</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>hasRows</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>split_or_vert</c->
         <c- n>partition</c-> <c- o>=</c-> <c- n>split_or_vert</c-> <c- o>?</c-> <c- n>PARTITION_SPLIT</c-> <c- o>:</c-> <c- n>PARTITION_VERT</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>partition</c-> <c- o>=</c-> <c- n>PARTITION_SPLIT</c->
     <c- p>}</c->
     <c- n>subSize</c-> <c- o>=</c-> <c- n>Partition_Subsize</c-><c- p>[</c-> <c- n>partition</c-> <c- p>][</c-> <c- n>bSize</c-> <c- p>]</c->
     <c- n>splitSize</c-> <c- o>=</c-> <c- n>Partition_Subsize</c-><c- p>[</c-> <c- n>PARTITION_SPLIT</c-> <c- p>][</c-> <c- n>bSize</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_NONE</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_HORZ</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>hasRows</c-> <c- p>)</c->
             <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_VERT</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>hasCols</c-> <c- p>)</c->
             <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_SPLIT</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_partition</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_HORZ_A</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_HORZ_B</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_VERT_A</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_VERT_B</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>halfBlock4x4</c-><c- p>,</c-> <c- n>splitSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>partition</c-> <c- o>==</c-> <c- n>PARTITION_HORZ_4</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>0</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>1</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>2</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>3</c-> <c- o>&lt;</c-> <c- n>MiRows</c-> <c- p>)</c->
             <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>3</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>0</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>1</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>2</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>c</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>3</c-> <c- o>&lt;</c-> <c- n>MiCols</c-> <c- p>)</c->
             <c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>+</c-> <c- n>quarterBlock4x4</c-> <c- o>*</c-> <c- mi>3</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.5" id="decode_block_syntax"><span class="secno">5.11.5. </span><span class="content">Decode block syntax</span><a class="self-link" href="#decode_block_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>decode_block</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>subSize</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>MiRow</c-> <c- o>=</c-> <c- n>r</c->
     <c- n>MiCol</c-> <c- o>=</c-> <c- n>c</c->
     <c- n>MiSize</c-> <c- o>=</c-> <c- n>subSize</c->
     <c- n>bw4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>subSize</c-> <c- p>]</c->
     <c- n>bh4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>subSize</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>bh4</c-> <c- o>==</c-> <c- mi>1</c-> <c- o>&amp;&amp;</c-> <c- n>subsampling_y</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-><c- n>MiRow</c-> <c- o>&amp;</c-> <c- mi>1</c-><c- p>)</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
         <c- n>HasChroma</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>bw4</c-> <c- o>==</c-> <c- mi>1</c-> <c- o>&amp;&amp;</c-> <c- n>subsampling_x</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-><c- n>MiCol</c-> <c- o>&amp;</c-> <c- mi>1</c-><c- p>)</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
         <c- n>HasChroma</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>else</c->
         <c- n>HasChroma</c-> <c- o>=</c-> <c- n>NumPlanes</c-> <c- o>></c-> <c- mi>1</c->
     <c- n>AvailU</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-> <c- o>-</c-> <c- mi>1</c-><c- p>,</c-> <c- n>c</c-> <c- p>)</c->
     <c- n>AvailL</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c->
     <c- n>AvailUChroma</c-> <c- o>=</c-> <c- n>AvailU</c->
     <c- n>AvailLChroma</c-> <c- o>=</c-> <c- n>AvailL</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>HasChroma</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>subsampling_y</c-> <c- o>&amp;&amp;</c-> <c- n>bh4</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
             <c- n>AvailUChroma</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-> <c- o>-</c-> <c- mi>2</c-><c- p>,</c-> <c- n>c</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>subsampling_x</c-> <c- o>&amp;&amp;</c-> <c- n>bw4</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c->
             <c- n>AvailLChroma</c-> <c- o>=</c-> <c- n>is_inside</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- o>-</c-> <c- mi>2</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>AvailUChroma</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>AvailLChroma</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- n>mode_info</c-><c- p>(</c-> <c- p>)</c->
     <c- n>palette_tokens</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_block_tx_size</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip</c-> <c- p>)</c->
         <c- n>reset_block_context</c-><c- p>(</c-> <c- n>bw4</c-><c- p>,</c-> <c- n>bh4</c-> <c- p>)</c->
     <c- n>isCompound</c-> <c- o>=</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>></c-> <c- n>INTRA_FRAME</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>bh4</c-><c- p>;</c-> <c- n>y</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>bw4</c-><c- p>;</c-> <c- n>x</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>YModes</c-> <c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>YMode</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>==</c-> <c- n>INTRA_FRAME</c-> <c- o>&amp;&amp;</c-> <c- n>HasChroma</c-> <c- p>)</c->
                 <c- n>UVModes</c-> <c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>UVMode</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>refList</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>refList</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>refList</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>RefFrames</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>refList</c-> <c- p>]</c-> <c- o>=</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- n>refList</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>use_intrabc</c-> <c- p>)</c-> <c- p>{</c->
                   <c- n>CompGroupIdxs</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>comp_group_idx</c->
                   <c- n>CompoundIdxs</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>compound_idx</c->
                 <c- p>}</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>dir</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>dir</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>dir</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>InterpFilters</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>dir</c-> <c- p>]</c-> <c- o>=</c-> <c- n>interp_filter</c-><c- p>[</c-> <c- n>dir</c-> <c- p>]</c->
                 <c- p>}</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>refList</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>refList</c-> <c- o>&lt;</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>isCompound</c-><c- p>;</c-> <c- n>refList</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>Mvs</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>refList</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Mv</c-><c- p>[</c-> <c- n>refList</c-> <c- p>]</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>compute_prediction</c-><c- p>(</c-> <c- p>)</c->
     <c- n>residual</c-><c- p>(</c-> <c- p>)</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>bh4</c-><c- p>;</c-> <c- n>y</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>bw4</c-><c- p>;</c-> <c- n>x</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>IsInters</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>is_inter</c->
             <c- n>SkipModes</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>skip_mode</c->
             <c- n>Skips</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>skip</c->
             <c- n>TxSizes</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>TxSize</c->
             <c- n>MiSizes</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>MiSize</c->
             <c- n>SegmentIds</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>segment_id</c->
             <c- n>PaletteSizes</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PaletteSizeY</c->
             <c- n>PaletteSizes</c-><c- p>[</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PaletteSizeUV</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>PaletteSizeY</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>PaletteColors</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>PaletteColors</c-><c- p>[</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>FRAME_LF_COUNT</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>DeltaLFs</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>x</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>DeltaLF</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where reset_block_context( ) is specified as:</p>
<pre class="language-c highlight"><c- n>reset_block_context</c-><c- p>(</c-> <c- n>bw4</c-><c- p>,</c-> <c- n>bh4</c-> <c- p>)</c-> <c- p>{</c->
    <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- mi>1</c-> <c- o>+</c-> <c- mi>2</c-> <c- o>*</c-> <c- n>HasChroma</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
        <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
        <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
        <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>MiCol</c-> <c- o>>></c-> <c- n>subX</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>bw4</c-> <c- p>)</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>);</c-> <c- n>i</c-><c- o>++</c-><c- p>)</c-> <c- p>{</c->
            <c- n>AboveLevelContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
            <c- n>AboveDcContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
        <c- p>}</c->
        <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>MiRow</c-> <c- o>>></c-> <c- n>subY</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>bh4</c-> <c- p>)</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>);</c-> <c- n>i</c-><c- o>++</c-><c- p>)</c-> <c- p>{</c->
            <c- n>LeftLevelContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
            <c- n>LeftDcContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
        <c- p>}</c->
    <c- p>}</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.6" id="mode_info_syntax"><span class="secno">5.11.6. </span><span class="content">Mode info syntax</span><a class="self-link" href="#mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameIsIntra</c-> <c- p>)</c->
         <c- n>intra_frame_mode_info</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c->
         <c- n>inter_frame_mode_info</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.7" id="intra_frame_mode_info_syntax"><span class="secno">5.11.7. </span><span class="content">Intra frame mode info syntax</span><a class="self-link" href="#intra_frame_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>intra_frame_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>skip</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>SegIdPreSkip</c-> <c- p>)</c->
         <c- n>intra_segment_id</c-><c- p>(</c-> <c- p>)</c->
     <c- n>skip_mode</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>read_skip</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>SegIdPreSkip</c-> <c- p>)</c->
         <c- n>intra_segment_id</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_cdef</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_delta_qindex</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_delta_lf</c-><c- p>(</c-> <c- p>)</c->
     <c- n>ReadDeltas</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>NONE</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>allow_intrabc</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>use_intrabc</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>use_intrabc</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>use_intrabc</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>is_inter</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>YMode</c-> <c- o>=</c-> <c- n>DC_PRED</c->
         <c- n>UVMode</c-> <c- o>=</c-> <c- n>DC_PRED</c->
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
         <c- n>compound_type</c-> <c- o>=</c-> <c- n>COMPOUND_AVERAGE</c->
         <c- n>PaletteSizeY</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>PaletteSizeUV</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>interp_filter</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>BILINEAR</c->
         <c- n>interp_filter</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>BILINEAR</c->
         <c- n>find_mv_stack</c-><c- p>(</c-> <c- mi>0</c-> <c- p>)</c->
         <c- n>assign_mv</c-><c- p>(</c-> <c- mi>0</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>is_inter</c-> <c- o>=</c-> <c- mi>0</c->
          <c- n>S</c-><c- p>()</c-> <c- n>intra_frame_y_mode</c->
         <c- n>YMode</c-> <c- o>=</c-> <c- n>intra_frame_y_mode</c->
         <c- n>intra_angle_info_y</c-><c- p>(</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>HasChroma</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>uv_mode</c->
             <c- n>UVMode</c-> <c- o>=</c-> <c- n>uv_mode</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>UVMode</c-> <c- o>==</c-> <c- n>UV_CFL_PRED</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>read_cfl_alphas</c-><c- p>(</c-> <c- p>)</c->
             <c- p>}</c->
             <c- n>intra_angle_info_uv</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- n>PaletteSizeY</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>PaletteSizeUV</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>></c->\<c- o>=</c-> <c- n>BLOCK_8X8</c-> <c- o>&amp;&amp;</c->
              <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>64</c->  <c- o>&amp;&amp;</c->
              <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>64</c-> <c- o>&amp;&amp;</c->
              <c- n>allow_screen_content_tools</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>palette_mode_info</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- n>filter_intra_mode_info</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.8" id="intra_segment_id_syntax"><span class="secno">5.11.8. </span><span class="content">Intra segment ID syntax</span><a class="self-link" href="#intra_segment_id_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>intra_segment_id</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_enabled</c-> <c- p>)</c->
         <c- n>read_segment_id</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c->
         <c- n>segment_id</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>Lossless</c-> <c- o>=</c-> <c- n>LosslessArray</c-><c- p>[</c-> <c- n>segment_id</c-> <c- p>]</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.9" id="read_segment_id_syntax"><span class="secno">5.11.9. </span><span class="content">Read segment ID syntax</span><a class="self-link" href="#read_segment_id_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_segment_id</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>AvailU</c-> <c- o>&amp;&amp;</c-> <c- n>AvailL</c-> <c- p>)</c->
         <c- n>prevUL</c-> <c- o>=</c-> <c- n>SegmentIds</c-><c- p>[</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
     <c- k>else</c->
         <c- n>prevUL</c-> <c- o>=</c-> <c- mi>-1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>AvailU</c-> <c- p>)</c->
         <c- n>prevU</c-> <c- o>=</c-> <c- n>SegmentIds</c-><c- p>[</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>]</c->
     <c- k>else</c->
         <c- n>prevU</c-> <c- o>=</c-> <c- mi>-1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>AvailL</c-> <c- p>)</c->
         <c- n>prevL</c-> <c- o>=</c-> <c- n>SegmentIds</c-><c- p>[</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
     <c- k>else</c->
         <c- n>prevL</c-> <c- o>=</c-> <c- mi>-1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>prevU</c-> <c- o>==</c-> <c- mi>-1</c-> <c- p>)</c->
         <c- n>pred</c-> <c- o>=</c-> <c- p>(</c-><c- n>prevL</c-> <c- o>==</c-> <c- mi>-1</c-><c- p>)</c-> <c- o>?</c-> <c- mi>0</c-> <c- o>:</c-> <c- n>prevL</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>prevL</c-> <c- o>==</c-> <c- mi>-1</c-> <c- p>)</c->
         <c- n>pred</c-> <c- o>=</c-> <c- n>prevU</c->
     <c- k>else</c->
         <c- n>pred</c-> <c- o>=</c-> <c- p>(</c-><c- n>prevUL</c-> <c- o>==</c-> <c- n>prevU</c-><c- p>)</c-> <c- o>?</c-> <c- n>prevU</c-> <c- o>:</c-> <c- n>prevL</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>segment_id</c-> <c- o>=</c-> <c- n>pred</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>segment_id</c->
         <c- n>segment_id</c-> <c- o>=</c-> <c- n>neg_deinterleave</c-><c- p>(</c-> <c- n>segment_id</c-><c- p>,</c-> <c- n>pred</c-><c- p>,</c->
                                        <c- n>LastActiveSegId</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where neg_deinterleave is a function defined as:</p>
<pre class="language-c highlight"><c- n>neg_deinterleave</c-><c- p>(</c-><c- n>diff</c-><c- p>,</c-> <c- n>ref</c-><c- p>,</c-> <c- n>max</c-><c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>ref</c-> <c- p>)</c->
    <c- k>return</c-> <c- n>diff</c->
  <c- k>if</c-> <c- p>(</c-> <c- n>ref</c-> <c- o>>=</c-> <c- p>(</c-><c- n>max</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- p>)</c->
    <c- k>return</c-> <c- n>max</c-> <c- o>-</c-> <c- n>diff</c-> <c- o>-</c-> <c- mi>1</c->
  <c- k>if</c-> <c- p>(</c-> <c- mi>2</c-> <c- o>*</c-> <c- n>ref</c-> <c- o>&lt;</c-> <c- n>max</c-> <c- p>)</c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c-> <c- n>diff</c-> <c- o>&lt;=</c-> <c- mi>2</c-> <c- o>*</c-> <c- n>ref</c-> <c- p>)</c-> <c- p>{</c->
      <c- k>if</c-> <c- p>(</c-> <c- n>diff</c-> <c- o>&amp;</c-> <c- mi>1</c-> <c- p>)</c->
        <c- k>return</c-> <c- n>ref</c-> <c- o>+</c-> <c- p>((</c-><c- n>diff</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
      <c- k>else</c->
        <c- k>return</c-> <c- n>ref</c-> <c- o>-</c-> <c- p>(</c-><c- n>diff</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
    <c- p>}</c->
    <c- k>return</c-> <c- n>diff</c->
  <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c-> <c- n>diff</c-> <c- o>&lt;=</c-> <c- mi>2</c-> <c- o>*</c-> <c- p>(</c-><c- n>max</c-> <c- o>-</c-> <c- n>ref</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c-> <c- p>)</c-> <c- p>{</c->
      <c- k>if</c-> <c- p>(</c-> <c- n>diff</c-> <c- o>&amp;</c-> <c- mi>1</c-> <c- p>)</c->
        <c- k>return</c-> <c- n>ref</c-> <c- o>+</c-> <c- p>((</c-><c- n>diff</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
      <c- k>else</c->
        <c- k>return</c-> <c- n>ref</c-> <c- o>-</c-> <c- p>(</c-><c- n>diff</c-> <c- o>>></c-> <c- mi>1</c-><c- p>)</c->
    <c- p>}</c->
    <c- k>return</c-> <c- n>max</c-> <c- o>-</c-> <c- p>(</c-><c- n>diff</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.10" id="skip_mode_syntax"><span class="secno">5.11.10. </span><span class="content">Skip mode syntax</span><a class="self-link" href="#skip_mode_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_skip_mode</c-><c- p>()</c-> <c- p>{</c->
     \ <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_SKIP</c-> <c- p>)</c-> \
          \ <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>)</c-> \
          \ <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_GLOBALMV</c-> <c- p>)</c-> \
          \ <c- o>!</c-><c- n>skip_mode_present</c-> \
          \ <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c-> <c- mi>8</c-> \
          <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c-> <c- mi>8</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>skip_mode</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>skip_mode</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.11" id="skip_syntax"><span class="secno">5.11.11. </span><span class="content">Skip syntax</span><a class="self-link" href="#skip_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_skip</c-><c- p>()</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>SegIdPreSkip</c-> <c- o>&amp;&amp;</c-> <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_SKIP</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>skip</c-> <c- o>=</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>skip</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.12" id="quantizer_index_delta_syntax"><span class="secno">5.11.12. </span><span class="content">Quantizer index delta syntax</span><a class="self-link" href="#quantizer_index_delta_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_delta_qindex</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>sbSize</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- n>BLOCK_128X128</c-> <c- o>:</c-> <c- n>BLOCK_64X64</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>==</c-> <c- n>sbSize</c-> <c- o>&amp;&amp;</c-> <c- n>skip</c-> <c- p>)</c->
         <c- k>return</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>ReadDeltas</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>delta_q_abs</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>delta_q_abs</c-> <c- o>==</c-> <c- n>DELTA_Q_SMALL</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>L</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>delta_q_rem_bits</c->
             <c- n>delta_q_rem_bits</c-><c- o>++</c->
              <c- n>L</c-><c- p>(</c-><c- n>delta_q_rem_bits</c-><c- p>)</c-> <c- n>delta_q_abs_bits</c->
             <c- n>delta_q_abs</c-> <c- o>=</c-> <c- n>delta_q_abs_bits</c-> <c- o>+</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>delta_q_rem_bits</c-><c- p>)</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>delta_q_abs</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_q_sign_bit</c->
             <c- n>reducedDeltaQIndex</c-> <c- o>=</c-> <c- n>delta_q_sign_bit</c-> <c- o>?</c-> <c- o>-</c-><c- n>delta_q_abs</c-> <c- o>:</c-> <c- n>delta_q_abs</c->
             <c- n>CurrentQIndex</c-> <c- o>=</c-> <c- n>Clip3</c-><c- p>(</c-><c- mi>1</c-><c- p>,</c-> <c- mi>255</c-><c- p>,</c->
                 <c- n>CurrentQIndex</c-> <c- o>+</c-> <c- p>(</c-><c- n>reducedDeltaQIndex</c-> <c- o>&lt;&lt;</c-> <c- n>delta_q_res</c-><c- p>))</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.13" id="loop_filter_delta_syntax"><span class="secno">5.11.13. </span><span class="content">Loop filter delta syntax</span><a class="self-link" href="#loop_filter_delta_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_delta_lf</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>sbSize</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- n>BLOCK_128X128</c-> <c- o>:</c-> <c- n>BLOCK_64X64</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>==</c-> <c- n>sbSize</c-> <c- o>&amp;&amp;</c-> <c- n>skip</c-> <c- p>)</c->
         <c- k>return</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>ReadDeltas</c-> <c- o>&amp;&amp;</c-> <c- n>delta_lf_present</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>frameLfCount</c-> <c- o>=</c-> <c- mi>1</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>delta_lf_multi</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>frameLfCount</c-> <c- o>=</c-> <c- p>(</c-> <c- n>NumPlanes</c-> <c- o>></c-> <c- mi>1</c-> <c- p>)</c-> <c- o>?</c-> <c- n>FRAME_LF_COUNT</c-> <c- o>:</c-> <c- p>(</c-> <c- n>FRAME_LF_COUNT</c-> <c- o>-</c-> <c- mi>2</c-> <c- p>)</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>frameLfCount</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>delta_lf_abs</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>delta_lf_abs</c-> <c- o>==</c-> <c- n>DELTA_LF_SMALL</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>3</c-><c- p>)</c-> <c- n>delta_lf_rem_bits</c->
                 <c- n>n</c-> <c- o>=</c-> <c- n>delta_lf_rem_bits</c-> <c- o>+</c-> <c- mi>1</c->
                  <c- n>L</c-><c- p>(</c-><c- n>n</c-><c- p>)</c-> <c- n>delta_lf_abs_bits</c->
                 <c- n>deltaLfAbs</c-> <c- o>=</c-> <c- n>delta_lf_abs_bits</c-> <c- o>+</c->
                                <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>n</c-> <c- p>)</c-> <c- o>+</c-> <c- mi>1</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>deltaLfAbs</c-> <c- o>=</c-> <c- n>delta_lf_abs</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>deltaLfAbs</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_lf_sign_bit</c->
                 <c- n>reducedDeltaLfLevel</c-> <c- o>=</c-> <c- n>delta_lf_sign_bit</c-> <c- o>?</c->
                                       <c- o>-</c-><c- n>deltaLfAbs</c-> <c- o>:</c->
                                        <c- n>deltaLfAbs</c->
                 <c- n>DeltaLF</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Clip3</c-><c- p>(</c-> <c- o>-</c-><c- n>MAX_LOOP_FILTER</c-><c- p>,</c-> <c- n>MAX_LOOP_FILTER</c-><c- p>,</c-> <c- n>DeltaLF</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>+</c->
                                   <c- p>(</c-><c- n>reducedDeltaLfLevel</c-> <c- o>&lt;&lt;</c-> <c- n>delta_lf_res</c-><c- p>)</c-> <c- p>)</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.14" id="segmentation_feature_active_function"><span class="secno">5.11.14. </span><span class="content">Segmentation feature active function</span><a class="self-link" href="#segmentation_feature_active_function"></a></h4>
<pre class="language-cpp highlight"><c- n>seg_feature_active_idx</c-><c- p>(</c-> <c- n>idx</c-><c- p>,</c-> <c- n>feature</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>return</c-> <c- n>segmentation_enabled</c-> <c- o>&amp;&amp;</c-> <c- n>FeatureEnabled</c-><c- p>[</c-> <c- n>idx</c-> <c- p>][</c-> <c- n>feature</c-> <c- p>]</c->
 <c- p>}</c->
 <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>feature</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>return</c-> <c- n>seg_feature_active_idx</c-><c- p>(</c-> <c- n>segment_id</c-><c- p>,</c-> <c- n>feature</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.15" id="tx_size_syntax"><span class="secno">5.11.15. </span><span class="content">TX size syntax</span><a class="self-link" href="#tx_size_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_tx_size</c-><c- p>(</c-> <c- n>allowSelect</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>Lossless</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>TxSize</c-> <c- o>=</c-> <c- n>TX_4X4</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- n>maxRectTxSize</c-> <c- o>=</c-> <c- n>Max_Tx_Size_Rect</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>maxTxDepth</c-> <c- o>=</c-> <c- n>Max_Tx_Depth</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>TxSize</c-> <c- o>=</c-> <c- n>maxRectTxSize</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>></c-> <c- n>BLOCK_4X4</c-> <c- o>&amp;&amp;</c-> <c- n>allowSelect</c-> <c- o>&amp;&amp;</c-> <c- n>TxMode</c-> <c- o>==</c-> <c- n>TX_MODE_SELECT</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>tx_depth</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>tx_depth</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
             <c- n>TxSize</c-> <c- o>=</c-> <c- n>Split_Tx_Size</c-><c- p>[</c-> <c- n>TxSize</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>The Max_Tx_Depth table specifies the maximum transform depth
for each block size:</p>
<pre class="language-c highlight"><c- n>Max_Tx_Depth</c-><c- p>[</c-> <c- n>BLOCK_SIZES</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c->
    <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c->
    <c- mi>2</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c->
    <c- mi>3</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c->
    <c- mi>4</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c->
    <c- mi>2</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c->
    <c- mi>4</c-><c- p>,</c-> <c- mi>4</c->
<c- p>}</c->
</pre>
   <p><strong>Note:</strong> Max_Tx_Depth contains the number of times
the transform must be split to reach a 4x4 transform size.
This number can be greater than MAX_TX_DEPTH.
However, it is impossible to encode a transform depth
greater than MAX_TX_DEPTH because
tx_depth can only encode values in the range 0 to 2
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.11.16" id="block_tx_size_syntax"><span class="secno">5.11.16. </span><span class="content">Block TX size syntax</span><a class="self-link" href="#block_tx_size_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_block_tx_size</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>bw4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>bh4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>TxMode</c-> <c- o>==</c-> <c- n>TX_MODE_SELECT</c-> <c- o>&amp;&amp;</c->
           <c- n>MiSize</c-> <c- o>></c-> <c- n>BLOCK_4X4</c-> <c- o>&amp;&amp;</c-> <c- n>is_inter</c-> <c- o>&amp;&amp;</c->
           <c- o>!</c-><c- n>skip</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>Lossless</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>maxTxSz</c-> <c- o>=</c-> <c- n>Max_Tx_Size_Rect</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- n>txW4</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>maxTxSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
         <c- n>txH4</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>maxTxSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>row</c-> <c- o>=</c-> <c- n>MiRow</c-><c- p>;</c-> <c- n>row</c-> <c- o>&lt;</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>bh4</c-><c- p>;</c-> <c- n>row</c-> <c- o>+=</c-> <c- n>txH4</c-> <c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>col</c-> <c- o>=</c-> <c- n>MiCol</c-><c- p>;</c-> <c- n>col</c-> <c- o>&lt;</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>bw4</c-><c- p>;</c-> <c- n>col</c-> <c- o>+=</c-> <c- n>txW4</c-> <c- p>)</c->
                 <c- n>read_var_tx_size</c-><c- p>(</c-> <c- n>row</c-><c- p>,</c-> <c- n>col</c-><c- p>,</c-> <c- n>maxTxSz</c-><c- p>,</c-> <c- mi>0</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>read_tx_size</c-><c- p>(</c-><c- o>!</c-><c- n>skip</c-> \
         <c- k>for</c-> <c- p>(</c-> <c- n>row</c-> <c- o>=</c-> <c- n>MiRow</c-><c- p>;</c-> <c- n>row</c-> <c- o>&lt;</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>bh4</c-><c- p>;</c-> <c- n>row</c-><c- o>++</c-> <c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>col</c-> <c- o>=</c-> <c- n>MiCol</c-><c- p>;</c-> <c- n>col</c-> <c- o>&lt;</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>bw4</c-><c- p>;</c-> <c- n>col</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>InterTxSizes</c-><c- p>[</c-> <c- n>row</c-> <c- p>][</c-> <c- n>col</c-> <c- p>]</c-> <c- o>=</c-> <c- n>TxSize</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.17" id="var_tx_size_syntax"><span class="secno">5.11.17. </span><span class="content">Var TX size syntax</span><a class="self-link" href="#var_tx_size_syntax"></a></h4>
   <p>read_var_tx_size is used to read a transform size tree.</p>
<pre class="language-cpp highlight"><c- n>read_var_tx_size</c-><c- p>(</c-> <c- n>row</c-><c- p>,</c-> <c- n>col</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c-> <c- n>depth</c-><c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>row</c-> <c- o>></c->\<c- o>=</c-> <c- n>MiRows</c-> \
         <c- k>return</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X4</c-> \
         <c- n>txfm_split</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>txfm_split</c->
     <c- p>}</c->
     <c- n>w4</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
     <c- n>h4</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txfm_split</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>subTxSz</c-> <c- o>=</c-> <c- n>Split_Tx_Size</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
         <c- n>stepW</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>subTxSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
         <c- n>stepH</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>subTxSz</c-> <c- p>]</c-> <c- o>/</c-> <c- n>MI_SIZE</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>h4</c-><c- p>;</c-> <c- n>i</c-> <c- o>+=</c-> <c- n>stepH</c-> <c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>w4</c-><c- p>;</c-> <c- n>j</c-> <c- o>+=</c-> <c- n>stepW</c-> <c- p>)</c->
                 <c- n>read_var_tx_size</c-><c- p>(</c-> <c- n>row</c-> <c- o>+</c-> <c- n>i</c-><c- p>,</c-> <c- n>col</c-> <c- o>+</c-> <c- n>j</c-><c- p>,</c-> <c- n>subTxSz</c-><c- p>,</c-> <c- n>depth</c-><c- o>+</c-><c- mi>1</c-><c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>h4</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>w4</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c->
                 <c- n>InterTxSizes</c-><c- p>[</c-> <c- n>row</c-> <c- o>+</c-> <c- n>i</c-> <c- p>][</c-> <c- n>col</c-> <c- o>+</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>txSz</c->
         <c- n>TxSize</c-> <c- o>=</c-> <c- n>txSz</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.18" id="inter_frame_mode_info_syntax"><span class="secno">5.11.18. </span><span class="content">Inter frame mode info syntax</span><a class="self-link" href="#inter_frame_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>inter_frame_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>use_intrabc</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>LeftRefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>AvailL</c-> <c- o>?</c-> <c- n>RefFrames</c-><c- p>[</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-><c- mi>-1</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>:</c-> <c- n>INTRA_FRAME</c->
     <c- n>AboveRefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>AvailU</c-> <c- o>?</c-> <c- n>RefFrames</c-><c- p>[</c-> <c- n>MiRow</c-><c- mi>-1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>:</c-> <c- n>INTRA_FRAME</c->
     <c- n>LeftRefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>AvailL</c-> <c- o>?</c-> <c- n>RefFrames</c-><c- p>[</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-><c- mi>-1</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>:</c-> <c- n>NONE</c->
     <c- n>AboveRefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>AvailU</c-> <c- o>?</c-> <c- n>RefFrames</c-><c- p>[</c-> <c- n>MiRow</c-><c- mi>-1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>:</c-> <c- n>NONE</c->
     <c- n>LeftIntra</c-> <c- o>=</c-> <c- n>LeftRefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>AboveIntra</c-> <c- o>=</c-> <c- n>AboveRefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>LeftSingle</c-> <c- o>=</c-> <c- n>LeftRefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>AboveSingle</c-> <c- o>=</c-> <c- n>AboveRefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>skip</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>inter_segment_id</c-><c- p>(</c-> <c- mi>1</c-> <c- p>)</c->
     <c- n>read_skip_mode</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c->
         <c- n>skip</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>else</c->
         <c- n>read_skip</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>SegIdPreSkip</c-> <c- p>)</c->
         <c- n>inter_segment_id</c-><c- p>(</c-> <c- mi>0</c-> <c- p>)</c->
     <c- n>Lossless</c-> <c- o>=</c-> <c- n>LosslessArray</c-><c- p>[</c-> <c- n>segment_id</c-> <c- p>]</c->
     <c- n>read_cdef</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_delta_qindex</c-><c- p>(</c-> <c- p>)</c->
     <c- n>read_delta_lf</c-><c- p>(</c-> <c- p>)</c->
     <c- n>ReadDeltas</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>read_is_inter</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c->
         <c- n>inter_block_mode_info</c-><c- p>(</c-> <c- p>)</c->
     <c- k>else</c->
         <c- n>intra_block_mode_info</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.19" id="inter_segment_id_syntax"><span class="secno">5.11.19. </span><span class="content">Inter segment ID syntax</span><a class="self-link" href="#inter_segment_id_syntax"></a></h4>
   <p>This is called before (preSkip equal to 1) and after (preSkip equal to 0) the skip syntax element has been read.</p>
<pre class="language-cpp highlight"><c- n>inter_segment_id</c-><c- p>(</c-> <c- n>preSkip</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_enabled</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>predictedSegmentId</c-> <c- o>=</c-> <c- n>get_segment_id</c-><c- p>(</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_update_map</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>preSkip</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>SegIdPreSkip</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>segment_id</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- k>return</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>preSkip</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>skip</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>seg_id_predicted</c-> <c- o>=</c-> <c- mi>0</c->
                     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>];</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                         <c- n>AboveSegPredContext</c-><c- p>[</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>seg_id_predicted</c->
                     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>];</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                         <c- n>LeftSegPredContext</c-><c- p>[</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>seg_id_predicted</c->
                     <c- n>read_segment_id</c-><c- p>(</c-> <c- p>)</c->
                     <c- k>return</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>segmentation_temporal_update</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>seg_id_predicted</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>seg_id_predicted</c-> <c- p>)</c->
                     <c- n>segment_id</c-> <c- o>=</c-> <c- n>predictedSegmentId</c->
                 <c- k>else</c->
                     <c- n>read_segment_id</c-><c- p>(</c-> <c- p>)</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>];</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                     <c- n>AboveSegPredContext</c-><c- p>[</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>seg_id_predicted</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>];</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
                     <c- n>LeftSegPredContext</c-><c- p>[</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>seg_id_predicted</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>read_segment_id</c-><c- p>(</c-> <c- p>)</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>segment_id</c-> <c- o>=</c-> <c- n>predictedSegmentId</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>segment_id</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.20" id="is_inter_syntax"><span class="secno">5.11.20. </span><span class="content">Is inter syntax</span><a class="self-link" href="#is_inter_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_is_inter</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>is_inter</c-> <c- o>=</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-> <c- p>(</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>is_inter</c-> <c- o>=</c-> <c- n>FeatureData</c-><c- p>[</c-> <c- n>segment_id</c-> <c- p>][</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>]</c-> <c- o>!=</c-> <c- n>INTRA_FRAME</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-> <c- p>(</c-> <c- n>SEG_LVL_GLOBALMV</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>is_inter</c-> <c- o>=</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>is_inter</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.21" id="get_segment_id_function"><span class="secno">5.11.21. </span><span class="content">Get segment ID function</span><a class="self-link" href="#get_segment_id_function"></a></h4>
   <p>The predicted segment id is the smallest value found in the on-screen region
of the segmentation map covered by the current block.</p>
<pre class="language-cpp highlight"><c- n>get_segment_id</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>bw4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>bh4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>xMis</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>MiCols</c-> <c- o>-</c-> <c- n>MiCol</c-><c- p>,</c-> <c- n>bw4</c-> <c- p>)</c->
     <c- n>yMis</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>MiRows</c-> <c- o>-</c-> <c- n>MiRow</c-><c- p>,</c-> <c- n>bh4</c-> <c- p>)</c->
     <c- n>seg</c-> <c- o>=</c-> <c- mi>7</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>yMis</c-><c- p>;</c-> <c- n>y</c-><c- o>++</c-> <c- p>)</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>xMis</c-><c- p>;</c-> <c- n>x</c-><c- o>++</c-> <c- p>)</c->
             <c- n>seg</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>seg</c-><c- p>,</c-> <c- n>PrevSegmentIds</c-><c- p>[</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- n>y</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- n>x</c-> <c- p>]</c-> <c- p>)</c->
     <c- k>return</c-> <c- n>seg</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.22" id="intra_block_mode_info_syntax"><span class="secno">5.11.22. </span><span class="content">Intra block mode info syntax</span><a class="self-link" href="#intra_block_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>intra_block_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>INTRA_FRAME</c->
     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>NONE</c->
      <c- n>S</c-><c- p>()</c-> <c- n>y_mode</c->
     <c- n>YMode</c-> <c- o>=</c-> <c- n>y_mode</c->
     <c- n>intra_angle_info_y</c-><c- p>(</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>HasChroma</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>uv_mode</c->
         <c- n>UVMode</c-> <c- o>=</c-> <c- n>uv_mode</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>UVMode</c-> <c- o>==</c-> <c- n>UV_CFL_PRED</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>read_cfl_alphas</c-><c- p>(</c-> <c- p>)</c->
         <c- p>}</c->
         <c- n>intra_angle_info_uv</c-><c- p>(</c-> <c- p>)</c->
     <c- p>}</c->
     <c- n>PaletteSizeY</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>PaletteSizeUV</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>></c->\<c- o>=</c-> <c- n>BLOCK_8X8</c-> <c- o>&amp;&amp;</c->
          <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>64</c->  <c- o>&amp;&amp;</c->
          <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>64</c-> <c- o>&amp;&amp;</c->
          <c- n>allow_screen_content_tools</c-> <c- p>)</c->
         <c- n>palette_mode_info</c-><c- p>(</c-> <c- p>)</c->
     <c- n>filter_intra_mode_info</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.23" id="inter_block_mode_info_syntax"><span class="secno">5.11.23. </span><span class="content">Inter block mode info syntax</span><a class="self-link" href="#inter_block_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>inter_block_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>PaletteSizeY</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>PaletteSizeUV</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>read_ref_frames</c-><c- p>(</c-> <c- p>)</c->
     <c- n>isCompound</c-> <c- o>=</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>></c-> <c- n>INTRA_FRAME</c->
     <c- n>find_mv_stack</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>YMode</c-> <c- o>=</c-> <c- n>NEAREST_NEARESTMV</c->
     \ <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_SKIP</c-> <c- p>)</c-> \
          <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_GLOBALMV</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>YMode</c-> <c- o>=</c-> <c- n>GLOBALMV</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>compound_mode</c->
         <c- n>YMode</c-> <c- o>=</c-> <c- n>NEAREST_NEARESTMV</c-> <c- o>+</c-> <c- n>compound_mode</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>new_mv</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>new_mv</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>YMode</c-> <c- o>=</c-> <c- n>NEWMV</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>zero_mv</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>zero_mv</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>YMode</c-> <c- o>=</c-> <c- n>GLOBALMV</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>ref_mv</c->
                 <c- n>YMode</c-> <c- o>=</c-> <c- p>(</c-><c- n>ref_mv</c-> <c- o>==</c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>NEARESTMV</c-> <c- o>:</c-> <c- n>NEARMV</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>RefMvIdx</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEWMV</c-> \
         <c- k>for</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>idx</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>NumMvFound</c-> <c- o>></c-> <c- n>idx</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>drl_mode</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>drl_mode</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                   <c- n>RefMvIdx</c-> <c- o>=</c-> <c- n>idx</c->
                   <c- k>break</c->
                 <c- p>}</c->
                 <c- n>RefMvIdx</c-> <c- o>=</c-> <c- n>idx</c-> <c- o>+</c-> <c- mi>1</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>has_nearmv</c-><c- p>(</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>RefMvIdx</c-> <c- o>=</c-> <c- mi>1</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- mi>3</c-><c- p>;</c-> <c- n>idx</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>NumMvFound</c-> <c- o>></c-> <c- n>idx</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>drl_mode</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>drl_mode</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>RefMvIdx</c-> <c- o>=</c-> <c- n>idx</c->
                     <c- k>break</c->
                 <c- p>}</c->
                 <c- n>RefMvIdx</c-> <c- o>=</c-> <c- n>idx</c-> <c- o>+</c-> <c- mi>1</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>assign_mv</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c->
     <c- n>read_interintra_mode</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c->
     <c- n>read_motion_mode</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c->
     <c- n>read_compound_type</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>interpolation_filter</c-> <c- o>==</c-> <c- n>SWITCHABLE</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>dir</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>dir</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- n>enable_dual_filter</c-> <c- o>?</c-> <c- mi>2</c-> <c- o>:</c-> <c- mi>1</c-> <c- p>);</c-> <c- n>dir</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>needs_interp_filter</c-><c- p>(</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>interp_filter</c-><c- p>[</c-> <c- n>dir</c-> <c- p>]</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>interp_filter</c-><c- p>[</c-> <c- n>dir</c-> <c- p>]</c-> <c- o>=</c-> <c- n>EIGHTTAP</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>enable_dual_filter</c-> <c- p>)</c->
             <c- n>interp_filter</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>interp_filter</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>dir</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>dir</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>dir</c-><c- o>++</c-> <c- p>)</c->
             <c- n>interp_filter</c-><c- p>[</c-> <c- n>dir</c-> <c- p>]</c-> <c- o>=</c-> <c- n>interpolation_filter</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>The function has_nearmv is defined as:</p>
<pre class="language-cpp highlight"><c- n>has_nearmv</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAR_NEARMV</c-> <c- k>return</c-> <c- p>(</c-><c- n>YMode</c-> <c- o>==</c-> <c- n>NEARMV</c->
  <c- n>YMode</c-> <c- o>==</c-> <c- n>NEW_NEARMV</c-><c- p>)</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAR_NEWMV</c->
<c- p>}</c->
<c- o>~~~~~</c->
</pre>
   <p>The function needs_interp_filter is defined as:</p>
<pre class="language-cpp highlight"><c- n>needs_interp_filter</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
    <c- n>large</c-> <c- o>=</c-> <c- p>(</c-><c- n>Min</c-><c- p>(</c-><c- n>Block_Width</c-><c- p>[</c-><c- n>MiSize</c-><c- p>],</c-> <c- n>Block_Height</c-><c- p>[</c-><c- n>MiSize</c-><c- p>])</c-> <c- o>>=</c-> <c- mi>8</c-><c- p>)</c->
     <c- n>motion_mode</c-> <c- o>==</c-> <c- n>LOCALWARP</c-> <c- p>)</c-> <c- p>{</c-> <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c->
        <c- k>return</c-> <c- mi>0</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>large</c-> <c- o>&amp;&amp;</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>GLOBALMV</c-> <c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- n>GmType</c-><c- p>[</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- p>]</c-> <c- o>==</c-> <c- n>TRANSLATION</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>large</c-> <c- o>&amp;&amp;</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>GLOBAL_GLOBALMV</c-> <c- p>)</c-> <c- p>{</c->
<c- k>return</c-> <c- n>GmType</c-><c- p>[</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- p>]</c-> <c- o>==</c-> <c- n>TRANSLATION</c->
    <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
        <c- k>return</c-> <c- mi>1</c->
    <c- p>}</c->
<c- p>}</c->
<c- o>~~~~~</c->
</pre>
   <h4 class="heading settled" data-level="5.11.24" id="filter_intra_mode_info_syntax"><span class="secno">5.11.24. </span><span class="content">Filter intra mode info syntax</span><a class="self-link" href="#filter_intra_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>filter_intra_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>use_filter_intra</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>enable_filter_intra</c-> <c- o>&amp;&amp;</c->
          <c- n>YMode</c-> <c- o>==</c-> <c- n>DC_PRED</c-> <c- o>&amp;&amp;</c-> <c- n>PaletteSizeY</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c->
          <c- n>Max</c-><c- p>(</c-> <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>],</c-> <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- p>)</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>32</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>use_filter_intra</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>use_filter_intra</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>filter_intra_mode</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.25" id="ref_frames_syntax"><span class="secno">5.11.25. </span><span class="content">Ref frames syntax</span><a class="self-link" href="#ref_frames_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_ref_frames</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>SkipModeFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>FeatureData</c-><c- p>[</c-> <c- n>segment_id</c-> <c- p>][</c-> <c- n>SEG_LVL_REF_FRAME</c-> <c- p>]</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>NONE</c->
     \ <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_SKIP</c-> <c- p>)</c-> \
                 <c- n>seg_feature_active</c-><c- p>(</c-> <c- n>SEG_LVL_GLOBALMV</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c->
         <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>NONE</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>bw4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- n>bh4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>reference_select</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-> <c- n>Min</c-><c- p>(</c-> <c- n>bw4</c-><c- p>,</c-> <c- n>bh4</c-> <c- p>)</c-> <c- o>>=</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>)</c->
              <c- n>S</c-><c- p>()</c-> <c- n>comp_mode</c->
         <c- k>else</c->
             <c- n>comp_mode</c-> <c- o>=</c-> <c- n>SINGLE_REFERENCE</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>comp_mode</c-> <c- o>==</c-> <c- n>COMPOUND_REFERENCE</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>comp_ref_type</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>comp_ref_type</c-> <c- o>==</c-> <c- n>UNIDIR_COMP_REFERENCE</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>uni_comp_ref</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>uni_comp_ref</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>RefFrame</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>BWDREF_FRAME</c->
                     <c- n>RefFrame</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>ALTREF_FRAME</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>uni_comp_ref_p1</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>uni_comp_ref_p1</c-> <c- p>)</c-> <c- p>{</c->
                          <c- n>S</c-><c- p>()</c-> <c- n>uni_comp_ref_p2</c->
                         <c- k>if</c-> <c- p>(</c-> <c- n>uni_comp_ref_p2</c-> <c- p>)</c-> <c- p>{</c->
                           <c- n>RefFrame</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c->
                           <c- n>RefFrame</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>GOLDEN_FRAME</c->
                         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                           <c- n>RefFrame</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c->
                           <c- n>RefFrame</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>LAST3_FRAME</c->
                         <c- p>}</c->
                     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                         <c- n>RefFrame</c-><c- p>[</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>LAST_FRAME</c->
                         <c- n>RefFrame</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>LAST2_FRAME</c->
                     <c- p>}</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>comp_ref</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>comp_ref</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>comp_ref_p1</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>comp_ref_p1</c-> <c- o>?</c->
                                     <c- nl>LAST2_FRAME</c-> <c- p>:</c-> <c- n>LAST_FRAME</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>comp_ref_p2</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>comp_ref_p2</c-> <c- o>?</c->
                                     <c- nl>GOLDEN_FRAME</c-> <c- p>:</c-> <c- n>LAST3_FRAME</c->
                 <c- p>}</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>comp_bwdref</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>comp_bwdref</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>comp_bwdref_p1</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>comp_bwdref_p1</c-> <c- o>?</c->
                                      <c- nl>ALTREF2_FRAME</c-> <c- p>:</c-> <c- n>BWDREF_FRAME</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ALTREF_FRAME</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p1</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>single_ref_p1</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p2</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>single_ref_p2</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p6</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>single_ref_p6</c-> <c- o>?</c->
                                      <c- nl>ALTREF2_FRAME</c-> <c- p>:</c-> <c- n>BWDREF_FRAME</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ALTREF_FRAME</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p3</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>single_ref_p3</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p5</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>single_ref_p5</c-> <c- o>?</c->
                                      <c- nl>GOLDEN_FRAME</c-> <c- p>:</c-> <c- n>LAST3_FRAME</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>single_ref_p4</c->
                     <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>single_ref_p4</c-> <c- o>?</c->
                                      <c- nl>LAST2_FRAME</c-> <c- p>:</c-> <c- n>LAST_FRAME</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>NONE</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.26" id="assign_mv_syntax"><span class="secno">5.11.26. </span><span class="content">Assign MV syntax</span><a class="self-link" href="#assign_mv_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>assign_mv</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>isCompound</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>use_intrabc</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEWMV</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>compMode</c-> <c- o>=</c-> <c- n>get_mode</c-><c- p>(</c-> <c- n>i</c-> <c- p>)</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>use_intrabc</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>RefStackMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>RefStackMv</c-><c- p>[</c-> <c- mi>1</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>sbSize</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- n>BLOCK_128X128</c-> <c- o>:</c-> <c- n>BLOCK_64X64</c->
                 <c- n>sbSize4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>sbSize</c-> <c- p>]</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- n>sbSize4</c-> <c- o>&lt;</c-> <c- n>MiRowStart</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
                     <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- o>-</c-><c- p>(</c-><c- n>sbSize4</c-> <c- o>*</c-> <c- n>MI_SIZE</c-> <c- o>+</c-> <c- n>INTRABC_DELAY_PIXELS</c-><c- p>)</c-> <c- o>*</c-> <c- mi>8</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                     <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- o>-</c-><c- p>(</c-><c- n>sbSize4</c-> <c- o>*</c-> <c- n>MI_SIZE</c-> <c- o>*</c-> <c- mi>8</c-><c- p>)</c->
                     <c- n>PredMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>compMode</c-> <c- o>==</c-> <c- n>GLOBALMV</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>PredMv</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>GlobalMvs</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>pos</c-> <c- o>=</c-> <c- p>(</c-> <c- n>compMode</c-> <c- o>==</c-> <c- n>NEARESTMV</c-> <c- p>)</c-> <c- o>?</c-> <c- mi>0</c-> <c- o>:</c-> <c- n>RefMvIdx</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>compMode</c-> <c- o>==</c-> <c- n>NEWMV</c-> <c- o>&amp;&amp;</c-> <c- n>NumMvFound</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- mi>1</c-> <c- p>)</c->
                 <c- n>pos</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>PredMv</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>RefStackMv</c-><c- p>[</c-> <c- n>pos</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>compMode</c-> <c- o>==</c-> <c- n>NEWMV</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>read_mv</c-><c- p>(</c-> <c- n>i</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>Mv</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PredMv</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.27" id="read_motion_mode_syntax"><span class="secno">5.11.27. </span><span class="content">Read motion mode syntax</span><a class="self-link" href="#read_motion_mode_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_motion_mode</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>is_motion_mode_switchable</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>Min</c-><c- p>(</c-> <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>],</c->
               <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- p>)</c-> <c- o>&lt;</c-> <c- mi>8</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>force_integer_mv</c-> <c- o>&amp;&amp;</c->
          <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>GLOBALMV</c-> \
         <c- k>if</c-> <c- p>(</c-> <c- n>GmType</c-><c- p>[</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- p>]</c-> <c- o>></c-> <c- n>TRANSLATION</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
             <c- k>return</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>isCompound</c-> \
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>SIMPLE</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- n>find_warp_samples</c-><c- p>()</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>force_integer_mv</c-> \
          <c- o>!</c-><c- n>allow_warped_motion</c-> \
          <c- n>S</c-><c- p>()</c-> <c- n>use_obmc</c->
         <c- n>motion_mode</c-> <c- o>=</c-> <c- n>use_obmc</c-> <c- o>?</c-> <c- n>OBMC</c-> <c- o>:</c-> <c- n>SIMPLE</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>motion_mode</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where is_scaled is a function that determines whether a
reference frame uses scaling and is specified as:</p>
<pre class="language-cpp highlight"><c- n>is_scaled</c-><c- p>(</c-> <c- n>refFrame</c-> <c- p>)</c-> <c- p>{</c->
  <c- n>refIdx</c-> <c- o>=</c-> <c- n>ref_frame_idx</c-><c- p>[</c-> <c- n>refFrame</c-> <c- o>-</c-> <c- n>LAST_FRAME</c-> <c- p>]</c->
  <c- n>xScale</c-> <c- o>=</c-> <c- p>(</c-> <c- p>(</c-> <c- n>RefUpscaledWidth</c-><c- p>[</c-> <c- n>refIdx</c-> <c- p>]</c-> <c- o>&lt;&lt;</c-> <c- n>REF_SCALE_SHIFT</c-> <c- p>)</c-> <c- o>+</c-> <c- p>(</c-> <c- n>FrameWidth</c-> <c- o>/</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>)</c-> <c- o>/</c-> <c- n>FrameWidth</c->
  <c- n>yScale</c-> <c- o>=</c-> <c- p>(</c-> <c- p>(</c-> <c- n>RefFrameHeight</c-><c- p>[</c-> <c- n>refIdx</c-> <c- p>]</c-> <c- o>&lt;&lt;</c-> <c- n>REF_SCALE_SHIFT</c-> <c- p>)</c-> <c- o>+</c-> <c- p>(</c-> <c- n>FrameHeight</c-> <c- o>/</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>)</c-> <c- o>/</c-> <c- n>FrameHeight</c->
  <c- n>noScale</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>REF_SCALE_SHIFT</c->
   <c- n>yScale</c-> <c- o>!=</c-> <c- n>noScale</c-> <c- k>return</c-> <c- n>xScale</c-> <c- o>!=</c-> <c- n>noScale</c->
<c- p>}</c->
<c- o>~~~~~</c->
</pre>
   <h4 class="heading settled" data-level="5.11.28" id="read_inter_intra_syntax"><span class="secno">5.11.28. </span><span class="content">Read inter intra syntax</span><a class="self-link" href="#read_inter_intra_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_interintra_mode</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>skip_mode</c-> <c- o>&amp;&amp;</c-> <c- n>enable_interintra_compound</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>isCompound</c-> <c- o>&amp;&amp;</c->
          <c- n>MiSize</c-> <c- o>></c->\<c- o>=</c-> <c- n>BLOCK_8X8</c-> <c- o>&amp;&amp;</c-> <c- n>MiSize</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>BLOCK_32X32</c-><c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>interintra</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>interintra</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>interintra_mode</c->
             <c- n>RefFrame</c-><c- p>[</c-><c- mi>1</c-><c- p>]</c-> <c- o>=</c-> <c- n>INTRA_FRAME</c->
             <c- n>AngleDeltaY</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>AngleDeltaUV</c-> <c- o>=</c-> <c- mi>0</c->
             <c- n>use_filter_intra</c-> <c- o>=</c-> <c- mi>0</c->
              <c- n>S</c-><c- p>()</c-> <c- n>wedge_interintra</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>wedge_interintra</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>wedge_index</c->
                 <c- n>wedge_sign</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>interintra</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.29" id="read_compound_type_syntax"><span class="secno">5.11.29. </span><span class="content">Read compound type syntax</span><a class="self-link" href="#read_compound_type_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_compound_type</c-><c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>comp_group_idx</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>compound_idx</c-> <c- o>=</c-> <c- mi>1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip_mode</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>compound_type</c-> <c- o>=</c-> <c- n>COMPOUND_AVERAGE</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>isCompound</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>n</c-> <c- o>=</c-> <c- n>Wedge_Bits</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>enable_masked_compound</c-> <c- p>)</c-> <c- p>{</c->
                <c- n>S</c-><c- p>()</c-> <c- n>comp_group_idx</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>comp_group_idx</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>enable_jnt_comp</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>compound_idx</c->
                 <c- n>compound_type</c-> <c- o>=</c-> <c- n>compound_idx</c-> <c- o>?</c-> <c- n>COMPOUND_AVERAGE</c-> <c- o>:</c->
                                                <c- n>COMPOUND_DISTANCE</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>compound_type</c-> <c- o>=</c-> <c- n>COMPOUND_AVERAGE</c->
             <c- p>}</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>compound_type</c-> <c- o>=</c-> <c- n>COMPOUND_DIFFWTD</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>compound_type</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>compound_type</c-> <c- o>==</c-> <c- n>COMPOUND_WEDGE</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>wedge_index</c->
              <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>wedge_sign</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>compound_type</c-> <c- o>==</c-> <c- n>COMPOUND_DIFFWTD</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>mask_type</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>interintra</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>compound_type</c-> <c- o>=</c-> <c- n>wedge_interintra</c-> <c- o>?</c-> <c- n>COMPOUND_WEDGE</c-> <c- o>:</c-> <c- n>COMPOUND_INTRA</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>compound_type</c-> <c- o>=</c-> <c- n>COMPOUND_AVERAGE</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.30" id="get_mode_function"><span class="secno">5.11.30. </span><span class="content">Get mode function</span><a class="self-link" href="#get_mode_function"></a></h4>
<pre class="language-cpp highlight"><c- n>get_mode</c-><c- p>(</c-> <c- n>refList</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>refList</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>&lt;</c-> <c- n>NEAREST_NEARESTMV</c-> <c- p>)</c->
             <c- n>compMode</c-> <c- o>=</c-> <c- n>YMode</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEW_NEWMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEWMV</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAREST_NEARESTMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEARESTMV</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAR_NEARMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEARMV</c->
         <c- k>else</c->
             <c- n>compMode</c-> <c- o>=</c-> <c- n>GLOBALMV</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEW_NEWMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEWMV</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAREST_NEARESTMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEARESTMV</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>NEAR_NEARMV</c-> \
             <c- n>compMode</c-> <c- o>=</c-> <c- n>NEARMV</c->
         <c- k>else</c->
             <c- n>compMode</c-> <c- o>=</c-> <c- n>GLOBALMV</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>compMode</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.31" id="mv_syntax"><span class="secno">5.11.31. </span><span class="content">MV syntax</span><a class="self-link" href="#mv_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_mv</c-><c- p>(</c-> <c- n>ref</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>diffMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>diffMv</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>use_intrabc</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>MvCtx</c-> <c- o>=</c-> <c- n>MV_INTRABC_CONTEXT</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>MvCtx</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
      <c- n>S</c-><c- p>()</c-> <c- n>mv_joint</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mv_joint</c-> <c- o>==</c-> <c- n>MV_JOINT_HZVNZ</c-> \
         <c- n>diffMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>read_mv_component</c-><c- p>(</c-> <c- mi>0</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mv_joint</c-> <c- o>==</c-> <c- n>MV_JOINT_HNZVZ</c-> \
         <c- n>diffMv</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>read_mv_component</c-><c- p>(</c-> <c- mi>1</c-> <c- p>)</c->
     <c- n>Mv</c-><c- p>[</c-> <c- n>ref</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PredMv</c-><c- p>[</c-> <c- n>ref</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>+</c-> <c- n>diffMv</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
     <c- n>Mv</c-><c- p>[</c-> <c- n>ref</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PredMv</c-><c- p>[</c-> <c- n>ref</c-> <c- p>][</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>+</c-> <c- n>diffMv</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.32" id="mv_component_syntax"><span class="secno">5.11.32. </span><span class="content">MV component syntax</span><a class="self-link" href="#mv_component_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_mv_component</c-><c- p>(</c-> <c- n>comp</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>S</c-><c- p>()</c-> <c- n>mv_sign</c->
      <c- n>S</c-><c- p>()</c-> <c- n>mv_class</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>mv_class</c-> <c- o>==</c-> <c- n>MV_CLASS_0</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>mv_class0_bit</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>force_integer_mv</c-> <c- p>)</c->
             <c- n>mv_class0_fr</c-> <c- o>=</c-> <c- mi>3</c->
         <c- k>else</c->
              <c- n>S</c-><c- p>()</c-> <c- n>mv_class0_fr</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>allow_high_precision_mv</c-> <c- p>)</c->
              <c- n>S</c-><c- p>()</c-> <c- n>mv_class0_hp</c->
         <c- k>else</c->
             <c- n>mv_class0_hp</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>mag</c-> <c- o>=</c-> <c- p>(</c-> <c- p>(</c-> <c- n>mv_class0_bit</c-> <c- o>&lt;&lt;</c-> <c- mi>3</c-> <c- p>)</c-> \
                 <c- p>(</c-> <c- n>mv_class0_fr</c-> <c- o>&lt;&lt;</c-> <c- mi>1</c-> <c- p>)</c-> \
                   <c- n>mv_class0_hp</c-> <c- p>)</c-> <c- o>+</c-> <c- mi>1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>d</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>mv_class</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>mv_bit</c->
             <c- o>=</c-> <c- n>mv_bit</c-> \<c- o>&lt;</c->\<c- o>&lt;</c-> <c- n>i</c-> <c- n>d</c-> \
         <c- p>}</c->
         <c- n>mag</c-> <c- o>=</c-> <c- n>CLASS0_SIZE</c-> <c- o>&lt;&lt;</c-> <c- p>(</c-> <c- n>mv_class</c-> <c- o>+</c-> <c- mi>2</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>force_integer_mv</c-> <c- p>)</c->
             <c- n>mv_fr</c-> <c- o>=</c-> <c- mi>3</c->
         <c- k>else</c->
              <c- n>S</c-><c- p>()</c-> <c- n>mv_fr</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>allow_high_precision_mv</c-> <c- p>)</c->
              <c- n>S</c-><c- p>()</c-> <c- n>mv_hp</c->
         <c- k>else</c->
             <c- n>mv_hp</c-> <c- o>=</c-> <c- mi>1</c->
         <c- n>mag</c-> <c- o>+=</c-> <c- p>(</c-> <c- p>(</c-> <c- n>d</c-> <c- o>&lt;&lt;</c-> <c- mi>3</c-> <c- p>)</c-> \
     <c- p>}</c->
     <c- k>return</c-> <c- n>mv_sign</c-> <c- o>?</c-> <c- o>-</c-><c- n>mag</c-> <c- o>:</c-> <c- n>mag</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.33" id="compute_prediction_syntax"><span class="secno">5.11.33. </span><span class="content">Compute prediction syntax</span><a class="self-link" href="#compute_prediction_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>compute_prediction</c-><c- p>()</c-> <c- p>{</c->
     <c- n>sbMask</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- mi>31</c-> <c- o>:</c-> <c- mi>15</c->
     <c- n>subBlockMiRow</c-> <c- o>=</c-> <c- n>MiRow</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
     <c- n>subBlockMiCol</c-> <c- o>=</c-> <c- n>MiCol</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>HasChroma</c-> <c- o>*</c-> <c- mi>2</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>planeSz</c-> <c- o>=</c-> <c- n>get_plane_residual_size</c-><c- p>(</c-> <c- n>MiSize</c-><c- p>,</c-> <c- n>plane</c-> <c- p>)</c->
         <c- n>num4x4W</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
         <c- n>num4x4H</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
         <c- n>log2W</c-> <c- o>=</c-> <c- n>MI_SIZE_LOG2</c-> <c- o>+</c-> <c- n>Mi_Width_Log2</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
         <c- n>log2H</c-> <c- o>=</c-> <c- n>MI_SIZE_LOG2</c-> <c- o>+</c-> <c- n>Mi_Height_Log2</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
         <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
         <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
         <c- n>baseX</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiCol</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
         <c- n>baseY</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiRow</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
         <c- n>candRow</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiRow</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>&lt;&lt;</c-> <c- n>subY</c->
         <c- n>candCol</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiCol</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>&lt;&lt;</c-> <c- n>subX</c->
         <c- n>IsInterIntra</c-> <c- o>=</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- o>&amp;&amp;</c-> <c- n>RefFrame</c-><c- p>[</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>==</c-> <c- n>INTRA_FRAME</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>IsInterIntra</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>interintra_mode</c-> <c- o>==</c-> <c- n>II_DC_PRED</c-> <c- p>)</c-> <c- n>mode</c-> <c- o>=</c-> <c- n>DC_PRED</c->
             <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>interintra_mode</c-> <c- o>==</c-> <c- n>II_V_PRED</c-> <c- p>)</c-> <c- n>mode</c-> <c- o>=</c-> <c- n>V_PRED</c->
             <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>interintra_mode</c-> <c- o>==</c-> <c- n>II_H_PRED</c-> <c- p>)</c-> <c- n>mode</c-> <c- o>=</c-> <c- n>H_PRED</c->
             <c- k>else</c-> <c- n>mode</c-> <c- o>=</c-> <c- n>SMOOTH_PRED</c->
             <c- n>predict_intra</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>baseX</c-><c- p>,</c-> <c- n>baseY</c-><c- p>,</c->
                            <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>?</c-> <c- n>AvailL</c-> <c- o>:</c-> <c- n>AvailLChroma</c-><c- p>,</c->
                            <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>?</c-> <c- n>AvailU</c-> <c- o>:</c-> <c- n>AvailUChroma</c-><c- p>,</c->
                            <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiRow</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiCol</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>+</c-> <c- n>num4x4W</c-> <c- p>],</c->
                            <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiRow</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>+</c-> <c- n>num4x4H</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiCol</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>],</c->
                            <c- n>mode</c-><c- p>,</c->
                            <c- n>log2W</c-><c- p>,</c-> <c- n>log2H</c-> <c- p>)</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>predW</c-> <c- o>=</c-> <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>>></c-> <c- n>subX</c->
             <c- n>predH</c-> <c- o>=</c-> <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>>></c-> <c- n>subY</c->
             <c- n>someUseIntra</c-> <c- o>=</c-> <c- mi>0</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>r</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>r</c-> <c- o>&lt;</c-> <c- p>(</c-><c- n>num4x4H</c-> <c- o>&lt;&lt;</c-> <c- n>subY</c-><c- p>);</c-> <c- n>r</c-><c- o>++</c-> <c- p>)</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>c</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>c</c-> <c- o>&lt;</c-> <c- p>(</c-><c- n>num4x4W</c-> <c- o>&lt;&lt;</c-> <c- n>subX</c-><c- p>);</c-> <c- n>c</c-><c- o>++</c-> <c- p>)</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>RefFrames</c-><c- p>[</c-> <c- n>candRow</c-> <c- o>+</c-> <c- n>r</c-> <c- p>][</c-> <c- n>candCol</c-> <c- o>+</c-> <c- n>c</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- o>==</c-> <c- n>INTRA_FRAME</c-> <c- p>)</c->
                         <c- n>someUseIntra</c-> <c- o>=</c-> <c- mi>1</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>someUseIntra</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>predW</c-> <c- o>=</c-> <c- n>num4x4W</c-> <c- o>*</c-> <c- mi>4</c->
                 <c- n>predH</c-> <c- o>=</c-> <c- n>num4x4H</c-> <c- o>*</c-> <c- mi>4</c->
                 <c- n>candRow</c-> <c- o>=</c-> <c- n>MiRow</c->
                 <c- n>candCol</c-> <c- o>=</c-> <c- n>MiCol</c->
             <c- p>}</c->
             <c- n>r</c-> <c- o>=</c-> <c- mi>0</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>num4x4H</c-> <c- o>*</c-> <c- mi>4</c-><c- p>;</c-> <c- n>y</c-> <c- o>+=</c-> <c- n>predH</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>c</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>num4x4W</c-> <c- o>*</c-> <c- mi>4</c-><c- p>;</c-> <c- n>x</c-> <c- o>+=</c-> <c- n>predW</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>predict_inter</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>baseX</c-> <c- o>+</c-> <c- n>x</c-><c- p>,</c-> <c- n>baseY</c-> <c- o>+</c-> <c- n>y</c-><c- p>,</c->
                                    <c- n>predW</c-><c- p>,</c-> <c- n>predH</c-><c- p>,</c->
                                    <c- n>candRow</c-> <c- o>+</c-> <c- n>r</c-><c- p>,</c-> <c- n>candCol</c-> <c- o>+</c-> <c- n>c</c-><c- p>)</c->
                     <c- n>c</c-><c- o>++</c->
                 <c- p>}</c->
                 <c- n>r</c-><c- o>++</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.34" id="residual_syntax"><span class="secno">5.11.34. </span><span class="content">Residual syntax</span><a class="self-link" href="#residual_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>residual</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>sbMask</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- mi>31</c-> <c- o>:</c-> <c- mi>15</c->
     <c- n>widthChunks</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>1</c-><c- p>,</c-> <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>6</c-> <c- p>)</c->
     <c- n>heightChunks</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>1</c-><c- p>,</c-> <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>6</c-> <c- p>)</c->
     <c- n>miSizeChunk</c-> <c- o>=</c-> <c- p>(</c-> <c- n>widthChunks</c-> <c- o>></c-> <c- mi>1</c-> \
     <c- k>for</c-> <c- p>(</c-> <c- n>chunkY</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>chunkY</c-> <c- o>&lt;</c-> <c- n>heightChunks</c-><c- p>;</c-> <c- n>chunkY</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>chunkX</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>chunkX</c-> <c- o>&lt;</c-> <c- n>widthChunks</c-><c- p>;</c-> <c- n>chunkX</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>miRowChunk</c-> <c- o>=</c-> <c- n>MiRow</c-> <c- o>+</c-> <c- p>(</c-> <c- n>chunkY</c-> <c- o>&lt;&lt;</c-> <c- mi>4</c-> <c- p>)</c->
             <c- n>miColChunk</c-> <c- o>=</c-> <c- n>MiCol</c-> <c- o>+</c-> <c- p>(</c-> <c- n>chunkX</c-> <c- o>&lt;&lt;</c-> <c- mi>4</c-> <c- p>)</c->
             <c- n>subBlockMiRow</c-> <c- o>=</c-> <c- n>miRowChunk</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
             <c- n>subBlockMiCol</c-> <c- o>=</c-> <c- n>miColChunk</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>HasChroma</c-> <c- o>*</c-> <c- mi>2</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>txSz</c-> <c- o>=</c-> <c- n>Lossless</c-> <c- o>?</c-> <c- n>TX_4X4</c-> <c- o>:</c-> <c- n>get_tx_size</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>TxSize</c-> <c- p>)</c->
                 <c- n>stepX</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c->
                 <c- n>stepY</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c->
                 <c- n>planeSz</c-> <c- o>=</c-> <c- n>get_plane_residual_size</c-><c- p>(</c-> <c- n>miSizeChunk</c-><c- p>,</c-> <c- n>plane</c-> <c- p>)</c->
                 <c- n>num4x4W</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
                 <c- n>num4x4H</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>planeSz</c-> <c- p>]</c->
                 <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
                 <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
                 <c- n>baseX</c-> <c- o>=</c-> <c- p>(</c-><c- n>miColChunk</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
                 <c- n>baseY</c-> <c- o>=</c-> <c- p>(</c-><c- n>miRowChunk</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>Lossless</c-> <c- o>&amp;&amp;</c-> <c- o>!</c-><c- n>plane</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>transform_tree</c-><c- p>(</c-> <c- n>baseX</c-><c- p>,</c-> <c- n>baseY</c-><c- p>,</c-> <c- n>num4x4W</c-> <c- o>*</c-> <c- mi>4</c-><c- p>,</c-> <c- n>num4x4H</c-> <c- o>*</c-> <c- mi>4</c-> <c- p>)</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                     <c- n>baseXBlock</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiCol</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
                     <c- n>baseYBlock</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiRow</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
                     <c- k>for</c-> <c- p>(</c-> <c- n>y</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>y</c-> <c- o>&lt;</c-> <c- n>num4x4H</c-><c- p>;</c-> <c- n>y</c-> <c- o>+=</c-> <c- n>stepY</c-> <c- p>)</c->
                         <c- k>for</c-> <c- p>(</c-> <c- n>x</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>x</c-> <c- o>&lt;</c-> <c- n>num4x4W</c-><c- p>;</c-> <c- n>x</c-> <c- o>+=</c-> <c- n>stepX</c-> <c- p>)</c->
                             <c- n>transform_block</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>baseXBlock</c-><c- p>,</c-> <c- n>baseYBlock</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c->
                                              <c- n>x</c-> <c- o>+</c-> <c- p>(</c-> <c- p>(</c-> <c- n>chunkX</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- mi>4</c-> <c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- mi>4</c-> <c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>subX</c-> <c- p>),</c->
                                              <c- n>y</c-> <c- o>+</c-> <c- p>(</c-> <c- p>(</c-> <c- n>chunkY</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- mi>4</c-> <c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- mi>4</c-> <c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>subY</c-> <c- p>)</c-> <c- p>)</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.35" id="transform_block_syntax"><span class="secno">5.11.35. </span><span class="content">Transform block syntax</span><a class="self-link" href="#transform_block_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>transform_block</c-><c- p>(</c-><c- n>plane</c-><c- p>,</c-> <c- n>baseX</c-><c- p>,</c-> <c- n>baseY</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c-> <c- n>x</c-><c- p>,</c-> <c- n>y</c-><c- p>)</c-> <c- p>{</c->
     <c- n>startX</c-> <c- o>=</c-> <c- n>baseX</c-> <c- o>+</c-> <c- mi>4</c-> <c- o>*</c-> <c- n>x</c->
     <c- n>startY</c-> <c- o>=</c-> <c- n>baseY</c-> <c- o>+</c-> <c- mi>4</c-> <c- o>*</c-> <c- n>y</c->
     <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
     <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
     <c- n>row</c-> <c- o>=</c-> <c- p>(</c-> <c- n>startY</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- n>subY</c-> <c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>col</c-> <c- o>=</c-> <c- p>(</c-> <c- n>startX</c-> <c- o>&lt;</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-> <c- k>class</c-><c- o>=</c-><c- n>production</c-> <c- n>bs</c-><c- o>-</c-><c- n>autolink</c-><c- o>-</c-><c- n>syntax</c-><c- o>=</c->'<c- o>&lt;&lt;</c-> <c- n>subX</c-> <c- p>)</c-> <c- o>>></c->' <c- n>data</c-><c- o>-</c-><c- n>opaque</c-><c- o>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>&lt;/</c-><c- n>fake</c-><c- o>-</c-><c- n>production</c-><c- o>-</c-><c- n>placeholder</c-><c- o>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>sbMask</c-> <c- o>=</c-> <c- n>use_128x128_superblock</c-> <c- o>?</c-> <c- mi>31</c-> <c- o>:</c-> <c- mi>15</c->
     <c- n>subBlockMiRow</c-> <c- o>=</c-> <c- n>row</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
     <c- n>subBlockMiCol</c-> <c- o>=</c-> <c- n>col</c-> <c- o>&amp;</c-> <c- n>sbMask</c->
     <c- n>stepX</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>stepY</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>maxX</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiCols</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>>></c-> <c- n>subX</c->
     <c- n>maxY</c-> <c- o>=</c-> <c- p>(</c-><c- n>MiRows</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>>></c-> <c- n>subY</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>startX</c-> <c- o>></c->\<c- o>=</c-> <c- n>maxX</c-> \
         <c- k>return</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
         \ <c- k>if</c-> <c- p>(</c-> <c- p>(</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- o>&amp;&amp;</c-> <c- n>PaletteSizeY</c-> <c- p>)</c-> \
              <c- p>(</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>!=</c-> <c- mi>0</c-> <c- p>)</c-> <c- o>&amp;&amp;</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>predict_palette</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>x</c-><c- p>,</c-> <c- n>y</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>isCfl</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>></c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>UVMode</c-> <c- o>==</c-> <c- n>UV_CFL_PRED</c-><c- p>)</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>mode</c-> <c- o>=</c-> <c- n>YMode</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>mode</c-> <c- o>=</c-> <c- p>(</c-> <c- n>isCfl</c-> <c- p>)</c-> <c- o>?</c-> <c- n>DC_PRED</c-> <c- o>:</c-> <c- n>UVMode</c->
             <c- p>}</c->
             <c- n>log2W</c-> <c- o>=</c-> <c- n>Tx_Width_Log2</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
             <c- n>log2H</c-> <c- o>=</c-> <c- n>Tx_Height_Log2</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
             <c- n>predict_intra</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c->
                            <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>?</c-> <c- n>AvailL</c-> <c- o>:</c-> <c- n>AvailLChroma</c-> <c- p>)</c-> \
                            <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>?</c-> <c- n>AvailU</c-> <c- o>:</c-> <c- n>AvailUChroma</c-> <c- p>)</c-> \
                            <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiRow</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiCol</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>+</c-> <c- n>stepX</c-> <c- p>],</c->
                            <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiRow</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>+</c-> <c- n>stepY</c-> <c- p>]</c->
                                        <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiCol</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>],</c->
                            <c- n>mode</c-><c- p>,</c->
                            <c- n>log2W</c-><c- p>,</c-> <c- n>log2H</c-> <c- p>)</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>isCfl</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>predict_chroma_from_luma</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>MaxLumaW</c-> <c- o>=</c-> <c- n>startX</c-> <c- o>+</c-> <c- n>stepX</c-> <c- o>*</c-> <c- mi>4</c->
             <c- n>MaxLumaH</c-> <c- o>=</c-> <c- n>startY</c-> <c- o>+</c-> <c- n>stepY</c-> <c- o>*</c-> <c- mi>4</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>skip</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>eob</c-> <c- o>=</c-> <c- n>coeffs</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>eob</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c->
             <c- n>reconstruct</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- p>}</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>stepY</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>stepX</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>LoopfilterTxSizes</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                              <c- p>[</c-> <c- p>(</c-><c- n>row</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c->
                              <c- p>[</c-> <c- p>(</c-><c- n>col</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>+</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>txSz</c->
             <c- n>BlockDecoded</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                         <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiRow</c-> <c- o>>></c-> <c- n>subY</c-> <c- p>)</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c->
                         <c- p>[</c-> <c- p>(</c-> <c- n>subBlockMiCol</c-> <c- o>>></c-> <c- n>subX</c-> <c- p>)</c-> <c- o>+</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>1</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.36" id="transform_tree_syntax"><span class="secno">5.11.36. </span><span class="content">Transform tree syntax</span><a class="self-link" href="#transform_tree_syntax"></a></h4>
   <p>transform_tree is used to read a number of transform blocks arranged in a transform tree.</p>
<pre class="language-cpp highlight"><c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- p>,</c-> <c- n>h</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>maxX</c-> <c- o>=</c-> <c- n>MiCols</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
     <c- n>maxY</c-> <c- o>=</c-> <c- n>MiRows</c-> <c- o>*</c-> <c- n>MI_SIZE</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>startX</c-> <c- o>></c->\<c- o>=</c-> <c- n>maxX</c-> \
         <c- k>return</c->
     <c- p>}</c->
     <c- n>row</c-> <c- o>=</c-> <c- n>startY</c-> <c- o>>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>col</c-> <c- o>=</c-> <c- n>startX</c-> <c- o>>></c-> <c- n>MI_SIZE_LOG2</c->
     <c- n>lumaTxSz</c-> <c- o>=</c-> <c- n>InterTxSizes</c-><c- p>[</c-> <c- n>row</c-> <c- p>][</c-> <c- n>col</c-> <c- p>]</c->
     <c- n>lumaW</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>lumaTxSz</c-> <c- p>]</c->
     <c- n>lumaH</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>lumaTxSz</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>w</c-> <c- o>&lt;=</c-> <c- n>lumaW</c-> <c- o>&amp;&amp;</c-> <c- n>h</c-> <c- o>&lt;=</c-> <c- n>lumaH</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>txSz</c-> <c- o>=</c-> <c- n>find_tx_size</c-><c- p>(</c-> <c- n>w</c-><c- p>,</c-> <c- n>h</c-> <c- p>)</c->
         <c- n>transform_block</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>w</c-> <c- o>></c-> <c- n>h</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-> <c- p>)</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-> <c- o>+</c-> <c- n>w</c-> <c- o>/</c-> <c- mi>2</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>w</c-> <c- o>&lt;</c-> <c- n>h</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-> <c- o>+</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>w</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-> <c- o>+</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-> <c- o>+</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
             <c- n>transform_tree</c-><c- p>(</c-> <c- n>startX</c-> <c- o>+</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>startY</c-> <c- o>+</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>w</c-><c- o>/</c-><c- mi>2</c-><c- p>,</c-> <c- n>h</c-><c- o>/</c-><c- mi>2</c-> <c- p>)</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where find_tx_size finds the transform size matching the given dimensions and is defined as:</p>
<pre class="language-c highlight"><c- n>find_tx_size</c-><c- p>(</c-> <c- n>w</c-><c- p>,</c-> <c- n>h</c-> <c- p>)</c-> <c- p>{</c->
    <c- k>for</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>txSz</c-> <c- o>&lt;</c-> <c- n>TX_SIZES_ALL</c-><c- p>;</c-> <c- n>txSz</c-><c- o>++</c-> <c- p>)</c->
        <c- k>if</c-> <c- p>(</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>==</c-> <c- n>w</c-> <c- o>&amp;&amp;</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>==</c-> <c- n>h</c-> <c- p>)</c->
            <c- k>break</c->
    <c- k>return</c-> <c- n>txSz</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.37" id="get_tx_size_function"><span class="secno">5.11.37. </span><span class="content">Get TX size function</span><a class="self-link" href="#get_tx_size_function"></a></h4>
<pre class="language-cpp highlight"><c- n>get_tx_size</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>txSz</c->
     <c- n>uvTx</c-> <c- o>=</c-> <c- n>Max_Tx_Size_Rect</c-><c- p>[</c-> <c- n>get_plane_residual_size</c-><c- p>(</c-> <c- n>MiSize</c-><c- p>,</c-> <c- n>plane</c-> <c- p>)</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>uvTx</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>64</c-> \
         <c- k>if</c-> <c- p>(</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>uvTx</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>16</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>return</c-> <c- n>TX_16X32</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>uvTx</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>16</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>return</c-> <c- n>TX_32X16</c->
         <c- p>}</c->
         <c- k>return</c-> <c- n>TX_32X32</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>uvTx</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.38" id="get_plane_residual_size_function"><span class="secno">5.11.38. </span><span class="content">Get plane residual size function</span><a class="self-link" href="#get_plane_residual_size_function"></a></h4>
   <p>The get_plane_residual_size returns the size of a residual block for the
specified plane. (The residual block will always have width and height at least
equal to 4.)</p>
<pre class="language-cpp highlight"><c- n>get_plane_residual_size</c-><c- p>(</c-> <c- n>subsize</c-><c- p>,</c-> <c- n>plane</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>subx</c-> <c- o>=</c-> <c- n>plane</c-> <c- o>></c-> <c- mi>0</c-> <c- o>?</c-> <c- n>subsampling_x</c-> <c- o>:</c-> <c- mi>0</c->
     <c- n>suby</c-> <c- o>=</c-> <c- n>plane</c-> <c- o>></c-> <c- mi>0</c-> <c- o>?</c-> <c- n>subsampling_y</c-> <c- o>:</c-> <c- mi>0</c->
     <c- k>return</c-> <c- n>Subsampled_Size</c-><c- p>[</c-> <c- n>subsize</c-> <c- p>][</c-> <c- n>subx</c-> <c- p>][</c-> <c- n>suby</c-> <c- p>]</c->
 <c- p>}</c->
</pre>
   <p>The Subsampled_Size table is defined as:</p>
<pre class="language-c highlight"><c- n>Subsampled_Size</c-><c- p>[</c-> <c- n>BLOCK_SIZES</c-> <c- p>][</c-> <c- mi>2</c-> <c- p>][</c-> <c- mi>2</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c->
  <c- p>{</c-> <c- p>{</c-> <c- n>BLOCK_4X4</c-><c- p>,</c->    <c- n>BLOCK_4X4</c-><c- p>},</c->      <c- p>{</c-><c- n>BLOCK_4X4</c-><c- p>,</c->     <c- n>BLOCK_4X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-> <c- n>BLOCK_4X8</c-><c- p>,</c->    <c- n>BLOCK_4X4</c-><c- p>},</c->      <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_4X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-> <c- n>BLOCK_8X4</c-><c- p>,</c->    <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_4X4</c-><c- p>,</c->     <c- n>BLOCK_4X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-> <c- n>BLOCK_8X8</c-><c- p>,</c->    <c- n>BLOCK_8X4</c-><c- p>},</c->      <c- p>{</c-><c- n>BLOCK_4X8</c-><c- p>,</c->     <c- n>BLOCK_4X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_8X16</c-><c- p>,</c->    <c- n>BLOCK_8X8</c-><c- p>},</c->      <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_4X8</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_16X8</c-><c- p>,</c->    <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_8X8</c-><c- p>,</c->     <c- n>BLOCK_8X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_16X16</c-><c- p>,</c->   <c- n>BLOCK_16X8</c-><c- p>},</c->     <c- p>{</c-><c- n>BLOCK_8X16</c-><c- p>,</c->    <c- n>BLOCK_8X8</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_16X32</c-><c- p>,</c->   <c- n>BLOCK_16X16</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_8X16</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_32X16</c-><c- p>,</c->   <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_16X16</c-><c- p>,</c->   <c- n>BLOCK_16X8</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_32X32</c-><c- p>,</c->   <c- n>BLOCK_32X16</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_16X32</c-><c- p>,</c->   <c- n>BLOCK_16X16</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_32X64</c-><c- p>,</c->   <c- n>BLOCK_32X32</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_16X32</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_64X32</c-><c- p>,</c->   <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_32X32</c-><c- p>,</c->   <c- n>BLOCK_32X16</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_64X64</c-><c- p>,</c->   <c- n>BLOCK_64X32</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_32X64</c-><c- p>,</c->   <c- n>BLOCK_32X32</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_64X128</c-><c- p>,</c->  <c- n>BLOCK_64X64</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_32X64</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_128X64</c-><c- p>,</c->  <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_64X64</c-><c- p>,</c->   <c- n>BLOCK_64X32</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_128X128</c-><c- p>,</c-> <c- n>BLOCK_128X64</c-><c- p>},</c->   <c- p>{</c-><c- n>BLOCK_64X128</c-><c- p>,</c->  <c- n>BLOCK_64X64</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_4X16</c-><c- p>,</c->    <c- n>BLOCK_4X8</c-><c- p>},</c->      <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_4X8</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_16X4</c-><c- p>,</c->    <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_8X4</c-><c- p>,</c->     <c- n>BLOCK_8X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_8X32</c-><c- p>,</c->    <c- n>BLOCK_8X16</c-><c- p>},</c->     <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_4X16</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_32X8</c-><c- p>,</c->    <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_16X8</c-><c- p>,</c->    <c- n>BLOCK_16X4</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_16X64</c-><c- p>,</c->   <c- n>BLOCK_16X32</c-><c- p>},</c->    <c- p>{</c-><c- n>BLOCK_INVALID</c-><c- p>,</c-> <c- n>BLOCK_8X32</c-><c- p>}</c-> <c- p>},</c->
  <c- p>{</c-> <c- p>{</c-><c- n>BLOCK_64X16</c-><c- p>,</c->   <c- n>BLOCK_INVALID</c-><c- p>},</c->  <c- p>{</c-><c- n>BLOCK_32X16</c-><c- p>,</c->   <c- n>BLOCK_32X8</c-><c- p>}</c-> <c- p>},</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.39" id="coefficients_syntax"><span class="secno">5.11.39. </span><span class="content">Coefficients syntax</span><a class="self-link" href="#coefficients_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>coeffs</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>startX</c-><c- p>,</c-> <c- n>startY</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>x4</c-> <c- o>=</c-> <c- n>startX</c-> <c- o>>></c-> <c- mi>2</c->
     <c- n>y4</c-> <c- o>=</c-> <c- n>startY</c-> <c- o>>></c-> <c- mi>2</c->
     <c- n>w4</c-> <c- o>=</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c->
     <c- n>h4</c-> <c- o>=</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c->
     <c- n>txSzCtx</c-> <c- o>=</c-> <c- p>(</c-> <c- n>Tx_Size_Sqr</c-><c- p>[</c-><c- n>txSz</c-><c- p>]</c-> <c- o>+</c-> <c- n>Tx_Size_Sqr_Up</c-><c- p>[</c-><c- n>txSz</c-><c- p>]</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>>></c-> <c- mi>1</c->
     <c- n>ptype</c-> <c- o>=</c-> <c- n>plane</c-> <c- o>></c-> <c- mi>0</c->
     <c- n>segEob</c-> <c- o>=</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X64</c-> \
                 <c- n>Min</c-><c- p>(</c-> <c- mi>1024</c-><c- p>,</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>*</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- p>)</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>c</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>c</c-> <c- o>&lt;</c-> <c- n>segEob</c-><c- p>;</c-> <c- n>c</c-><c- o>++</c-> <c- p>)</c->
         <c- n>Quant</c-><c- p>[</c-><c- n>c</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>64</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- mi>64</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c->
             <c- n>Dequant</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>eob</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>culLevel</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>dcCategory</c-> <c- o>=</c-> <c- mi>0</c->
      <c- n>S</c-><c- p>()</c-> <c- n>all_zero</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>all_zero</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>c</c-> <c- o>=</c-> <c- mi>0</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>w4</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>h4</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>TxTypes</c-><c- p>[</c-> <c- n>y4</c-> <c- o>+</c-> <c- n>j</c-> <c- p>][</c-> <c- n>x4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>DCT_DCT</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c->
             <c- n>transform_type</c-><c- p>(</c-> <c- n>x4</c-><c- p>,</c-> <c- n>y4</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c->
         <c- n>PlaneTxType</c-> <c- o>=</c-> <c- n>compute_tx_type</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c-> <c- n>x4</c-><c- p>,</c-> <c- n>y4</c-> <c- p>)</c->
         <c- n>scan</c-> <c- o>=</c-> <c- n>get_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
         <c- n>eobMultisize</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>Tx_Width_Log2</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>],</c-> <c- mi>5</c-><c- p>)</c-> <c- o>+</c-> <c- n>Min</c-><c- p>(</c-> <c- n>Tx_Height_Log2</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>],</c-> <c- mi>5</c-><c- p>)</c-> <c- o>-</c-> <c- mi>4</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_16</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_16</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_32</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_32</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_64</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_64</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>3</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_128</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_128</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>4</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_256</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_256</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>eobMultisize</c-> <c- o>==</c-> <c- mi>5</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_512</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_512</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_pt_1024</c->
             <c- n>eobPt</c-> <c- o>=</c-> <c- n>eob_pt_1024</c-> <c- o>+</c-> <c- mi>1</c->
         <c- p>}</c->
         <c- n>eob</c-> <c- o>=</c-> <c- p>(</c-> <c- n>eobPt</c-> <c- o>&lt;</c-> <c- mi>2</c-> <c- p>)</c-> <c- o>?</c-> <c- n>eobPt</c-> <c- o>:</c-> <c- p>(</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- p>(</c-> <c- n>eobPt</c-> <c- o>-</c-> <c- mi>2</c-> <c- p>)</c-> <c- p>)</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c->
         <c- n>eobShift</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>-1</c-><c- p>,</c-> <c- n>eobPt</c-> <c- o>-</c-> <c- mi>3</c-> <c- p>)</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>eobShift</c-> <c- o>></c->\<c- o>=</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>eob_extra</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>eob_extra</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>eob</c-> <c- o>+=</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>eobShift</c-> <c- p>)</c->
             <c- p>}</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>eobPt</c-> <c- o>-</c-> <c- mi>2</c-> <c- p>);</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>eobShift</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>eobPt</c-> <c- o>-</c-> <c- mi>2</c-> <c- p>)</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>i</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>eob_extra_bit</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>eob_extra_bit</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>eob</c-> <c- o>+=</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>eobShift</c-> <c- p>)</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>c</c-> <c- o>=</c-> <c- n>eob</c-> <c- o>-</c-> <c- mi>1</c-><c- p>;</c-> <c- n>c</c-> <c- o>></c->\<c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>c</c-><c- o>--</c->  <c- p>)</c-> <c- p>{</c->
             <c- n>pos</c-> <c- o>=</c-> <c- n>scan</c-><c- p>[</c-> <c- n>c</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>c</c-> <c- o>==</c-> <c- p>(</c-> <c- n>eob</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>coeff_base_eob</c->
                 <c- n>level</c-> <c- o>=</c-> <c- n>coeff_base_eob</c-> <c- o>+</c-> <c- mi>1</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>coeff_base</c->
                 <c- n>level</c-> <c- o>=</c-> <c- n>coeff_base</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>level</c-> <c- o>></c-> <c- n>NUM_BASE_LEVELS</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
                       <c- n>idx</c-> <c- o>&lt;</c-> <c- n>COEFF_BASE_RANGE</c-> <c- o>/</c-> <c- p>(</c-> <c- n>BR_CDF_SIZE</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>);</c->
                       <c- n>idx</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>coeff_br</c->
                     <c- n>level</c-> <c- o>+=</c-> <c- n>coeff_br</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>coeff_br</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- n>BR_CDF_SIZE</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>)</c->
                         <c- k>break</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>=</c-> <c- n>level</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>c</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>c</c-> <c- o>&lt;</c-> <c- n>eob</c-><c- p>;</c-> <c- n>c</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>pos</c-> <c- o>=</c-> <c- n>scan</c-><c- p>[</c-> <c- n>c</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>!=</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>c</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>S</c-><c- p>()</c-> <c- n>dc_sign</c->
                     <c- n>sign</c-> <c- o>=</c-> <c- n>dc_sign</c->
                 <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                      <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>sign_bit</c->
                     <c- n>sign</c-> <c- o>=</c-> <c- n>sign_bit</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>sign</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>></c->
                 <c- p>(</c-> <c- n>NUM_BASE_LEVELS</c-> <c- o>+</c-> <c- n>COEFF_BASE_RANGE</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>length</c-> <c- o>=</c-> <c- mi>0</c->
                 <c- k>do</c-> <c- p>{</c->
                     <c- n>length</c-><c- o>++</c->
                      <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>golomb_length_bit</c->
                 <c- p>}</c-> <c- k>while</c-> <c- p>(</c-> <c- o>!</c-><c- n>golomb_length_bit</c-> <c- p>)</c->
                 <c- n>x</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>length</c-> <c- o>-</c-> <c- mi>2</c-><c- p>;</c-> <c- n>i</c-> <c- o>></c->\<c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-><c- o>--</c->  <c- p>)</c-> <c- p>{</c->
                      <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>golomb_data_bit</c->
                      <c- n>golomb_data_bit</c-> <c- n>x</c-> <c- o>=</c-> <c- p>(</c-> <c- n>x</c-> <c- o>&lt;&lt;</c-> <c- mi>1</c-> <c- p>)</c-> \
                 <c- p>}</c->
                <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>=</c-> <c- n>x</c-> <c- o>+</c-> <c- n>COEFF_BASE_RANGE</c-> <c- o>+</c-> <c- n>NUM_BASE_LEVELS</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>pos</c-> <c- o>==</c-> <c- mi>0</c-> <c- o>&amp;&amp;</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>dcCategory</c-> <c- o>=</c-> <c- n>sign</c-> <c- o>?</c-> <c- mi>1</c-> <c- o>:</c-> <c- mi>2</c->
             <c- p>}</c->
             <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>&amp;</c-> <c- mh>0xFFFFF</c->
             <c- n>culLevel</c-> <c- o>+=</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>sign</c-> <c- p>)</c->
                 <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c-> <c- o>=</c-> <c- o>-</c-> <c- n>Quant</c-><c- p>[</c-> <c- n>pos</c-> <c- p>]</c->
         <c- p>}</c->
         <c- n>culLevel</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- mi>63</c-><c- p>,</c-> <c- n>culLevel</c-> <c- p>)</c->
     <c- p>}</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>w4</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>AboveLevelContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>x4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>culLevel</c->
         <c- n>AboveDcContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>x4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>dcCategory</c->
     <c- p>}</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>h4</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>LeftLevelContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>y4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>culLevel</c->
         <c- n>LeftDcContext</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>y4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>dcCategory</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>eob</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.40" id="compute_transform_type_function"><span class="secno">5.11.40. </span><span class="content">Compute transform type function</span><a class="self-link" href="#compute_transform_type_function"></a></h4>
<pre class="language-cpp highlight"><c- n>compute_tx_type</c-><c- p>(</c-> <c- n>plane</c-><c- p>,</c-> <c- n>txSz</c-><c- p>,</c-> <c- n>blockX</c-><c- p>,</c-> <c- n>blockY</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>txSzSqrUp</c-> <c- o>=</c-> <c- n>Tx_Size_Sqr_Up</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>Lossless</c-> \
         <c- k>return</c-> <c- n>DCT_DCT</c->
     <c- n>txSet</c-> <c- o>=</c-> <c- n>get_tx_set</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>TxTypes</c-><c- p>[</c-> <c- n>blockY</c-> <c- p>][</c-> <c- n>blockX</c-> <c- p>]</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>x4</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- n>MiCol</c-><c- p>,</c-> <c- n>blockX</c-> <c- o>&lt;&lt;</c-> <c- n>subsampling_x</c-> <c- p>)</c->
         <c- n>y4</c-> <c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- n>MiRow</c-><c- p>,</c-> <c- n>blockY</c-> <c- o>&lt;&lt;</c-> <c- n>subsampling_y</c-> <c- p>)</c->
         <c- n>txType</c-> <c- o>=</c-> <c- n>TxTypes</c-><c- p>[</c-> <c- n>y4</c-> <c- p>][</c-> <c- n>x4</c-> <c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>is_tx_type_in_set</c-><c- p>(</c-> <c- n>txSet</c-><c- p>,</c-> <c- n>txType</c-> <c- p>)</c-> <c- p>)</c->
             <c- k>return</c-> <c- n>DCT_DCT</c->
         <c- k>return</c-> <c- n>txType</c->
     <c- p>}</c->
     <c- n>txType</c-> <c- o>=</c-> <c- n>Mode_To_Txfm</c-><c- p>[</c-> <c- n>UVMode</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- o>!</c-><c- n>is_tx_type_in_set</c-><c- p>(</c-> <c- n>txSet</c-><c- p>,</c-> <c- n>txType</c-> <c- p>)</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>DCT_DCT</c->
     <c- k>return</c-> <c- n>txType</c->
 <c- p>}</c->
 <c- n>is_tx_type_in_set</c-><c- p>(</c-> <c- n>txSet</c-><c- p>,</c-> <c- n>txType</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>return</c-> <c- n>is_inter</c-> <c- o>?</c-> <c- n>Tx_Type_In_Set_Inter</c-><c- p>[</c-> <c- n>txSet</c-> <c- p>][</c-> <c- n>txType</c-> <c- p>]</c-> <c- o>:</c->
                       <c- n>Tx_Type_In_Set_Intra</c-><c- p>[</c-> <c- n>txSet</c-> <c- p>][</c-> <c- n>txType</c-> <c- p>]</c->
 <c- p>}</c->
</pre>
   <p>where the tables Tx_Type_In_Set_Inter and Tx_Type_In_Set_Intra are specified as follows:</p>
<pre class="language-c highlight"><c- n>Tx_Type_In_Set_Intra</c-><c- p>[</c-> <c- n>TX_SET_TYPES_INTRA</c-> <c- p>][</c-> <c- n>TX_TYPES</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>},</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>},</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>}</c->
<c- p>}</c->

<c- n>Tx_Type_In_Set_Inter</c-><c- p>[</c-> <c- n>TX_SET_TYPES_INTER</c-> <c- p>][</c-> <c- n>TX_TYPES</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>},</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c->
  <c- p>},</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>},</c->
  <c- p>{</c->
    <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.41" id="get_scan_function"><span class="secno">5.11.41. </span><span class="content">Get scan function</span><a class="self-link" href="#get_scan_function"></a></h4>
<pre class="language-cpp highlight"><c- n>get_mrow_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_4x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_4x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_8x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_8x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_8x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_16x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_16x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mrow_Scan_4x16</c->
     <c- k>return</c-> <c- n>Mrow_Scan_16x4</c->
 <c- p>}</c->
 <c- n>get_mcol_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_4x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_4x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_8x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_8x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_8x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_16x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_16x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Mcol_Scan_4x16</c->
     <c- k>return</c-> <c- n>Mcol_Scan_16x4</c->
 <c- p>}</c->
 <c- n>get_default_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_4x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_4x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_8x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_8x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_8x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_16x8</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_16x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X32</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_16x32</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_32X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_32x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_4X16</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_4x16</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X4</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_16x4</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_8X32</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_8x32</c->
     <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_32X8</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>Default_Scan_32x8</c->
     <c- k>return</c-> <c- n>Default_Scan_32x32</c->
 <c- p>}</c->
 <c- n>get_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_16X64</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>Default_Scan_16x32</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSz</c-> <c- o>==</c-> <c- n>TX_64X16</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>Default_Scan_32x16</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>Tx_Size_Sqr_Up</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>==</c-> <c- n>TX_64X64</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>Default_Scan_32x32</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>IDTX</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>get_default_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- p>}</c->
     \ <c- n>preferRow</c-> <c- o>=</c-> <c- p>(</c-> <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>V_DCT</c-> \
                   \ <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>V_ADST</c-> \
                   <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>V_FLIPADST</c-> <c- p>)</c->
     \ <c- n>preferCol</c-> <c- o>=</c-> <c- p>(</c-> <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>H_DCT</c-> \
                   \ <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>H_ADST</c-> \
                   <c- n>PlaneTxType</c-> <c- o>==</c-> <c- n>H_FLIPADST</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>preferRow</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>get_mrow_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>preferCol</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>get_mcol_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>get_default_scan</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.42" id="intra_angle_info_luma_syntax"><span class="secno">5.11.42. </span><span class="content">Intra angle info luma syntax</span><a class="self-link" href="#intra_angle_info_luma_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>intra_angle_info_y</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>AngleDeltaY</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>></c->\<c- o>=</c-> <c- n>BLOCK_8X8</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>is_directional_mode</c-><c- p>(</c-> <c- n>YMode</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>angle_delta_y</c->
             <c- n>AngleDeltaY</c-> <c- o>=</c-> <c- n>angle_delta_y</c-> <c- o>-</c-> <c- n>MAX_ANGLE_DELTA</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.43" id="intra_angle_info_chroma_syntax"><span class="secno">5.11.43. </span><span class="content">Intra angle info chroma syntax</span><a class="self-link" href="#intra_angle_info_chroma_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>intra_angle_info_uv</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>AngleDeltaUV</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>MiSize</c-> <c- o>></c->\<c- o>=</c-> <c- n>BLOCK_8X8</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>is_directional_mode</c-><c- p>(</c-> <c- n>UVMode</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>angle_delta_uv</c->
             <c- n>AngleDeltaUV</c-> <c- o>=</c-> <c- n>angle_delta_uv</c-> <c- o>-</c-> <c- n>MAX_ANGLE_DELTA</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.44" id="is_directional_mode_function"><span class="secno">5.11.44. </span><span class="content">Is directional mode function</span><a class="self-link" href="#is_directional_mode_function"></a></h4>
<pre class="language-cpp highlight"><c- n>is_directional_mode</c-><c- p>(</c-> <c- n>mode</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- p>(</c-> <c- n>mode</c-> <c- o>></c->\<c- o>=</c-> <c- n>V_PRED</c-> <c- p>)</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-> <c- n>mode</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>D67_PRED</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- mi>1</c->
     <c- p>}</c->
     <c- k>return</c-> <c- mi>0</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.45" id="read_cfl_alphas_syntax"><span class="secno">5.11.45. </span><span class="content">Read CFL alphas syntax</span><a class="self-link" href="#read_cfl_alphas_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_cfl_alphas</c-><c- p>()</c-> <c- p>{</c->
      <c- n>S</c-><c- p>()</c-> <c- n>cfl_alpha_signs</c->
     <c- n>signU</c-> <c- o>=</c-> <c- p>(</c-><c- n>cfl_alpha_signs</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>/</c-> <c- mi>3</c->
     <c- n>signV</c-> <c- o>=</c-> <c- p>(</c-><c- n>cfl_alpha_signs</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>%</c-> <c- mi>3</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>signU</c-> <c- o>!=</c-> <c- n>CFL_SIGN_ZERO</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>cfl_alpha_u</c->
         <c- n>CflAlphaU</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>cfl_alpha_u</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>signU</c-> <c- o>==</c-> <c- n>CFL_SIGN_NEG</c-> <c- p>)</c->
             <c- n>CflAlphaU</c-> <c- o>=</c-> <c- o>-</c-><c- n>CflAlphaU</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
       <c- n>CflAlphaU</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>signV</c-> <c- o>!=</c-> <c- n>CFL_SIGN_ZERO</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>cfl_alpha_v</c->
         <c- n>CflAlphaV</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>+</c-> <c- n>cfl_alpha_v</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>signV</c-> <c- o>==</c-> <c- n>CFL_SIGN_NEG</c-> <c- p>)</c->
             <c- n>CflAlphaV</c-> <c- o>=</c-> <c- o>-</c-><c- n>CflAlphaV</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
       <c- n>CflAlphaV</c-> <c- o>=</c-> <c- mi>0</c->
     <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.46" id="palette_mode_info_syntax"><span class="secno">5.11.46. </span><span class="content">Palette mode info syntax</span><a class="self-link" href="#palette_mode_info_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>palette_mode_info</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>bsizeCtx</c-> <c- o>=</c-> <c- n>Mi_Width_Log2</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>+</c-> <c- n>Mi_Height_Log2</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c-> <c- o>-</c-> <c- mi>2</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>YMode</c-> <c- o>==</c-> <c- n>DC_PRED</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>has_palette_y</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>has_palette_y</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>palette_size_y_minus_2</c->
             <c- n>PaletteSizeY</c-> <c- o>=</c-> <c- n>palette_size_y_minus_2</c-> <c- o>+</c-> <c- mi>2</c->
             <c- n>cacheN</c-> <c- o>=</c-> <c- n>get_palette_cache</c-><c- p>(</c-> <c- mi>0</c-> <c- p>)</c->
             <c- n>idx</c-> <c- o>=</c-> <c- mi>0</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>cacheN</c-> <c- o>&amp;&amp;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeY</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>use_palette_color_cache_y</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>use_palette_color_cache_y</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PaletteCache</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                     <c- n>idx</c-><c- o>++</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeY</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- n>BitDepth</c-><c- p>)</c-> <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c->
                 <c- n>idx</c-><c- o>++</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeY</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>minBits</c-> <c- o>=</c-> <c- n>BitDepth</c-> <c- o>-</c-> <c- mi>3</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>palette_num_extra_bits_y</c->
                 <c- n>paletteBits</c-> <c- o>=</c-> <c- n>minBits</c-> <c- o>+</c-> <c- n>palette_num_extra_bits_y</c->
             <c- p>}</c->
             <c- k>while</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeY</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- n>paletteBits</c-><c- p>)</c-> <c- n>palette_delta_y</c->
                 <c- n>palette_delta_y</c-><c- o>++</c->
                 <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>=</c->
                           <c- n>Clip1</c-><c- p>(</c-> <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>idx</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>+</c->
                                  <c- n>palette_delta_y</c-> <c- p>)</c->
                 <c- n>range</c-> <c- o>=</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>BitDepth</c-> <c- p>)</c-> <c- o>-</c-> <c- n>palette_colors_y</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>-</c-> <c- mi>1</c->
                 <c- n>paletteBits</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>paletteBits</c-><c- p>,</c-> <c- n>CeilLog2</c-><c- p>(</c-> <c- n>range</c-> <c- p>)</c-> <c- p>)</c->
                 <c- n>idx</c-><c- o>++</c->
             <c- p>}</c->
             <c- n>sort</c-><c- p>(</c-> <c- n>palette_colors_y</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- n>PaletteSizeY</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>HasChroma</c-> <c- o>&amp;&amp;</c-> <c- n>UVMode</c-> <c- o>==</c-> <c- n>DC_PRED</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>has_palette_uv</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>has_palette_uv</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>palette_size_uv_minus_2</c->
             <c- n>PaletteSizeUV</c-> <c- o>=</c-> <c- n>palette_size_uv_minus_2</c-> <c- o>+</c-> <c- mi>2</c->
             <c- n>cacheN</c-> <c- o>=</c-> <c- n>get_palette_cache</c-><c- p>(</c-> <c- mi>1</c-> <c- p>)</c->
             <c- n>idx</c-> <c- o>=</c-> <c- mi>0</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>cacheN</c-> <c- o>&amp;&amp;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>use_palette_color_cache_u</c->
                 <c- k>if</c-> <c- p>(</c-> <c- n>use_palette_color_cache_u</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>=</c-> <c- n>PaletteCache</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
                     <c- n>idx</c-><c- o>++</c->
                 <c- p>}</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- n>BitDepth</c-><c- p>)</c-> <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c->
                 <c- n>idx</c-><c- o>++</c->
             <c- p>}</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>minBits</c-> <c- o>=</c-> <c- n>BitDepth</c-> <c- o>-</c-> <c- mi>3</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>palette_num_extra_bits_u</c->
                 <c- n>paletteBits</c-> <c- o>=</c-> <c- n>minBits</c-> <c- o>+</c-> <c- n>palette_num_extra_bits_u</c->
             <c- p>}</c->
             <c- k>while</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c-> <c- p>{</c->
                  <c- n>L</c-><c- p>(</c-><c- n>paletteBits</c-><c- p>)</c-> <c- n>palette_delta_u</c->
                 <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>=</c->
                           <c- n>Clip1</c-><c- p>(</c-> <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>idx</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>+</c->
                                  <c- n>palette_delta_u</c-> <c- p>)</c->
                 <c- n>range</c-> <c- o>=</c-> <c- p>(</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>BitDepth</c-> <c- p>)</c-> <c- o>-</c-> <c- n>palette_colors_u</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c->
                 <c- n>paletteBits</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>paletteBits</c-><c- p>,</c-> <c- n>CeilLog2</c-><c- p>(</c-> <c- n>range</c-> <c- p>)</c-> <c- p>)</c->
                 <c- n>idx</c-><c- o>++</c->
             <c- p>}</c->
             <c- n>sort</c-><c- p>(</c-> <c- n>palette_colors_u</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- n>PaletteSizeUV</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c->
              <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>delta_encode_palette_colors_v</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>delta_encode_palette_colors_v</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>minBits</c-> <c- o>=</c-> <c- n>BitDepth</c-> <c- o>-</c-> <c- mi>4</c->
                 <c- n>maxVal</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>BitDepth</c->
                  <c- n>L</c-><c- p>(</c-><c- mi>2</c-><c- p>)</c-> <c- n>palette_num_extra_bits_v</c->
                 <c- n>paletteBits</c-> <c- o>=</c-> <c- n>minBits</c-> <c- o>+</c-> <c- n>palette_num_extra_bits_v</c->
                  <c- n>L</c-><c- p>(</c-><c- n>BitDepth</c-><c- p>)</c-> <c- n>palette_colors_v</c-><c- p>[</c-> <c- mi>0</c-> <c- p>]</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-><c- p>;</c-> <c- n>idx</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>L</c-><c- p>(</c-><c- n>paletteBits</c-><c- p>)</c-> <c- n>palette_delta_v</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>palette_delta_v</c-> <c- p>)</c-> <c- p>{</c->
                          <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>palette_delta_sign_bit_v</c->
                         <c- k>if</c-> <c- p>(</c-> <c- n>palette_delta_sign_bit_v</c-> <c- p>)</c-> <c- p>{</c->
                             <c- n>palette_delta_v</c-> <c- o>=</c-> <c- o>-</c-><c- n>palette_delta_v</c->
                         <c- p>}</c->
                     <c- p>}</c->
                     <c- n>val</c-> <c- o>=</c-> <c- n>palette_colors_v</c-><c- p>[</c-> <c- n>idx</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c-> <c- o>+</c-> <c- n>palette_delta_v</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>val</c-> <c- o>&lt;</c-> <c- mi>0</c-> <c- p>)</c-> <c- n>val</c-> <c- o>+=</c-> <c- n>maxVal</c->
                     <c- k>if</c-> <c- p>(</c-> <c- n>val</c-> <c- o>></c->\<c- o>=</c-> <c- n>maxVal</c-> <c- p>)</c-> <c- n>val</c-> <c- o>-=</c-> <c- n>maxVal</c->
                     <c- n>palette_colors_v</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c-> <c- o>=</c-> <c- n>Clip1</c-><c- p>(</c-> <c- n>val</c-> <c- p>)</c->
                 <c- p>}</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>idx</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>idx</c-> <c- o>&lt;</c-> <c- n>PaletteSizeUV</c-><c- p>;</c-> <c- n>idx</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                      <c- n>L</c-><c- p>(</c-><c- n>BitDepth</c-><c- p>)</c-> <c- n>palette_colors_v</c-><c- p>[</c-> <c- n>idx</c-> <c- p>]</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>The function sort( arr, i1, i2 ) sorts a subarray of the array arr in-place into
ascending order. The subarray to be sorted is between indices i1 and i2
inclusive.</p>
   <p><strong>Note:</strong> The palette colors are generated in ascending order. The palette cache
is also in ascending order. This means that the sort function can be replaced in
implementations by a merge of two sorted lists.
{:.alert .alert-info }</p>
   <p>where the function get_palette_cache, which merges the above and left palettes
to form a cache, is specified as follows:</p>
<pre class="language-cpp highlight"><c- n>get_palette_cache</c-><c- p>(</c-> <c- n>plane</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>aboveN</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- p>(</c-> <c- n>MiRow</c-> <c- o>*</c-> <c- n>MI_SIZE</c-> <c- p>)</c-> <c- o>%</c-> <c- mi>64</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>aboveN</c-> <c- o>=</c-> <c- n>PaletteSizes</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>]</c->
     <c- p>}</c->
     <c- n>leftN</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>AvailL</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>leftN</c-> <c- o>=</c-> <c- n>PaletteSizes</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
     <c- p>}</c->
     <c- n>aboveIdx</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>leftIdx</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>n</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>while</c-> <c- p>(</c-> <c- n>aboveIdx</c-> <c- o>&lt;</c-> <c- n>aboveN</c->  <c- o>&amp;&amp;</c-> <c- n>leftIdx</c-> <c- o>&lt;</c-> <c- n>leftN</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>aboveC</c-> <c- o>=</c-> <c- n>PaletteColors</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>][</c-> <c- n>aboveIdx</c-> <c- p>]</c->
         <c- n>leftC</c-> <c- o>=</c-> <c- n>PaletteColors</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>leftIdx</c-> <c- p>]</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>leftC</c-> <c- o>&lt;</c-> <c- n>aboveC</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> \
                 <c- n>PaletteCache</c-><c- p>[</c-> <c- n>n</c-> <c- p>]</c-> <c- o>=</c-> <c- n>leftC</c->
                 <c- n>n</c-><c- o>++</c->
             <c- p>}</c->
             <c- n>leftIdx</c-><c- o>++</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> \
                 <c- n>PaletteCache</c-><c- p>[</c-> <c- n>n</c-> <c- p>]</c-> <c- o>=</c-> <c- n>aboveC</c->
                 <c- n>n</c-><c- o>++</c->
             <c- p>}</c->
             <c- n>aboveIdx</c-><c- o>++</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>leftC</c-> <c- o>==</c-> <c- n>aboveC</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>leftIdx</c-><c- o>++</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>while</c-> <c- p>(</c-> <c- n>aboveIdx</c-> <c- o>&lt;</c-> <c- n>aboveN</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>val</c-> <c- o>=</c-> <c- n>PaletteColors</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- p>][</c-> <c- n>aboveIdx</c-> <c- p>]</c->
         <c- n>aboveIdx</c-><c- o>++</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> \
             <c- n>PaletteCache</c-><c- p>[</c-> <c- n>n</c-> <c- p>]</c-> <c- o>=</c-> <c- n>val</c->
             <c- n>n</c-><c- o>++</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>while</c-> <c- p>(</c-> <c- n>leftIdx</c-> <c- o>&lt;</c-> <c- n>leftN</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>val</c-> <c- o>=</c-> <c- n>PaletteColors</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>MiRow</c-> <c- p>][</c-> <c- n>MiCol</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>leftIdx</c-> <c- p>]</c->
         <c- n>leftIdx</c-><c- o>++</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>n</c-> <c- o>==</c-> <c- mi>0</c-> \
             <c- n>PaletteCache</c-><c- p>[</c-> <c- n>n</c-> <c- p>]</c-> <c- o>=</c-> <c- n>val</c->
             <c- n>n</c-><c- o>++</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>return</c-> <c- n>n</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> get_palette_cache is equivalent to sorting the available palette
colors from above and left together and removing any duplicates.
{:.alert .alert-info }</p>
   <h4 class="heading settled" data-level="5.11.47" id="transform_type_syntax"><span class="secno">5.11.47. </span><span class="content">Transform type syntax</span><a class="self-link" href="#transform_type_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>transform_type</c-><c- p>(</c-> <c- n>x4</c-><c- p>,</c-> <c- n>y4</c-><c- p>,</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>set</c-> <c- o>=</c-> <c- n>get_tx_set</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>set</c-> <c- o>></c-> <c- mi>0</c-> <c- o>&amp;&amp;</c->
          <c- p>(</c-> <c- n>segmentation_enabled</c-> <c- o>?</c-> <c- n>get_qindex</c-><c- p>(</c-> <c- mi>1</c-><c- p>,</c-> <c- n>segment_id</c-> <c- p>)</c-> <c- o>:</c-> <c- n>base_q_idx</c-> <c- p>)</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>inter_tx_type</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>set</c-> <c- o>==</c-> <c- n>TX_SET_INTER_1</c-> <c- p>)</c->
                 <c- n>TxType</c-> <c- o>=</c-> <c- n>Tx_Type_Inter_Inv_Set1</c-><c- p>[</c-> <c- n>inter_tx_type</c-> <c- p>]</c->
             <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>set</c-> <c- o>==</c-> <c- n>TX_SET_INTER_2</c-> <c- p>)</c->
                 <c- n>TxType</c-> <c- o>=</c-> <c- n>Tx_Type_Inter_Inv_Set2</c-><c- p>[</c-> <c- n>inter_tx_type</c-> <c- p>]</c->
             <c- k>else</c->
                 <c- n>TxType</c-> <c- o>=</c-> <c- n>Tx_Type_Inter_Inv_Set3</c-><c- p>[</c-> <c- n>inter_tx_type</c-> <c- p>]</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>S</c-><c- p>()</c-> <c- n>intra_tx_type</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>set</c-> <c- o>==</c-> <c- n>TX_SET_INTRA_1</c-> <c- p>)</c->
                 <c- n>TxType</c-> <c- o>=</c-> <c- n>Tx_Type_Intra_Inv_Set1</c-><c- p>[</c-> <c- n>intra_tx_type</c-> <c- p>]</c->
             <c- k>else</c->
                 <c- n>TxType</c-> <c- o>=</c-> <c- n>Tx_Type_Intra_Inv_Set2</c-><c- p>[</c-> <c- n>intra_tx_type</c-> <c- p>]</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- n>TxType</c-> <c- o>=</c-> <c- n>DCT_DCT</c->
     <c- p>}</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- n>Tx_Width</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c-> <c- p>);</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- p>(</c-> <c- n>Tx_Height</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c-> <c- o>>></c-> <c- mi>2</c-> <c- p>);</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>TxTypes</c-><c- p>[</c-> <c- n>y4</c-> <c- o>+</c-> <c- n>j</c-> <c- p>][</c-> <c- n>x4</c-> <c- o>+</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>TxType</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where the inversion tables used in the function are specified as follows:</p>
<pre class="language-c highlight"><c- n>Tx_Type_Intra_Inv_Set1</c-><c- p>[</c-> <c- mi>7</c-> <c- p>]</c->  <c- o>=</c-> <c- p>{</c-> <c- n>IDTX</c-><c- p>,</c-> <c- n>DCT_DCT</c-><c- p>,</c-> <c- n>V_DCT</c-><c- p>,</c-> <c- n>H_DCT</c-><c- p>,</c-> <c- n>ADST_ADST</c-><c- p>,</c-> <c- n>ADST_DCT</c-><c- p>,</c-> <c- n>DCT_ADST</c-> <c- p>}</c->
<c- n>Tx_Type_Intra_Inv_Set2</c-><c- p>[</c-> <c- mi>5</c-> <c- p>]</c->  <c- o>=</c-> <c- p>{</c-> <c- n>IDTX</c-><c- p>,</c-> <c- n>DCT_DCT</c-><c- p>,</c-> <c- n>ADST_ADST</c-><c- p>,</c-> <c- n>ADST_DCT</c-><c- p>,</c-> <c- n>DCT_ADST</c-> <c- p>}</c->
<c- n>Tx_Type_Inter_Inv_Set1</c-><c- p>[</c-> <c- mi>16</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- n>IDTX</c-><c- p>,</c-> <c- n>V_DCT</c-><c- p>,</c-> <c- n>H_DCT</c-><c- p>,</c-> <c- n>V_ADST</c-><c- p>,</c-> <c- n>H_ADST</c-><c- p>,</c-> <c- n>V_FLIPADST</c-><c- p>,</c-> <c- n>H_FLIPADST</c-><c- p>,</c->
                                <c- n>DCT_DCT</c-><c- p>,</c-> <c- n>ADST_DCT</c-><c- p>,</c-> <c- n>DCT_ADST</c-><c- p>,</c-> <c- n>FLIPADST_DCT</c-><c- p>,</c-> <c- n>DCT_FLIPADST</c-><c- p>,</c-> <c- n>ADST_ADST</c-><c- p>,</c->
                                <c- n>FLIPADST_FLIPADST</c-><c- p>,</c-> <c- n>ADST_FLIPADST</c-><c- p>,</c-> <c- n>FLIPADST_ADST</c-> <c- p>}</c->
<c- n>Tx_Type_Inter_Inv_Set2</c-><c- p>[</c-> <c- mi>12</c-> <c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- n>IDTX</c-><c- p>,</c-> <c- n>V_DCT</c-><c- p>,</c-> <c- n>H_DCT</c-><c- p>,</c-> <c- n>DCT_DCT</c-><c- p>,</c-> <c- n>ADST_DCT</c-><c- p>,</c-> <c- n>DCT_ADST</c-><c- p>,</c-> <c- n>FLIPADST_DCT</c-><c- p>,</c->
                                 <c- n>DCT_FLIPADST</c-><c- p>,</c-> <c- n>ADST_ADST</c-><c- p>,</c-> <c- n>FLIPADST_FLIPADST</c-><c- p>,</c-> <c- n>ADST_FLIPADST</c-><c- p>,</c->
                                 <c- n>FLIPADST_ADST</c-> <c- p>}</c->
<c- n>Tx_Type_Inter_Inv_Set3</c-><c- p>[</c-> <c- mi>2</c-> <c- p>]</c->  <c- o>=</c-> <c- p>{</c-> <c- n>IDTX</c-><c- p>,</c-> <c- n>DCT_DCT</c-> <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.48" id="get_transform_set_function"><span class="secno">5.11.48. </span><span class="content">Get transform set function</span><a class="self-link" href="#get_transform_set_function"></a></h4>
<pre class="language-cpp highlight"><c- n>get_tx_set</c-><c- p>(</c-> <c- n>txSz</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>txSzSqr</c-> <c- o>=</c-> <c- n>Tx_Size_Sqr</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
     <c- n>txSzSqrUp</c-> <c- o>=</c-> <c- n>Tx_Size_Sqr_Up</c-><c- p>[</c-> <c- n>txSz</c-> <c- p>]</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>txSzSqrUp</c-> <c- o>></c-> <c- n>TX_32X32</c-> <c- p>)</c->
         <c- k>return</c-> <c- n>TX_SET_DCTONLY</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>is_inter</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>reduced_tx_set</c-> \
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSzSqr</c-> <c- o>==</c-> <c- n>TX_16X16</c-> <c- p>)</c-> <c- k>return</c-> <c- n>TX_SET_INTER_2</c->
         <c- k>return</c-> <c- n>TX_SET_INTER_1</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>txSzSqrUp</c-> <c- o>==</c-> <c- n>TX_32X32</c-> <c- p>)</c-> <c- k>return</c-> <c- n>TX_SET_DCTONLY</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>reduced_tx_set</c-> <c- p>)</c-> <c- k>return</c-> <c- n>TX_SET_INTRA_2</c->
         <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>txSzSqr</c-> <c- o>==</c-> <c- n>TX_16X16</c-> <c- p>)</c-> <c- k>return</c-> <c- n>TX_SET_INTRA_2</c->
         <c- k>return</c-> <c- n>TX_SET_INTRA_1</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.49" id="palette_tokens_syntax"><span class="secno">5.11.49. </span><span class="content">Palette tokens syntax</span><a class="self-link" href="#palette_tokens_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>palette_tokens</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>blockHeight</c-> <c- o>=</c-> <c- n>Block_Height</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>blockWidth</c-> <c- o>=</c-> <c- n>Block_Width</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>onscreenHeight</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>blockHeight</c-><c- p>,</c-> <c- p>(</c-><c- n>MiRows</c-> <c- o>-</c-> <c- n>MiRow</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c-> <c- p>)</c->
     <c- n>onscreenWidth</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>blockWidth</c-><c- p>,</c-> <c- p>(</c-><c- n>MiCols</c-> <c- o>-</c-> <c- n>MiCol</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>PaletteSizeY</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>NS</c-><c- p>(</c-><c- n>PaletteSizeY</c-><c- p>)</c-> <c- n>color_index_map_y</c->
         <c- n>ColorMapY</c-><c- p>[</c-><c- mi>0</c-><c- p>][</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>color_index_map_y</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>onscreenHeight</c-> <c- o>+</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>i</c-><c- p>,</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>);</c->
                       <c- n>j</c-> <c- o>></c->\<c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>i</c-> <c- o>-</c-> <c- n>onscreenHeight</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>);</c-> <c- n>j</c-><c- o>--</c->  <c- p>)</c-> <c- p>{</c->
                 <c- n>get_palette_color_context</c-><c- p>(</c->
                     <c- n>ColorMapY</c-><c- p>,</c-> <c- p>(</c-> <c- n>i</c-> <c- o>-</c-> <c- n>j</c-> <c- p>),</c-> <c- n>j</c-><c- p>,</c-> <c- n>PaletteSizeY</c-> <c- p>)</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>palette_color_idx_y</c->
                 <c- n>ColorMapY</c-><c- p>[</c-> <c- n>i</c-> <c- o>-</c-> <c- n>j</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorOrder</c-><c- p>[</c-> <c- n>palette_color_idx_y</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>onscreenHeight</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>onscreenWidth</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>blockWidth</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>ColorMapY</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorMapY</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>onscreenHeight</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>blockHeight</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>blockWidth</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>ColorMapY</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorMapY</c-><c- p>[</c-> <c- n>onscreenHeight</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>NS</c-><c- p>(</c-><c- n>PaletteSizeUV</c-><c- p>)</c-> <c- n>color_index_map_uv</c->
         <c- n>ColorMapUV</c-><c- p>[</c-><c- mi>0</c-><c- p>][</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- n>color_index_map_uv</c->
         <c- n>blockHeight</c-> <c- o>=</c-> <c- n>blockHeight</c-> <c- o>>></c-> <c- n>subsampling_y</c->
         <c- n>blockWidth</c-> <c- o>=</c-> <c- n>blockWidth</c-> <c- o>>></c-> <c- n>subsampling_x</c->
         <c- n>onscreenHeight</c-> <c- o>=</c-> <c- n>onscreenHeight</c-> <c- o>>></c-> <c- n>subsampling_y</c->
         <c- n>onscreenWidth</c-> <c- o>=</c-> <c- n>onscreenWidth</c-> <c- o>>></c-> <c- n>subsampling_x</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>blockWidth</c-> <c- o>&lt;</c-> <c- mi>4</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>blockWidth</c-> <c- o>+=</c-> <c- mi>2</c->
             <c- n>onscreenWidth</c-> <c- o>+=</c-> <c- mi>2</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>blockHeight</c-> <c- o>&lt;</c-> <c- mi>4</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>blockHeight</c-> <c- o>+=</c-> <c- mi>2</c->
             <c- n>onscreenHeight</c-> <c- o>+=</c-> <c- mi>2</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>onscreenHeight</c-> <c- o>+</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>i</c-><c- p>,</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>);</c->
                       <c- n>j</c-> <c- o>></c->\<c- o>=</c-> <c- n>Max</c-><c- p>(</c-> <c- mi>0</c-><c- p>,</c-> <c- n>i</c-> <c- o>-</c-> <c- n>onscreenHeight</c-> <c- o>+</c-> <c- mi>1</c-> <c- p>);</c-> <c- n>j</c-><c- o>--</c->  <c- p>)</c-> <c- p>{</c->
                 <c- n>get_palette_color_context</c-><c- p>(</c->
                     <c- n>ColorMapUV</c-><c- p>,</c-> <c- p>(</c-> <c- n>i</c-> <c- o>-</c-> <c- n>j</c-> <c- p>),</c-> <c- n>j</c-><c- p>,</c-> <c- n>PaletteSizeUV</c-> <c- p>)</c->
                  <c- n>S</c-><c- p>()</c-> <c- n>palette_color_idx_uv</c->
                 <c- n>ColorMapUV</c-><c- p>[</c-> <c- n>i</c-> <c- o>-</c-> <c- n>j</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorOrder</c-><c- p>[</c-> <c- n>palette_color_idx_uv</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>onscreenHeight</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>onscreenWidth</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>blockWidth</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>ColorMapUV</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorMapUV</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>onscreenWidth</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>onscreenHeight</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>blockHeight</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>blockWidth</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>ColorMapUV</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorMapUV</c-><c- p>[</c-> <c- n>onscreenHeight</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.50" id="palette_color_context_function"><span class="secno">5.11.50. </span><span class="content">Palette color context function</span><a class="self-link" href="#palette_color_context_function"></a></h4>
<pre class="language-cpp highlight"><c- n>get_palette_color_context</c-><c- p>(</c-> <c- n>colorMap</c-><c- p>,</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>n</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>PALETTE_COLORS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>scores</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
         <c- n>ColorOrder</c-><c- p>[</c-><c- n>i</c-><c- p>]</c-> <c- o>=</c-> <c- n>i</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>c</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>neighbor</c-> <c- o>=</c-> <c- n>colorMap</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
         <c- n>scores</c-><c- p>[</c-> <c- n>neighbor</c-> <c- p>]</c-> <c- o>+=</c-> <c- mi>2</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- p>(</c-> <c- n>r</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- o>&amp;&amp;</c-> <c- p>(</c-> <c- n>c</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>neighbor</c-> <c- o>=</c-> <c- n>colorMap</c-><c- p>[</c-> <c- n>r</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>c</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
         <c- n>scores</c-><c- p>[</c-> <c- n>neighbor</c-> <c- p>]</c-> <c- o>+=</c-> <c- mi>1</c->
     <c- p>}</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>r</c-> <c- o>></c-> <c- mi>0</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>neighbor</c-> <c- o>=</c-> <c- n>colorMap</c-><c- p>[</c-> <c- n>r</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>][</c-> <c- n>c</c-> <c- p>]</c->
         <c- n>scores</c-><c- p>[</c-> <c- n>neighbor</c-> <c- p>]</c-> <c- o>+=</c-> <c- mi>2</c->
     <c- p>}</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>PALETTE_NUM_NEIGHBORS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>maxScore</c-> <c- o>=</c-> <c- n>scores</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
         <c- n>maxIdx</c-> <c- o>=</c-> <c- n>i</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>i</c-> <c- o>+</c-> <c- mi>1</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>n</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>scores</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c-> <c- o>></c-> <c- n>maxScore</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>maxScore</c-> <c- o>=</c-> <c- n>scores</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                 <c- n>maxIdx</c-> <c- o>=</c-> <c- n>j</c->
             <c- p>}</c->
         <c- p>}</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>maxIdx</c-> <c- o>!=</c-> <c- n>i</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>maxScore</c-> <c- o>=</c-> <c- n>scores</c-><c- p>[</c-> <c- n>maxIdx</c-> <c- p>]</c->
             <c- n>maxColorOrder</c-> <c- o>=</c-> <c- n>ColorOrder</c-><c- p>[</c-> <c- n>maxIdx</c-> <c- p>]</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>k</c-> <c- o>=</c-> <c- n>maxIdx</c-><c- p>;</c-> <c- n>k</c-> <c- o>></c-> <c- n>i</c-><c- p>;</c-> <c- n>k</c-><c- o>--</c->  <c- p>)</c-> <c- p>{</c->
                 <c- n>scores</c-><c- p>[</c-> <c- n>k</c-> <c- p>]</c-> <c- o>=</c-> <c- n>scores</c-><c- p>[</c-> <c- n>k</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
                 <c- n>ColorOrder</c-><c- p>[</c-> <c- n>k</c-> <c- p>]</c-> <c- o>=</c-> <c- n>ColorOrder</c-><c- p>[</c-> <c- n>k</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>]</c->
             <c- p>}</c->
             <c- n>scores</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>maxScore</c->
             <c- n>ColorOrder</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>maxColorOrder</c->
         <c- p>}</c->
     <c- p>}</c->
     <c- n>ColorContextHash</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>PALETTE_NUM_NEIGHBORS</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>ColorContextHash</c-> <c- o>+=</c-> <c- n>scores</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c-> <c- o>*</c-> <c- n>Palette_Color_Hash_Multipliers</c-><c- p>[</c-> <c- n>i</c-> <c- p>]</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.51" id="is_inside_function"><span class="secno">5.11.51. </span><span class="content">Is inside function</span><a class="self-link" href="#is_inside_function"></a></h4>
   <p>is_inside determines whether a candidate position is inside the current tile.</p>
<pre class="language-cpp highlight"><c- n>is_inside</c-><c- p>(</c-> <c- n>candidateR</c-><c- p>,</c-> <c- n>candidateC</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>return</c-> <c- p>(</c-> <c- n>candidateC</c-> <c- o>></c->\<c- o>=</c-> <c- n>MiColStart</c-> <c- o>&amp;&amp;</c->
              <c- n>candidateC</c-> <c- o>&lt;</c-> <c- n>MiColEnd</c-> <c- o>&amp;&amp;</c->
              <c- n>candidateR</c-> <c- o>></c->\<c- o>=</c-> <c- n>MiRowStart</c-> <c- o>&amp;&amp;</c->
              <c- n>candidateR</c-> <c- o>&lt;</c-> <c- n>MiRowEnd</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.52" id="is_inside_filter_region_function"><span class="secno">5.11.52. </span><span class="content">Is inside filter region function</span><a class="self-link" href="#is_inside_filter_region_function"></a></h4>
   <p>is_inside_filter_region determines whether a candidate position is inside the region that is being used for CDEF filtering.</p>
<pre class="language-cpp highlight"><c- n>is_inside_filter_region</c-><c- p>(</c-> <c- n>candidateR</c-><c- p>,</c-> <c- n>candidateC</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>colStart</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>colEnd</c-> <c- o>=</c-> <c- n>MiCols</c->
     <c- n>rowStart</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>rowEnd</c-> <c- o>=</c-> <c- n>MiRows</c->
     <c- k>return</c-> <c- p>(</c-><c- n>candidateC</c-> <c- o>></c->\<c- o>=</c-> <c- n>colStart</c-> <c- o>&amp;&amp;</c->
             <c- n>candidateC</c-> <c- o>&lt;</c-> <c- n>colEnd</c-> <c- o>&amp;&amp;</c->
             <c- n>candidateR</c-> <c- o>></c->\<c- o>=</c-> <c- n>rowStart</c-> <c- o>&amp;&amp;</c->
             <c- n>candidateR</c-> <c- o>&lt;</c-> <c- n>rowEnd</c-><c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.53" id="clamp_mv_row_function"><span class="secno">5.11.53. </span><span class="content">Clamp MV row function</span><a class="self-link" href="#clamp_mv_row_function"></a></h4>
<pre class="language-cpp highlight"><c- n>clamp_mv_row</c-><c- p>(</c-> <c- n>mvec</c-><c- p>,</c-> <c- n>border</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>bh4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>mbToTopEdge</c-> <c- o>=</c-> <c- o>-</c-><c- p>((</c-><c- n>MiRow</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>*</c-> <c- mi>8</c-><c- p>)</c->
     <c- n>mbToBottomEdge</c-> <c- o>=</c-> <c- p>((</c-><c- n>MiRows</c-> <c- o>-</c-> <c- n>bh4</c-> <c- o>-</c-> <c- n>MiRow</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>*</c-> <c- mi>8</c->
     <c- k>return</c-> <c- n>Clip3</c-><c- p>(</c-> <c- n>mbToTopEdge</c-> <c- o>-</c-> <c- n>border</c-><c- p>,</c-> <c- n>mbToBottomEdge</c-> <c- o>+</c-> <c- n>border</c-><c- p>,</c-> <c- n>mvec</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.54" id="clamp_mv_col_function"><span class="secno">5.11.54. </span><span class="content">Clamp MV col function</span><a class="self-link" href="#clamp_mv_col_function"></a></h4>
<pre class="language-cpp highlight"><c- n>clamp_mv_col</c-><c- p>(</c-> <c- n>mvec</c-><c- p>,</c-> <c- n>border</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>bw4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
     <c- n>mbToLeftEdge</c-> <c- o>=</c-> <c- o>-</c-><c- p>((</c-><c- n>MiCol</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>*</c-> <c- mi>8</c-><c- p>)</c->
     <c- n>mbToRightEdge</c-> <c- o>=</c-> <c- p>((</c-><c- n>MiCols</c-> <c- o>-</c-> <c- n>bw4</c-> <c- o>-</c-> <c- n>MiCol</c-><c- p>)</c-> <c- o>*</c-> <c- n>MI_SIZE</c-><c- p>)</c-> <c- o>*</c-> <c- mi>8</c->
     <c- k>return</c-> <c- n>Clip3</c-><c- p>(</c-> <c- n>mbToLeftEdge</c-> <c- o>-</c-> <c- n>border</c-><c- p>,</c-> <c- n>mbToRightEdge</c-> <c- o>+</c-> <c- n>border</c-><c- p>,</c-> <c- n>mvec</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.55" id="clear_cdef_function"><span class="secno">5.11.55. </span><span class="content">Clear CDEF function</span><a class="self-link" href="#clear_cdef_function"></a></h4>
<pre class="language-cpp highlight"><c- n>clear_cdef</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>use_128x128_superblock</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>cdefSize4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>BLOCK_64X64</c-> <c- p>]</c->
         <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>cdefSize4</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>cdefSize4</c-><c- p>][</c-> <c- n>c</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
         <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- o>+</c-> <c- n>cdefSize4</c-><c- p>][</c-> <c- n>c</c-> <c- o>+</c-> <c- n>cdefSize4</c-> <c- p>]</c-> <c- o>=</c-> <c- mi>-1</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.56" id="read_cdef_syntax"><span class="secno">5.11.56. </span><span class="content">Read CDEF syntax</span><a class="self-link" href="#read_cdef_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_cdef</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>skip</c-> \
         <c- k>return</c->
     <c- p>}</c->
     <c- n>cdefSize4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>BLOCK_64X64</c-> <c- p>]</c->
     <c- n>cdefMask4</c-> <c- o>=</c-> <c- o>~</c-><c- p>(</c-><c- n>cdefSize4</c-> <c- o>-</c-> <c- mi>1</c-><c- p>)</c->
     <c- n>r</c-> <c- o>=</c-> <c- n>MiRow</c-> <c- o>&amp;</c-> <c- n>cdefMask4</c->
     <c- n>c</c-> <c- o>=</c-> <c- n>MiCol</c-> <c- o>&amp;</c-> <c- n>cdefMask4</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- p>]</c-> <c- o>==</c-> <c- mi>-1</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>L</c-><c- p>(</c-><c- n>cdef_bits</c-><c- p>)</c-> <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- p>]</c->
         <c- n>w4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- n>h4</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>MiSize</c-> <c- p>]</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- n>r</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- n>r</c-> <c- o>+</c-> <c- n>h4</c-> <c- p>;</c-> <c- n>i</c-> <c- o>+=</c-> <c- n>cdefSize4</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>c</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- n>c</c-> <c- o>+</c-> <c- n>w4</c-> <c- p>;</c-> <c- n>j</c-> <c- o>+=</c-> <c- n>cdefSize4</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>cdef_idx</c-><c- p>[</c-> <c- n>i</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>cdef_idx</c-><c- p>[</c-> <c- n>r</c-> <c- p>][</c-> <c- n>c</c-> <c- p>]</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.57" id="read_loop_restoration_syntax"><span class="secno">5.11.57. </span><span class="content">Read loop restoration syntax</span><a class="self-link" href="#read_loop_restoration_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_lr</c-><c- p>(</c-> <c- n>r</c-><c- p>,</c-> <c- n>c</c-><c- p>,</c-> <c- n>bSize</c-> <c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>allow_intrabc</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c->
     <c- p>}</c->
     <c- n>w</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_Wide</c-><c- p>[</c-> <c- n>bSize</c-> <c- p>]</c->
     <c- n>h</c-> <c- o>=</c-> <c- n>Num_4x4_Blocks_High</c-><c- p>[</c-> <c- n>bSize</c-> <c- p>]</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>plane</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>plane</c-> <c- o>&lt;</c-> <c- n>NumPlanes</c-><c- p>;</c-> <c- n>plane</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>FrameRestorationType</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c-> <c- o>!=</c-> <c- n>RESTORE_NONE</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>subX</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- mi>0</c-> <c- o>:</c-> <c- n>subsampling_x</c->
             <c- n>subY</c-> <c- o>=</c-> <c- p>(</c-><c- n>plane</c-> <c- o>==</c-> <c- mi>0</c-><c- p>)</c-> <c- o>?</c-> <c- mi>0</c-> <c- o>:</c-> <c- n>subsampling_y</c->
             <c- n>unitSize</c-> <c- o>=</c-> <c- n>LoopRestorationSize</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
             <c- n>unitRows</c-> <c- o>=</c-> <c- n>count_units_in_frame</c-><c- p>(</c-> <c- n>unitSize</c-><c- p>,</c-> <c- n>Round2</c-><c- p>(</c-> <c- n>FrameHeight</c-><c- p>,</c-> <c- n>subY</c-><c- p>)</c-> <c- p>)</c->
             <c- n>unitCols</c-> <c- o>=</c-> <c- n>count_units_in_frame</c-><c- p>(</c-> <c- n>unitSize</c-><c- p>,</c-> <c- n>Round2</c-><c- p>(</c-> <c- n>UpscaledWidth</c-><c- p>,</c-> <c- n>subX</c-><c- p>)</c-> <c- p>)</c->
             <c- n>unitRowStart</c-> <c- o>=</c-> <c- p>(</c-> <c- n>r</c-> <c- o>*</c-> <c- p>(</c-> <c- n>MI_SIZE</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>+</c->
                                       <c- n>unitSize</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>/</c-> <c- n>unitSize</c->
             <c- n>unitRowEnd</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>unitRows</c-><c- p>,</c-> <c- p>(</c-> <c- p>(</c-><c- n>r</c-> <c- o>+</c-> <c- n>h</c-><c- p>)</c-> <c- o>*</c-> <c- p>(</c-> <c- n>MI_SIZE</c-> <c- o>>></c-> <c- n>subY</c-><c- p>)</c-> <c- o>+</c->
                                       <c- n>unitSize</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>/</c-> <c- n>unitSize</c-><c- p>)</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>use_superres</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>numerator</c-> <c- o>=</c-> <c- p>(</c-><c- n>MI_SIZE</c-> <c- o>>></c-> <c- n>subX</c-><c- p>)</c-> <c- o>*</c-> <c- n>SuperresDenom</c->
                 <c- n>denominator</c-> <c- o>=</c-> <c- n>unitSize</c-> <c- o>*</c-> <c- n>SUPERRES_NUM</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>numerator</c-> <c- o>=</c-> <c- n>MI_SIZE</c-> <c- o>>></c-> <c- n>subX</c->
                 <c- n>denominator</c-> <c- o>=</c-> <c- n>unitSize</c->
             <c- p>}</c->
             <c- n>unitColStart</c-> <c- o>=</c-> <c- p>(</c-> <c- n>c</c-> <c- o>*</c-> <c- n>numerator</c-> <c- o>+</c-> <c- n>denominator</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>/</c-> <c- n>denominator</c->
             <c- n>unitColEnd</c-> <c- o>=</c-> <c- n>Min</c-><c- p>(</c-> <c- n>unitCols</c-><c- p>,</c-> <c- p>(</c-> <c- p>(</c-><c- n>c</c-> <c- o>+</c-> <c- n>w</c-><c- p>)</c-> <c- o>*</c-> <c- n>numerator</c-> <c- o>+</c->
                               <c- n>denominator</c-> <c- o>-</c-> <c- mi>1</c-> <c- p>)</c-> <c- o>/</c-> <c- n>denominator</c-><c- p>)</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>unitRow</c-> <c- o>=</c-> <c- n>unitRowStart</c-><c- p>;</c-> <c- n>unitRow</c-> <c- o>&lt;</c-> <c- n>unitRowEnd</c-><c- p>;</c-> <c- n>unitRow</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- k>for</c-> <c- p>(</c-> <c- n>unitCol</c-> <c- o>=</c-> <c- n>unitColStart</c-><c- p>;</c-> <c- n>unitCol</c-> <c- o>&lt;</c-> <c- n>unitColEnd</c-><c- p>;</c-> <c- n>unitCol</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                     <c- n>read_lr_unit</c-><c- p>(</c-><c- n>plane</c-><c- p>,</c-> <c- n>unitRow</c-><c- p>,</c-> <c- n>unitCol</c-><c- p>)</c->
                 <c- p>}</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where count_units_in_frame is a function specified as:</p>
<pre class="language-c highlight"><c- n>count_units_in_frame</c-><c- p>(</c-><c- n>unitSize</c-><c- p>,</c-> <c- n>frameSize</c-><c- p>)</c-> <c- p>{</c->
    <c- k>return</c-> <c- n>Max</c-><c- p>((</c-><c- n>frameSize</c-> <c- o>+</c-> <c- p>(</c-><c- n>unitSize</c-> <c- o>>></c-> <c- mi>1</c-><c- p>))</c-> <c- o>/</c-> <c- n>unitSize</c-><c- p>,</c-> <c- mi>1</c-><c- p>)</c->
<c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.11.58" id="read_loop_restoration_unit_syntax"><span class="secno">5.11.58. </span><span class="content">Read loop restoration unit syntax</span><a class="self-link" href="#read_loop_restoration_unit_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>read_lr_unit</c-><c- p>(</c-><c- n>plane</c-><c- p>,</c-> <c- n>unitRow</c-><c- p>,</c-> <c- n>unitCol</c-><c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>FrameRestorationType</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c-> <c- o>==</c-> <c- n>RESTORE_WIENER</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>use_wiener</c->
         <c- n>restoration_type</c-> <c- o>=</c-> <c- n>use_wiener</c-> <c- o>?</c-> <c- n>RESTORE_WIENER</c-> <c- o>:</c-> <c- n>RESTORE_NONE</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>FrameRestorationType</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c-> <c- o>==</c-> <c- n>RESTORE_SGRPROJ</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>use_sgrproj</c->
         <c- n>restoration_type</c-> <c- o>=</c-> <c- n>use_sgrproj</c-> <c- o>?</c-> <c- n>RESTORE_SGRPROJ</c-> <c- o>:</c-> <c- n>RESTORE_NONE</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          <c- n>S</c-><c- p>()</c-> <c- n>restoration_type</c->
     <c- p>}</c->
     <c- n>LrType</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>unitRow</c-> <c- p>][</c-> <c- n>unitCol</c-> <c- p>]</c-> <c- o>=</c-> <c- n>restoration_type</c->
     <c- k>if</c-> <c- p>(</c-> <c- n>restoration_type</c-> <c- o>==</c-> <c- n>RESTORE_WIENER</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>pass</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>pass</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>pass</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>plane</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>firstCoeff</c-> <c- o>=</c-> <c- mi>1</c->
                 <c- n>LrWiener</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                         <c- p>[</c-> <c- n>unitRow</c-> <c- p>][</c-> <c- n>unitCol</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>][</c-><c- mi>0</c-><c- p>]</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>firstCoeff</c-> <c- o>=</c-> <c- mi>0</c->
             <c- p>}</c->
             <c- k>for</c-> <c- p>(</c-> <c- n>j</c-> <c- o>=</c-> <c- n>firstCoeff</c-><c- p>;</c-> <c- n>j</c-> <c- o>&lt;</c-> <c- mi>3</c-><c- p>;</c-> <c- n>j</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>min</c-> <c- o>=</c-> <c- n>Wiener_Taps_Min</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                 <c- n>max</c-> <c- o>=</c-> <c- n>Wiener_Taps_Max</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                 <c- n>k</c-> <c- o>=</c-> <c- n>Wiener_Taps_K</c-><c- p>[</c-> <c- n>j</c-> <c- p>]</c->
                 <c- n>v</c-> <c- o>=</c-> <c- n>decode_signed_subexp_with_ref_bool</c-><c- p>(</c->
                         <c- n>min</c-><c- p>,</c-> <c- n>max</c-> <c- o>+</c-> <c- mi>1</c-><c- p>,</c-> <c- n>k</c-><c- p>,</c-> <c- n>RefLrWiener</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- p>)</c->
                 <c- n>LrWiener</c-><c- p>[</c-> <c- n>plane</c-> <c- p>]</c->
                         <c- p>[</c-> <c- n>unitRow</c-> <c- p>][</c-> <c- n>unitCol</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>v</c->
                 <c- n>RefLrWiener</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>pass</c-> <c- p>][</c-> <c- n>j</c-> <c- p>]</c-> <c- o>=</c-> <c- n>v</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-> <c- n>restoration_type</c-> <c- o>==</c-> <c- n>RESTORE_SGRPROJ</c-> <c- p>)</c-> <c- p>{</c->
          <c- n>L</c-><c- p>(</c-><c- n>SGRPROJ_PARAMS_BITS</c-><c- p>)</c-> <c- n>lr_sgr_set</c->
         <c- n>LrSgrSet</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>unitRow</c-> <c- p>][</c-> <c- n>unitCol</c-> <c- p>]</c-> <c- o>=</c-> <c- n>lr_sgr_set</c->
         <c- k>for</c-> <c- p>(</c-> <c- n>i</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>i</c-> <c- o>&lt;</c-> <c- mi>2</c-><c- p>;</c-> <c- n>i</c-><c- o>++</c-> <c- p>)</c-> <c- p>{</c->
             <c- n>radius</c-> <c- o>=</c-> <c- n>Sgr_Params</c-><c- p>[</c-> <c- n>lr_sgr_set</c-> <c- p>][</c-> <c- n>i</c-> <c- o>*</c-> <c- mi>2</c-> <c- p>]</c->
             <c- n>min</c-> <c- o>=</c-> <c- n>Sgrproj_Xqd_Min</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
             <c- n>max</c-> <c- o>=</c-> <c- n>Sgrproj_Xqd_Max</c-><c- p>[</c-><c- n>i</c-><c- p>]</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>radius</c-> <c- p>)</c-> <c- p>{</c->
               <c- n>v</c-> <c- o>=</c-> <c- n>decode_signed_subexp_with_ref_bool</c-><c- p>(</c->
                      <c- n>min</c-><c- p>,</c-> <c- n>max</c-> <c- o>+</c-> <c- mi>1</c-><c- p>,</c-> <c- n>SGRPROJ_PRJ_SUBEXP_K</c-><c- p>,</c->
                      <c- n>RefSgrXqd</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>])</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
               <c- n>v</c-> <c- o>=</c-> <c- mi>0</c->
               <c- k>if</c-> <c- p>(</c-> <c- n>i</c-> <c- o>==</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
                 <c- n>v</c-> <c- o>=</c-> <c- n>Clip3</c-><c- p>(</c-> <c- n>min</c-><c- p>,</c-> <c- n>max</c-><c- p>,</c-> <c- p>(</c-><c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>SGRPROJ_PRJ_BITS</c-><c- p>)</c-> <c- o>-</c->
                            <c- n>RefSgrXqd</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- mi>0</c-> <c- p>]</c-> <c- p>)</c->
               <c- p>}</c->
             <c- p>}</c->
             <c- n>LrSgrXqd</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>unitRow</c-> <c- p>][</c-> <c- n>unitCol</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>v</c->
             <c- n>RefSgrXqd</c-><c- p>[</c-> <c- n>plane</c-> <c- p>][</c-> <c- n>i</c-> <c- p>]</c-> <c- o>=</c-> <c- n>v</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p>where Wiener_Taps_Min, Wiener_Taps_Max, ,Wiener_Taps_K, Sgrproj_Xqd_Min, and
Sgrproj_Xqd_Max are constant lookup tables:</p>
<pre class="language-c highlight"><c- n>Wiener_Taps_Min</c-><c- p>[</c-><c- mi>3</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>-5</c-><c- p>,</c-> <c- mi>-23</c-><c- p>,</c-> <c- mi>-17</c-> <c- p>}</c->
<c- n>Wiener_Taps_Max</c-><c- p>[</c-><c- mi>3</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>10</c-><c- p>,</c->   <c- mi>8</c-><c- p>,</c->  <c- mi>46</c-> <c- p>}</c->
<c- n>Wiener_Taps_K</c-><c- p>[</c-><c- mi>3</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-> <c- p>}</c->

<c- n>Sgrproj_Xqd_Min</c-><c- p>[</c-><c- mi>2</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c-> <c- mi>-96</c-><c- p>,</c-> <c- mi>-32</c-> <c- p>}</c->
<c- n>Sgrproj_Xqd_Max</c-><c- p>[</c-><c- mi>2</c-><c- p>]</c-> <c- o>=</c-> <c- p>{</c->  <c- mi>31</c-><c- p>,</c->  <c- mi>95</c-> <c- p>}</c->
</pre>
   <p>Sgr_Params is a constant lookup table defined in [section 7.17.3][] and
decode_signed_subexp_with_ref_bool is a function specified as follows:</p>
<pre class="language-cpp highlight"><c- n>decode_signed_subexp_with_ref_bool</c-><c- p>(</c-> <c- n>low</c-><c- p>,</c-> <c- n>high</c-><c- p>,</c-> <c- n>k</c-><c- p>,</c-> <c- n>r</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>x</c-> <c- o>=</c-> <c- n>decode_unsigned_subexp_with_ref_bool</c-><c- p>(</c-><c- n>high</c-> <c- o>-</c-> <c- n>low</c-><c- p>,</c-> <c- n>k</c-><c- p>,</c-> <c- n>r</c-> <c- o>-</c-> <c- n>low</c-><c- p>)</c->
     <c- k>return</c-> <c- n>x</c-> <c- o>+</c-> <c- n>low</c->
 <c- p>}</c->
 <c- n>decode_unsigned_subexp_with_ref_bool</c-><c- p>(</c-> <c- n>mx</c-><c- p>,</c-> <c- n>k</c-><c- p>,</c-> <c- n>r</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>v</c-> <c- o>=</c-> <c- n>decode_subexp_bool</c-><c- p>(</c-> <c- n>mx</c-><c- p>,</c-> <c- n>k</c-> <c- p>)</c->
     <c- k>if</c-> <c- p>(</c-> <c- p>(</c-><c- n>r</c-> <c- o>&lt;&lt;</c-> <c- mi>1</c-><c- p>)</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>mx</c-> <c- p>)</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>inverse_recenter</c-><c- p>(</c-><c- n>r</c-><c- p>,</c-> <c- n>v</c-><c- p>)</c->
     <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
         <c- k>return</c-> <c- n>mx</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>inverse_recenter</c-><c- p>(</c-><c- n>mx</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>-</c-> <c- n>r</c-><c- p>,</c-> <c- n>v</c-><c- p>)</c->
     <c- p>}</c->
 <c- p>}</c->
 <c- n>decode_subexp_bool</c-><c- p>(</c-> <c- n>numSyms</c-><c- p>,</c-> <c- n>k</c-> <c- p>)</c-> <c- p>{</c->
     <c- n>i</c-> <c- o>=</c-> <c- mi>0</c->
     <c- n>mk</c-> <c- o>=</c-> <c- mi>0</c->
     <c- k>while</c-> <c- p>(</c-> <c- mi>1</c-> <c- p>)</c-> <c- p>{</c->
         <c- n>b2</c-> <c- o>=</c-> <c- n>i</c-> <c- o>?</c-> <c- n>k</c-> <c- o>+</c-> <c- n>i</c-> <c- o>-</c-> <c- mi>1</c-> <c- o>:</c-> <c- n>k</c->
         <c- n>a</c-> <c- o>=</c-> <c- mi>1</c-> <c- o>&lt;&lt;</c-> <c- n>b2</c->
         <c- k>if</c-> <c- p>(</c-> <c- n>numSyms</c-> <c- o>&lt;</c->\<c- o>=</c-> <c- n>mk</c-> <c- o>+</c-> <c- mi>3</c-> <c- o>*</c-> <c- n>a</c-> <c- p>)</c-> <c- p>{</c->
              <c- n>NS</c-><c- p>(</c-><c- n>numSyms</c-> <c- o>-</c-> <c- n>mk</c-><c- p>)</c-> <c- n>subexp_unif_bools</c->
             <c- k>return</c-> <c- n>subexp_unif_bools</c-> <c- o>+</c-> <c- n>mk</c->
         <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
              <c- n>L</c-><c- p>(</c-><c- mi>1</c-><c- p>)</c-> <c- n>subexp_more_bools</c->
             <c- k>if</c-> <c- p>(</c-> <c- n>subexp_more_bools</c-> <c- p>)</c-> <c- p>{</c->
                <c- n>i</c-><c- o>++</c->
                <c- n>mk</c-> <c- o>+=</c-> <c- n>a</c->
             <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
                 <c- n>L</c-><c- p>(</c-><c- n>b2</c-><c- p>)</c-> <c- n>subexp_bools</c->
                <c- k>return</c-> <c- n>subexp_bools</c-> <c- o>+</c-> <c- n>mk</c->
             <c- p>}</c->
         <c- p>}</c->
     <c- p>}</c->
 <c- p>}</c->
</pre>
   <p><strong>Note:</strong> The decode_signed_subexp_with_ref_bool function is the same as the
decode_signed_subexp_with_ref function except that the bits used to represent
the symbol are arithmetic coded instead of being read directly from the
bitstream.
{:.alert .alert-info }</p>
   <h3 class="heading settled" data-level="5.12" id="tile_list_obu_syntax"><span class="secno">5.12. </span><span class="content">Tile list OBU syntax</span><a class="self-link" href="#tile_list_obu_syntax"></a></h3>
   <h4 class="heading settled" data-level="5.12.1" id="general_tile_list_obu_syntax"><span class="secno">5.12.1. </span><span class="content">General tile list OBU syntax</span><a class="self-link" href="#general_tile_list_obu_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>tile_list_obu</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>output_frame_width_in_tiles_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>output_frame_height_in_tiles_minus_1</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>tile_count_minus_1</c->
     <c- k>for</c-> <c- p>(</c-> <c- n>tile</c-> <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> <c- n>tile</c-> <c- o>&lt;=</c-> <c- n>tile_count_minus_1</c-><c- p>;</c-> <c- n>tile</c-><c- o>++</c-> <c- p>)</c->
         <c- n>tile_list_entry</c-><c- p>(</c-> <c- p>)</c->
 <c- p>}</c->
</pre>
   <h4 class="heading settled" data-level="5.12.2" id="tile_list_entry_syntax"><span class="secno">5.12.2. </span><span class="content">Tile list entry syntax</span><a class="self-link" href="#tile_list_entry_syntax"></a></h4>
<pre class="language-cpp highlight"><c- n>tile_list_entry</c-><c- p>(</c-> <c- p>)</c-> <c- p>{</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>anchor_frame_idx</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>anchor_tile_row</c->
      <c- n>f</c-><c- p>(</c-><c- mi>8</c-><c- p>)</c-> <c- n>anchor_tile_col</c->
      <c- n>f</c-><c- p>(</c-><c- mi>16</c-><c- p>)</c-> <c- n>tile_data_size_minus_1</c->
     <c- n>N</c-> <c- o>=</c-> <c- mi>8</c-> <c- o>*</c-> <c- p>(</c-><c- n>tile_data_size_minus_1</c-> <c- o>+</c-> <c- mi>1</c-><c- p>)</c->
      <c- n>f</c-><c- p>(</c-><c- n>N</c-><c- p>)</c-> <c- n>coded_tile_data</c->
 <c- p>}</c->
</pre>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
           NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
           "MAY", and "OPTIONAL" in this document are to be interpreted as
           described in BCP 14 <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> <a data-link-type="biblio" href="#biblio-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</a> when, and only when, they
           appear in all capitals, as shown here. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note.</p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
<script>
MathJax = {
  loader: {
     load: ['[tex]/tagFormat', 'output/svg']
  },
  tex: {
    packages: {'[+]': ['tagFormat']},
    tags: "all"
  },
  chtml: {
    scale: 0.9,
  ,
};
</script>
<script>
(function() {
  var pre = document.getElementsByTagName('pre'),
    pl = pre.length;
  for (var i = 0; i < pl; i++) {
    pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>';
    var num = pre[i].innerHTML.split(/\n/).length;
    for (var j = 0; j < (num - 1); j++) {
      var line_num = pre[i].getElementsByTagName('span')[0];
      line_num.innerHTML += '<span>' + (j + 1) + '</span>';
    }
  }
})();
</script>
<script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#ac-coefficient">AC coefficient</a><span>, in § 2</span>
   <li><a href="#altref">Altref</a><span>, in § 2</span>
   <li><a href="#base-layer">Base layer</a><span>, in § 2</span>
   <li><a href="#bitstream">Bitstream</a><span>, in § 2</span>
   <li><a href="#bit-string">Bit string</a><span>, in § 2</span>
   <li><a href="#block">Block</a><span>, in § 2</span>
   <li><a href="#block-scan">Block scan</a><span>, in § 2</span>
   <li><a href="#byte">Byte</a><span>, in § 2</span>
   <li><a href="#byte-alignment">Byte alignment</a><span>, in § 2</span>
   <li><a href="#cdef">CDEF</a><span>, in § 2</span>
   <li><a href="#cdf">CDF</a><span>, in § 2</span>
   <li><a href="#chroma">Chroma</a><span>, in § 2</span>
   <li><a href="#coded-frame">Coded frame</a><span>, in § 2</span>
   <li><a href="#component">Component</a><span>, in § 2</span>
   <li><a href="#compound-prediction">Compound prediction</a><span>, in § 2</span>
   <li><a href="#dc-coefficient">DC coefficient</a><span>, in § 2</span>
   <li><a href="#decoded-frame">Decoded frame</a><span>, in § 2</span>
   <li><a href="#decoder">Decoder</a><span>, in § 2</span>
   <li><a href="#decoding-process">Decoding process</a><span>, in § 2</span>
   <li><a href="#dequantization">Dequantization</a><span>, in § 2</span>
   <li><a href="#encoder">Encoder</a><span>, in § 2</span>
   <li><a href="#encoding-process">Encoding process</a><span>, in § 2</span>
   <li><a href="#enhancement-layer">Enhancement layer</a><span>, in § 2</span>
   <li><a href="#flag">Flag</a><span>, in § 2</span>
   <li><a href="#frame">Frame</a><span>, in § 2</span>
   <li><a href="#frame-context">Frame context</a><span>, in § 2</span>
   <li><a href="#golden-frame">Golden frame</a><span>, in § 2</span>
   <li><a href="#inter-coding">Inter coding</a><span>, in § 2</span>
   <li><a href="#inter-frame">Inter frame</a><span>, in § 2</span>
   <li><a href="#inter-prediction">Inter prediction</a><span>, in § 2</span>
   <li><a href="#intra-coding">Intra coding</a><span>, in § 2</span>
   <li><a href="#intra-frame">Intra frame</a><span>, in § 2</span>
   <li><a href="#intra-prediction">Intra prediction</a><span>, in § 2</span>
   <li><a href="#inverse-transform">Inverse transform</a><span>, in § 2</span>
   <li><a href="#key-frame">Key frame</a><span>, in § 2</span>
   <li><a href="#layer">Layer</a><span>, in § 2</span>
   <li><a href="#level">Level</a><span>, in § 2</span>
   <li><a href="#loop-filter">Loop filter</a><span>, in § 2</span>
   <li><a href="#luma">Luma</a><span>, in § 2</span>
   <li><a href="#mode-info">Mode info</a><span>, in § 2</span>
   <li><a href="#mode-info-block">Mode info block</a><span>, in § 2</span>
   <li><a href="#motion-vector">Motion vector</a><span>, in § 2</span>
   <li><a href="#obu">OBU</a><span>, in § 2</span>
   <li><a href="#parse">Parse</a><span>, in § 2</span>
   <li><a href="#prediction">Prediction</a><span>, in § 2</span>
   <li><a href="#prediction-process">Prediction process</a><span>, in § 2</span>
   <li><a href="#prediction-value">Prediction value</a><span>, in § 2</span>
   <li><a href="#profile">Profile</a><span>, in § 2</span>
   <li><a href="#quantization-parameter">Quantization parameter</a><span>, in § 2</span>
   <li><a href="#quantized-coefficient">Quantized coefficient</a><span>, in § 2</span>
   <li><a href="#raster-scan">Raster scan</a><span>, in § 2</span>
   <li><a href="#reconstruction">Reconstruction</a><span>, in § 2</span>
   <li><a href="#reference">Reference</a><span>, in § 2</span>
   <li><a href="#reference-frame">Reference frame</a><span>, in § 2</span>
   <li><a href="#reserved">Reserved</a><span>, in § 2</span>
   <li><a href="#residual">Residual</a><span>, in § 2</span>
   <li><a href="#sample">Sample</a><span>, in § 2</span>
   <li><a href="#sample-value">Sample value</a><span>, in § 2</span>
   <li><a href="#segmentation-map">Segmentation map</a><span>, in § 2</span>
   <li><a href="#sequence">Sequence</a><span>, in § 2</span>
   <li><a href="#superblock">Superblock</a><span>, in § 2</span>
   <li><a href="#switch-frame">Switch Frame</a><span>, in § 2</span>
   <li><a href="#syntax-element">Syntax element</a><span>, in § 2</span>
   <li><a href="#temporal-delimiter-obu">Temporal delimiter OBU</a><span>, in § 2</span>
   <li><a href="#temporal-group">Temporal group</a><span>, in § 2</span>
   <li><a href="#temporal-unit">Temporal unit</a><span>, in § 2</span>
   <li><a href="#tier">Tier</a><span>, in § 2</span>
   <li><a href="#tile">Tile</a><span>, in § 2</span>
   <li><a href="#transform-block">Transform block</a><span>, in § 2</span>
   <li><a href="#transform-coefficient">Transform coefficient</a><span>, in § 2</span>
   <li><a href="#uncompressed-header">Uncompressed header</a><span>, in § 2</span>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc8174">[RFC8174]
   <dd>B. Leiba. <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
  </dl>